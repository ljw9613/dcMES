(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-5fd368ec","chunk-54c12e41","chunk-2d0e44af","chunk-2d0e9954","chunk-5837544a"],{2:function(e,t){},"21a6":function(e,t,a){(function(a){var r,n,i,o;o=function(){"use strict";function t(e,t,a){var r=new XMLHttpRequest;r.open("GET",e),r.responseType="blob",r.onload=function(){s(r.response,t,a)},r.onerror=function(){console.error("could not download file")},r.send()}function r(e){var t=new XMLHttpRequest;t.open("HEAD",e,!1);try{t.send()}catch(e){}return 200<=t.status&&299>=t.status}function n(e){try{e.dispatchEvent(new MouseEvent("click"))}catch(a){var t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(t)}}var i="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof a&&a.global===a?a:void 0,o=i.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),s=i.saveAs||("object"!=typeof window||window!==i?function(){}:"download"in HTMLAnchorElement.prototype&&!o?function(e,a,o){var s=i.URL||i.webkitURL,c=document.createElement("a");a=a||e.name||"download",c.download=a,c.rel="noopener","string"==typeof e?(c.href=e,c.origin===location.origin?n(c):r(c.href)?t(e,a,o):n(c,c.target="_blank")):(c.href=s.createObjectURL(e),setTimeout((function(){s.revokeObjectURL(c.href)}),4e4),setTimeout((function(){n(c)}),0))}:"msSaveOrOpenBlob"in navigator?function(e,a,i){if(a=a||e.name||"download","string"!=typeof e)navigator.msSaveOrOpenBlob(function(e,t){return void 0===t?t={autoBom:!1}:"object"!=typeof t&&(console.warn("Deprecated: Expected third argument to be a object"),t={autoBom:!t}),t.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(e.type)?new Blob(["\ufeff",e],{type:e.type}):e}(e,i),a);else if(r(e))t(e,a,i);else{var o=document.createElement("a");o.href=e,o.target="_blank",setTimeout((function(){n(o)}))}}:function(e,a,r,n){if((n=n||open("","_blank"))&&(n.document.title=n.document.body.innerText="downloading..."),"string"==typeof e)return t(e,a,r);var s="application/octet-stream"===e.type,c=/constructor/i.test(i.HTMLElement)||i.safari,l=/CriOS\/[\d]+/.test(navigator.userAgent);if((l||s&&c||o)&&"undefined"!=typeof FileReader){var u=new FileReader;u.onloadend=function(){var e=u.result;e=l?e:e.replace(/^data:[^;]*;/,"data:attachment/file;"),n?n.location.href=e:location=e,n=null},u.readAsDataURL(e)}else{var d=i.URL||i.webkitURL,h=d.createObjectURL(e);n?n.location=h:location.href=h,n=null,setTimeout((function(){d.revokeObjectURL(h)}),4e4)}});i.saveAs=s.saveAs=s,e.exports=s},n=[],void 0===(i="function"==typeof(r=o)?r.apply(t,n):r)||(e.exports=i)}).call(this,a("c8ba"))},"25de":function(e,t,a){"use strict";a("a50c")},3:function(e,t){},3835:function(e,t,a){"use strict";var r=a("06c5");function n(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var a=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=a){var r,n,i,o,s=[],c=!0,l=!1;try{if(i=(a=a.call(e)).next,0===t){if(Object(a)!==a)return;c=!1}else for(;!(c=(r=i.call(a)).done)&&(s.push(r.value),s.length!==t);c=!0);}catch(e){l=!0,n=e}finally{try{if(!c&&null!=a.return&&(o=a.return(),Object(o)!==o))return}finally{if(l)throw n}}return s}}(e,t)||Object(r.a)(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}a.d(t,"a",(function(){return n}))},4:function(e,t){},"4bf8d":function(e,t,a){"use strict";a.r(t),a.d(t,"export_table_to_excel",(function(){return d})),a.d(t,"export_json_to_excel",(function(){return h})),a("6b54"),a("ac6a");var r=a("2909"),n=(a("34ef"),a("21a6")),i=a("1146"),o=a.n(i);function s(e,t){return t&&(e+=1462),(Date.parse(e)-new Date(Date.UTC(1899,11,30)))/864e5}function c(e,t){for(var a={},r={s:{c:1e7,r:1e7},e:{c:0,r:0}},n=0;n!=e.length;++n)for(var i=0;i!=e[n].length;++i){r.s.r>n&&(r.s.r=n),r.s.c>i&&(r.s.c=i),r.e.r<n&&(r.e.r=n),r.e.c<i&&(r.e.c=i);var c={v:e[n][i]};if(null!=c.v){var l=o.a.utils.encode_cell({c:i,r:n});"number"==typeof c.v?c.t="n":"boolean"==typeof c.v?c.t="b":c.v instanceof Date?(c.t="n",c.z=o.a.SSF._table[14],c.v=s(c.v)):c.t="s",a[l]=c}}return r.s.c<1e7&&(a["!ref"]=o.a.utils.encode_range(r)),a}function l(){if(!(this instanceof l))return new l;this.SheetNames=[],this.Sheets={}}function u(e){for(var t=new ArrayBuffer(e.length),a=new Uint8Array(t),r=0;r!=e.length;++r)a[r]=255&e.charCodeAt(r);return t}function d(e){var t=function(e){for(var t=[],a=e.querySelectorAll("tr"),r=[],n=0;n<a.length;++n){for(var i=[],o=a[n].querySelectorAll("td"),s=0;s<o.length;++s){var c=o[s],l=c.getAttribute("colspan"),u=c.getAttribute("rowspan"),d=c.innerText;if(""!==d&&d==+d&&(d=+d),r.forEach((function(e){if(n>=e.s.r&&n<=e.e.r&&i.length>=e.s.c&&i.length<=e.e.c)for(var t=0;t<=e.e.c-e.s.c;++t)i.push(null)})),(u||l)&&(u=u||1,l=l||1,r.push({s:{r:n,c:i.length},e:{r:n+u-1,c:i.length+l-1}})),i.push(""!==d?d:null),l)for(var h=0;h<l-1;++h)i.push(null)}t.push(i)}return[t,r]}(document.getElementById(e)),a=t[1],r=t[0],i="SheetJS",s=new l,d=c(r);d["!merges"]=a,s.SheetNames.push(i),s.Sheets[i]=d;var h=o.a.write(s,{bookType:"xlsx",bookSST:!1,type:"binary"});Object(n.saveAs)(new Blob([u(h)],{type:"application/octet-stream"}),"test.xlsx")}function h(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.multiHeader,a=void 0===t?[]:t,i=e.header,s=e.data,d=e.filename,h=e.merges,p=void 0===h?[]:h,f=e.autoWidth,m=void 0===f||f,g=e.bookType,b=void 0===g?"xlsx":g;d=d||"excel-list",(s=Object(r.a)(s)).unshift(i);for(var v=a.length-1;v>-1;v--)s.unshift(a[v]);var C="SheetJS",S=new l,y=c(s);if(p.length>0&&(y["!merges"]||(y["!merges"]=[]),p.forEach((function(e){y["!merges"].push(o.a.utils.decode_range(e))}))),m){for(var w=s.map((function(e){return e.map((function(e){return null==e?{wch:10}:e.toString().charCodeAt(0)>255?{wch:2*e.toString().length}:{wch:e.toString().length}}))})),T=w[0],A=1;A<w.length;A++)for(var D=0;D<w[A].length;D++)T[D].wch<w[A][D].wch&&(T[D].wch=w[A][D].wch);y["!cols"]=T}S.SheetNames.push(C),S.Sheets[C]=y;var _=o.a.write(S,{bookType:b,bookSST:!1,type:"binary"});Object(n.saveAs)(new Blob([u(_)],{type:"application/octet-stream"}),"".concat(d,".").concat(b))}},8540:function(e,t,a){"use strict";a.r(t);var r=a("2909"),n=(a("f576"),a("c7eb")),i=(a("96cf"),a("1da1")),o=a("3835"),s=(a("a481"),a("ac6a"),a("456d"),a("53ca")),c=a("7e1e"),l=a("9035"),u=a("8dc5"),d=(a("9339"),a("4bf8d"),{name:"InspectionLastData",components:{EditDialog:l.default},data:function(){return{searchForm:{scanCode:"",machineId:"",processId:"",dateRange:[]},tableList:[],total:0,currentPage:1,pageSize:10,listLoading:!0,dialogFormVisible:!1,dialogStatus:"",selection:[],dataForm:{},historyDialogVisible:!1,historyCurrentPage:1,historyPageSize:10,historyTableList:[],historyListLoading:!0,historyTotal:0,exportLoading:!1,exportProgress:0,exportDialogVisible:!1}},methods:{inspectionDataHandle:function(e){var t=[];for(var a in u)"error"!==a&&!this.isBlank(e[a])&&t.push("".concat(u[a],"：").concat(e[a]));return t},isBlank:function(e){return null==e||""===e||Array.isArray(e)&&0===e.length||"object"===Object(s.a)(e)&&0===Object.keys(e).length},searchData:function(){var e={query:{$and:[]}};if(this.searchForm.scanCode&&this.searchForm.scanCode.trim()&&e.query.$and.push({scanCode:{$regex:function(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}(this.searchForm.scanCode.trim()),$options:"i"}}),this.searchForm.machineId&&e.query.$and.push({machineId:this.searchForm.machineId}),this.searchForm.processId&&e.query.$and.push({processId:this.searchForm.processId}),this.searchForm.dateRange&&2===this.searchForm.dateRange.length){var t=Object(o.a)(this.searchForm.dateRange,2),a=t[0],r=t[1];e.query.$and.push({createTime:{$gte:new Date(a).toISOString(),$lte:new Date(r+" 23:59:59.999").toISOString()}})}return e.query.$and.length||delete e.query.$and,e},resetForm:function(){this.$refs.searchForm.resetFields(),this.searchForm={scanCode:"",machineId:"",processId:"",dateRange:[]},this.currentPage=1,this.fetchData()},fetchData:function(){var e=Object(i.a)(Object(n.a)().mark((function e(){var t,a;return Object(n.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.listLoading=!0,e.prev=1,(t=this.searchData()).page=this.currentPage,t.skip=(this.currentPage-1)*this.pageSize,t.limit=this.pageSize,t.sort={_id:-1},t.count=!0,t.populate=JSON.stringify([{path:"machineId"},{path:"processId"}]),e.next=11,Object(c.b)("InspectionLastData",t);case 11:a=e.sent,this.tableList=a.data,this.total=a.countnum,e.next=20;break;case 16:e.prev=16,e.t0=e.catch(1),console.error("获取数据失败:",e.t0),this.$message.error("获取数据失败");case 20:return e.prev=20,this.listLoading=!1,e.finish(20);case 23:case"end":return e.stop()}}),e,this,[[1,16,20,23]])})));return function(){return e.apply(this,arguments)}}(),baseTableHandleCurrentChange:function(e){this.currentPage=e,this.fetchData()},baseTableHandleSizeChange:function(e){this.pageSize=e,this.fetchData()},formatDate:function(e){if(!e)return"暂无数据";var t=new Date(e);if(isNaN(t.getTime()))return"无效日期";var a=t.getFullYear(),r=String(t.getMonth()+1).padStart(2,"0"),n=String(t.getDate()).padStart(2,"0"),i=String(t.getHours()).padStart(2,"0"),o=String(t.getMinutes()).padStart(2,"0"),s=String(t.getSeconds()).padStart(2,"0");return"".concat(a,"-").concat(r,"-").concat(n," ").concat(i,":").concat(o,":").concat(s)},search:function(){this.currentPage=1,this.fetchData()},handleSelectionChange:function(e){this.selection=e},handleView:function(e){this.dataForm=JSON.parse(JSON.stringify(e)),this.dialogStatus="view",this.dialogFormVisible=!0},handleEdit:function(e){this.dialogStatus="edit",this.dataForm=JSON.parse(JSON.stringify(e)),this.dialogFormVisible=!0},handleDelete:function(e){var t=this;this.$confirm("确认要删除该检测数据吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(Object(i.a)(Object(n.a)().mark((function a(){return Object(n.a)().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,Object(c.c)("InspectionLastData",e._id);case 3:t.$message.success("删除成功"),t.fetchData(),a.next=11;break;case 7:a.prev=7,a.t0=a.catch(0),console.error("删除失败:",a.t0),t.$message.error("删除失败");case 11:case"end":return a.stop()}}),a,null,[[0,7]])})))).catch((function(){t.$message.info("已取消删除")}))},handleAdd:function(){this.dialogStatus="create",this.dataForm={},this.dialogFormVisible=!0},handleBatchDelete:function(){var e=this;this.selection.length?this.$confirm("确认删除选中的 ".concat(this.selection.length," 条记录吗？"),"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(Object(i.a)(Object(n.a)().mark((function t(){var a;return Object(n.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,a=e.selection.map((function(e){return e._id})),t.next=4,Object(c.c)("InspectionLastData",{query:{_id:{$in:a}}});case 4:e.$message.success("批量删除成功"),e.fetchData(),t.next=12;break;case 8:t.prev=8,t.t0=t.catch(0),console.error("批量删除失败:",t.t0),e.$message.error("批量删除失败");case 12:case"end":return t.stop()}}),t,null,[[0,8]])})))).catch((function(){})):this.$message.warning("请选择要删除的记录")},handleSubmit:function(){var e=Object(i.a)(Object(n.a)().mark((function e(t){return Object(n.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,"create"!==this.dialogStatus){e.next=7;break}return e.next=4,Object(c.a)("InspectionLastData",t);case 4:this.$message.success("新增成功"),e.next=10;break;case 7:return e.next=9,Object(c.d)("InspectionLastData",{query:{_id:t._id},update:t});case 9:this.$message.success("更新成功");case 10:this.dialogFormVisible=!1,this.fetchData(),e.next=18;break;case 14:e.prev=14,e.t0=e.catch(0),console.error("操作失败:",e.t0),this.$message.error("操作失败");case 18:case"end":return e.stop()}}),e,this,[[0,14]])})));return function(t){return e.apply(this,arguments)}}(),showHistory:function(e){this.historyCurrentPage=1,this.dataForm=e,this.fetchHistoryData(e.scanCode),this.historyDialogVisible=!0},fetchHistoryData:function(){var e=Object(i.a)(Object(n.a)().mark((function e(t){var a;return Object(n.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.historyListLoading=!0,e.prev=1,e.next=4,Object(c.b)("InspectionData",{query:{scanCode:t},populate:JSON.stringify([{path:"machineId"},{path:"processId"}]),skip:(this.historyCurrentPage-1)*this.historyPageSize,limit:this.historyPageSize,count:!0});case 4:a=e.sent,this.historyTableList=a.data,this.historyTotal=a.countnum,e.next=13;break;case 9:e.prev=9,e.t0=e.catch(1),console.error("获取历史数据失败:",e.t0),this.$message.error("获取历史数据失败");case 13:return e.prev=13,this.historyListLoading=!1,e.finish(13);case 16:case"end":return e.stop()}}),e,this,[[1,9,13,16]])})));return function(t){return e.apply(this,arguments)}}(),historyTableHandleCurrentChange:function(e){this.historyCurrentPage=e,this.fetchHistoryData(this.dataForm.scanCode)},historyTableHandleSizeChange:function(e){this.historyPageSize=e,this.fetchHistoryData(this.dataForm.scanCode)},handleExport:function(){var e=Object(i.a)(Object(n.a)().mark((function e(){var t,i,o,s,l,u,d,h,p=this;return Object(n.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.exportLoading=!0,this.exportProgress=0,this.exportDialogVisible=!0,e.prev=3,(t=this.searchData()).populate=JSON.stringify([{path:"machineId"},{path:"processId"}]),e.next=8,Object(c.b)("InspectionLastData",t);case 8:i=e.sent,o=i.data.length,s=[],l=100,u=["扫描码","设备名称","工序名称","检测结果","检测时间","检测详情"],d=0;case 14:if(!(d<o)){e.next=23;break}return h=i.data.slice(d,d+l).map((function(e){return[e.scanCode,e.machineId?e.machineId.machineName:"--",e.processId?e.processId.processName:"--",e.error?"不合格":"合格",p.formatDate(e.createTime),p.inspectionDataHandle(e).join("; ")]})),s.push.apply(s,Object(r.a)(h)),this.exportProgress=Math.round((d+h.length)/o*100),e.next=20,new Promise((function(e){return setTimeout(e,10)}));case 20:d+=l,e.next=14;break;case 23:console.log(s),Promise.resolve().then(a.bind(null,"4bf8d")).then((function(e){e.export_json_to_excel({header:u,data:s,filename:"检测数据"+(new Date).getTime(),autoWidth:!0,bookType:"xlsx"}),p.exportProgress=100,p.$message.success("导出成功")})),setTimeout((function(){p.exportDialogVisible=!1,p.exportProgress=0}),1e3),e.next=33;break;case 28:e.prev=28,e.t0=e.catch(3),console.error("导出失败:",e.t0),this.$message.error("导出失败"),this.exportDialogVisible=!1;case 33:return e.prev=33,this.exportLoading=!1,e.finish(33);case 36:case"end":return e.stop()}}),e,this,[[3,28,33,36]])})));return function(){return e.apply(this,arguments)}}()},created:function(){this.fetchData()}}),h=d,p=(a("25de"),a("2877")),f=Object(p.a)(h,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("el-card",{staticClass:"filter-container"},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",[e._v("筛选搜索")])]),e._v(" "),a("el-form",{ref:"searchForm",staticClass:"demo-form-inline",attrs:{model:e.searchForm}},[a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"扫描码"}},[a("el-input",{attrs:{placeholder:"请输入扫描码",clearable:""},model:{value:e.searchForm.scanCode,callback:function(t){e.$set(e.searchForm,"scanCode",t)},expression:"searchForm.scanCode"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"设备"}},[a("zr-select",{staticStyle:{width:"100%"},attrs:{collection:"machine","search-fields":["machineName","machineCode"],"label-key":"machineName","sub-key":"machineCode",multiple:!1,placeholder:"请输入设备名称搜索",clearable:""},scopedSlots:e._u([{key:"option",fn:function(t){var r=t.item;return[a("div",{staticClass:"select-option"},[a("div",{staticClass:"option-main"},[a("span",{staticClass:"option-label"},[e._v(e._s(r.machineName))]),e._v(" "),a("el-tag",{staticClass:"option-tag",attrs:{size:"mini",type:"info"}},[e._v("\n                                            "+e._s(r.machineCode)+"\n                                        ")])],1)])]}}]),model:{value:e.searchForm.machineId,callback:function(t){e.$set(e.searchForm,"machineId",t)},expression:"searchForm.machineId"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"工序"}},[a("zr-select",{staticStyle:{width:"100%"},attrs:{collection:"processStep","search-fields":["processCode","processName"],"label-key":"processName","sub-key":"_id",multiple:!1,placeholder:"请输入工序名称/编码搜索",clearable:""},scopedSlots:e._u([{key:"option",fn:function(t){var r=t.item;return[a("div",{staticClass:"select-option"},[a("div",{staticClass:"option-main"},[a("span",{staticClass:"option-label"},[e._v(e._s(r.processName))]),e._v(" "),a("el-tag",{staticClass:"option-tag",attrs:{size:"mini",type:"info"}},[e._v("\n                                            "+e._s(r.processCode)+"\n                                        ")])],1)])]}}]),model:{value:e.searchForm.processId,callback:function(t){e.$set(e.searchForm,"processId",t)},expression:"searchForm.processId"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"检测时间"}},[a("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期","value-format":"yyyy-MM-dd"},model:{value:e.searchForm.dateRange,callback:function(t){e.$set(e.searchForm,"dateRange",t)},expression:"searchForm.dateRange"}})],1)],1)],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:e.search}},[e._v("查询搜索")]),e._v(" "),a("el-button",{on:{click:e.resetForm}},[e._v("重置")])],1)],1)],1),e._v(" "),a("div",{staticClass:"screen1"},[a("div",{staticClass:"screen_content"},[a("div",{staticClass:"screen_content_first"},[a("i",{staticClass:"el-icon-tickets"},[e._v("检测数据列表")]),e._v(" "),a("el-button",{attrs:{type:"primary",loading:e.exportLoading},on:{click:e.handleExport}},[a("i",{staticClass:"el-icon-download"}),e._v("\n                    "+e._s(e.exportLoading?"正在导出("+e.exportProgress+"%)":"导出数据")+"\n                ")])],1)])]),e._v(" "),a("base-table",{ref:"baseTable",attrs:{currentPage:e.currentPage,"highlight-current-row":!0,pageSize:e.pageSize,tableData:e.tableList,tableDataloading:e.listLoading,total:e.total},on:{"selection-change":e.handleSelectionChange,handleCurrentChange:e.baseTableHandleCurrentChange,handleSizeChange:e.baseTableHandleSizeChange}},[a("template",{slot:"law"},[a("el-table-column",{attrs:{type:"expand"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-form",{staticClass:"table-expand",attrs:{"label-position":"left",inline:""}},[e.inspectionDataHandle(t.row).length?a("div",e._l(e.inspectionDataHandle(t.row),(function(t){return a("el-tag",{key:t,staticStyle:{margin:"3px"}},[e._v("\n                                "+e._s(t)+"\n                            ")])})),1):e._e()])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"扫描码",align:"center",prop:"scanCode"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-link",{attrs:{type:"primary"}},[e._v(e._s(t.row.scanCode))]),e._v(" "),a("el-link",{staticStyle:{"margin-left":"10px"},attrs:{type:"primary"},on:{click:function(a){return e.showHistory(t.row)}}},[e._v("历史记录")])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"设备名称",align:"center",width:"220"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                    "+e._s(t.row.machineId?t.row.machineId.machineName:"--")+"\n                ")]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"工序名称",align:"center",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                    "+e._s(t.row.processId?t.row.processId.processName:"--")+"\n                ")]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"检测结果",align:"center",width:"400"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tag",{attrs:{type:t.row.error?"danger":"success"}},[e._v("\n                        "+e._s(t.row.error?"不合格":"合格")+"\n                    ")])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"检测时间",align:"center",width:"160"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                    "+e._s(e.formatDate(t.row.createTime))+"\n                ")]}}])})],1)],2),e._v(" "),a("edit-dialog",{attrs:{visible:e.dialogFormVisible,"dialog-status":e.dialogStatus,"row-data":e.dataForm},on:{"update:visible":function(t){e.dialogFormVisible=t},submit:e.handleSubmit}}),e._v(" "),a("el-dialog",{attrs:{title:"历史检测数据",visible:e.historyDialogVisible,width:"80%"},on:{"update:visible":function(t){e.historyDialogVisible=t}}},[a("base-table",{ref:"historyTable",attrs:{currentPage:e.historyCurrentPage,"highlight-current-row":!0,pageSize:e.historyPageSize,tableData:e.historyTableList,tableDataloading:e.historyListLoading,total:e.historyTotal},on:{handleCurrentChange:e.historyTableHandleCurrentChange,handleSizeChange:e.historyTableHandleSizeChange}},[a("template",{slot:"law"},[a("el-table-column",{attrs:{type:"expand"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-form",{staticClass:"table-expand",attrs:{"label-position":"left",inline:""}},[e.inspectionDataHandle(t.row).length?a("div",e._l(e.inspectionDataHandle(t.row),(function(t){return a("el-tag",{key:t,staticStyle:{margin:"3px"}},[e._v("\n                                    "+e._s(t)+"\n                                ")])})),1):e._e()])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"设备名称",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                        "+e._s(t.row.machineId?t.row.machineId.machineName:"--")+"\n                    ")]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"工序名称",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                        "+e._s(t.row.processId?t.row.processId.processName:"--")+"\n                    ")]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"检测结果",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tag",{attrs:{type:t.row.error?"danger":"success"}},[e._v("\n                            "+e._s(t.row.error?"不合格":"合格")+"\n                        ")])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"检测时间",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                        "+e._s(e.formatDate(t.row.createTime))+"\n                    ")]}}])})],1)],2)],1),e._v(" "),a("el-dialog",{attrs:{title:"导出进度",visible:e.exportDialogVisible,"close-on-click-modal":!1,"close-on-press-escape":!1,"show-close":!1,width:"30%"},on:{"update:visible":function(t){e.exportDialogVisible=t}}},[a("el-progress",{attrs:{percentage:e.exportProgress,status:100===e.exportProgress?"success":"","stroke-width":18}}),e._v(" "),a("div",{staticStyle:{"text-align":"center","margin-top":"10px"}},[e._v("\n            "+e._s(100===e.exportProgress?"导出完成":"正在导出数据，请稍候...")+"\n        ")])],1)],1)}),[],!1,null,"43d8d8a2",null);t.default=f.exports},"8dc5":function(e){e.exports={startDate:"日期",workstation:"工位号",productModel:"产品型号",red:"红色",blue:"蓝色",infrared:"红外",red2:"红色2",blue2:"蓝色2",infrared2:"红外2",udiCode:"UDI码",lampBoardQrCode:"灯板二维码",batteryCellCode:"电芯码",chargingBoardPcbaCode:"充电板PCBA码",maskPcbaCode:"面罩PCBA码",controllerPcbaCode:"手控器PCBA码",controllerSoftwareVersion:"手控器软件版本",maskSoftwareVersion:"面罩软件版本",controllerFactoryQrCode:"手控器出厂二维码",faceDetectionProgramVersion:"面部探测程序版本",circuitFaultCode:"电路故障码",redLightWavelength:"红灯波长",blueLightWavelength:"蓝灯波长",infraredLightWavelength:"红外灯波长",redLightCurrent:"红灯电流",blueLightCurrent:"蓝灯电流",infraredLightCurrent:"红外灯电流",msiLightCurrent:"MSI灯电流",fanCurrent:"风扇电流",batteryVoltage:"电池电压",dischargeCurrent:"放电电流",batteryPower:"电池电量",faceSensorStatus:"面部传感器状态",faceSensorValue:"面部传感器值",batteryCell1Voltage:"电芯1电压",batteryCell2Voltage:"电芯2电压",productNtc1TemperatureStart:"产品NTC1温度S",productNtc1TemperatureEnd:"产品NTC1温度E",productNtc2TemperatureStart:"产品NTC2温度S",productNtc2TemperatureEnd:"产品NTC2温度E",instrumentNtc1TemperatureStart:"仪表NTC1温度S",instrumentNtc1TemperatureEnd:"仪表NTC1温度E",instrumentNtc2TemperatureStart:"仪表NTC2温度S",instrumentNtc2TemperatureEnd:"仪表NTC2温度E",productNtc1Difference:"产品NTC1差值",productNtc2Difference:"产品NTC2差值",instrumentNtc1Difference:"仪表NTC1差值",instrumentNtc2Difference:"仪表NTC2差值",productNtcDifferenceStart:"产品NTC差值S",productNtcDifferenceEnd:"产品NTC差值E",instrumentNtcDifferenceStart:"仪表NTC差值S",instrumentNtcDifferenceEnd:"仪表NTC差值E",chargingStatus:"充电状态",chargingVoltage:"充电电压",chargingCurrent:"充电电流",instrumentChargingCurrent:"仪表充电电流",chargingCurrentDifference:"充电电流差值",instrumentNtcDifferenceBeforeCooling:"仪器NTC1和NTC2的差值(制冷前)",productAndInstrumentNtc1Difference:"产品NTC1和仪器NTC1差值",productAndInstrumentNtc2Difference:"产品NTC2和仪器NTC2差值",coolingStatus:"制冷状态",coolingSetTemperature:"制冷设置温度",chargingTest:"充电测试",withstandVoltageTest:"耐压测试",cellCode:"电芯码",handheldControllerPcbaCode:"手控器PCBA码",handheldSoftwareVersion:"手控器软件版本",handheldFactoryQrCode:"手控器出厂二维码",batteryCapacity:"电池电量",cell1Voltage:"电芯1电压",cell2Voltage:"电芯2电压",productNtc1TempS:"产品NTC1温度S",productNtc1TempE:"产品NTC1温度E",productNtc2TempS:"产品NTC2温度S",productNtc2TempE:"产品NTC2温度E",meterNtc1TempS:"仪表NTC1温度S",meterNtc1TempE:"仪表NTC1温度E",meterNtc2TempS:"仪表NTC2温度S",meterNtc2TempE:"仪表NTC2温度E",meterNtc1Difference:"仪表NTC1差值",meterNtc2Difference:"仪表NTC2差值",productNtcDifferenceS:"产品NTC差值S",productNtcDifferenceE:"产品NTC差值E",meterNtcDifferenceS:"仪表NTC差值S",meterNtcDifferenceE:"仪表NTC差值E",meterChargingCurrent:"仪表充电电流",weight:"称重重量",lineNumber:"线体",showSerialNo:"0.4 SHOW SERIALNO 显示序列号",chkPowerOn:"A1.0 CHK POWER ON ATE 上电开机",enterDebugMode:"A1.1 ENTER DEBUG MODE 进入调试模式",showReadCellMsg:"A7.7 SHOW READ CELL MSG 显示读取电池消息",showReadMainPcbaMsg:"A7.9 SHOW READ MAIN PCBA MSG 显示读取主PCBA消息",showReadPcba2Msg:"A7.11 SHOW READ PCBA2 MSG 显示读取PCBA2消息",showReadPackMsg:"A7.13 SHOW READ PACK MSG 读取 MCU 遥控器机身码",readAllKeyOff:"A1.2 READ ALL KEY OFF 读取所有按键关闭状态",readK4K5:"A1.3 READ K4 K5 读取 K4 K5 左右键状态",readPotentiometer:"A1.4 READ POTENTIOMETER 检查编码开关",readAllKeyOff2:"A1.5 READ ALL KEY OFF 读取所有按键关闭状态",readPackVol:"A1.10 READ PACK VOL 读取 PACK 总电压",readPackCell1Vol:"A1.12 READ PACK CELL1 VOL 读取 CL1 电压",readPackCell2Vol:"A1.13 READ PACK CELL2 VOL 读取 CL2 电压",chkCellVolDiffMax:"A1.14 CHK CELL VOL DIFF MAX CL1 CL2 压差校验",readNtc:"A1.15 READ NTC 读取 NTC",chkUiVersion:"A1.17 CHK UI VERSION 读取软件版本",discharge1ATestPrepare:"A3.2 DISCHARGE1A TEST PREPARE 放电准备-电子负载恒流 1A，改为 3A",chkBatOutVol:"A3.9 CHK BATOUT VOL 放电 BAT 输出电压",chkDischargeCur:"A3.10 CHK DISCHARGE CUR 负载放电和电子负载电流校验",readDischargeCur:"A3.11 READ DISCHARGE CUR 读取放电电流",readDischargeSta:"A3.11B READ DISCHARGE STA 读取放电状态",dischargeOcpTestPrepare:"A3.12 DISCHARGE OCP TEST PREPARE 过流检查",readDischargeCur2:"A3.13 READ DISCHARGE CUR 读取放电电流",readDischargeSta2:"A3.13B READ DISCHARGE STA 读取放电结束",dischargeTestEnd:"A3.17 DISCHARGE TEST END 放电测试结束",chkUiTx:"A3.22A CHK UI TX 遥控器通讯口校验",chargeTestPrepare:"A6.01 CHARGE TEST PREPARE 2A 适配器充电准备",readChargerVolt:"A6.03 READ CHARGER VOLT 读取充电器电压",readChargeCur:"A6.04 READ CHARGE CUR 读取充电电流",ateChangeCur:"A6.05 ATECHARGE CUR 自检 ATE 充电电流",chkStillChargeCur:"A6.06 CHK STILL CHARGE CUR 充电保持电流",chargeTestEnd:"A6.07 CHARGE TEST END 充电结束",readSoc:"A7.14 READ SOC 读取 SOC",packOff:"A8.0 PACK OFF 遥控器关机",allTestEnd:"A9.0 ALL TEST END 所有测试结束",passFail:"PASS/Fail 测试结果",testTime:"日期",positiveNegativeResult:"正反结果",revolutionSpeedTestValue:"转速测试值",vacuumTestValue:"真空测试值"}},9035:function(e,t,a){"use strict";a.r(t);var r=a("c7eb"),n=(a("96cf"),a("1da1")),i=a("5530"),o={name:"EditDialog",props:{visible:{type:Boolean,default:!1},dialogStatus:{type:String,default:"create"},rowData:{type:Object,default:function(){return{}}}},data:function(){return{dialogVisible:this.visible,form:{machineName:"",machineCode:"",machineIp:"",principal:"",comment:""},rules:{machineName:[{required:!0,message:"请输入设备名称",trigger:"blur"}],machineCode:[{required:!0,message:"请输入设备编号",trigger:"blur"}],machineIp:[{required:!0,message:"请输入设备IP",trigger:"blur"}],principal:[{required:!0,message:"请输入负责人",trigger:"blur"}]},submitLoading:!1}},computed:{dialogTitle:function(){return"create"===this.dialogStatus?"新增设备信息":"编辑设备信息"}},watch:{visible:function(e){this.dialogVisible=e,e&&this.initFormData()},rowData:{handler:function(e){e&&this.dialogVisible&&this.initFormData()},deep:!0}},methods:{initFormData:function(){"edit"===this.dialogStatus?this.form=Object(i.a)({},this.rowData):this.form={machineName:"",machineCode:"",machineIp:"",principal:"",comment:""}},handleClose:function(){this.$emit("update:visible",!1),this.$refs.form&&this.$refs.form.resetFields()},handleSubmit:function(){var e=this;this.$refs.form.validate(function(){var t=Object(n.a)(Object(r.a)().mark((function t(a){var n;return Object(r.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a){e.submitLoading=!0;try{n=Object(i.a)({},e.form),e.$emit("submit",n),e.handleClose()}catch(t){console.error("提交失败:",t),e.$message.error("提交失败")}finally{e.submitLoading=!1}}case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}}},s=o,c=a("2877"),l=Object(c.a)(s,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{attrs:{title:e.dialogTitle,visible:e.dialogVisible,width:"60%"},on:{close:e.handleClose,"update:visible":function(t){return e.$emit("update:visible",t)}}},[a("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"120px",size:"small"}},[a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"设备名称",prop:"machineName"}},[a("el-input",{attrs:{placeholder:"请输入设备名称"},model:{value:e.form.machineName,callback:function(t){e.$set(e.form,"machineName",t)},expression:"form.machineName"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"设备编号",prop:"machineCode"}},[a("el-input",{attrs:{placeholder:"请输入设备编号",disabled:"edit"===e.dialogStatus},model:{value:e.form.machineCode,callback:function(t){e.$set(e.form,"machineCode",t)},expression:"form.machineCode"}})],1)],1)],1),e._v(" "),a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"设备IP",prop:"machineIp"}},[a("el-input",{attrs:{placeholder:"请输入设备IP"},model:{value:e.form.machineIp,callback:function(t){e.$set(e.form,"machineIp",t)},expression:"form.machineIp"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"负责人",prop:"principal"}},[a("el-input",{attrs:{placeholder:"请输入负责人"},model:{value:e.form.principal,callback:function(t){e.$set(e.form,"principal",t)},expression:"form.principal"}})],1)],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"备注",prop:"comment"}},[a("el-input",{attrs:{type:"textarea",placeholder:"请输入备注信息"},model:{value:e.form.comment,callback:function(t){e.$set(e.form,"comment",t)},expression:"form.comment"}})],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:e.handleClose}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary",loading:e.submitLoading},on:{click:e.handleSubmit}},[e._v("确 定")])],1)],1)}),[],!1,null,null,null);t.default=l.exports},a50c:function(e,t,a){}}]);