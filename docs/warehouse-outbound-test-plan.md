# 仓库出库单系统限制规则测试计划

**作者：** ljw  
**邮箱：** 1798245303@qq.com  
**创建时间：** 2025-06-25  
**版本：** v1.0

## 概述

本文档描述了针对添可销售订单类型的仓库出库单系统限制规则的测试计划，确保所有业务逻辑的正确性和系统的稳定性。

## 测试范围

### 核心功能测试
1. 添可销售订单类型识别
2. 托盘工单一致性验证
3. 白名单工单数量限制
4. 白名单保存机制
5. 白名单不可修改限制

## 测试用例

### 1. 添可销售订单类型识别测试

#### 测试用例 1.1：正确识别添可订单
- **前置条件：** 销售订单的 FSettleId_FNumber = "CUST0199"
- **测试步骤：** 
  1. 创建添可类型的销售订单
  2. 扫描该订单下的托盘
- **预期结果：** 系统正确识别为添可订单，应用相应限制规则

#### 测试用例 1.2：正确识别非添可订单
- **前置条件：** 销售订单的 FSettleId_FNumber ≠ "CUST0199"
- **测试步骤：** 
  1. 创建非添可类型的销售订单
  2. 扫描该订单下的托盘
- **预期结果：** 系统识别为普通订单，不应用添可限制规则

### 2. 托盘工单一致性验证测试

#### 测试用例 2.1：添可订单 - 同工单托盘扫描
- **前置条件：** 添可销售订单，出库单已有工单A的托盘
- **测试步骤：** 
  1. 扫描同属工单A的另一个托盘
- **预期结果：** 扫描成功，托盘添加到出库单

#### 测试用例 2.2：添可订单 - 不同工单托盘扫描
- **前置条件：** 添可销售订单，出库单已有工单A的托盘
- **测试步骤：** 
  1. 扫描属于工单B的托盘
- **预期结果：** 扫描失败，显示工单不一致错误信息

#### 测试用例 2.3：非添可订单 - 不同工单托盘扫描
- **前置条件：** 非添可销售订单，出库单已有工单A的托盘
- **测试步骤：** 
  1. 扫描属于工单B的托盘
- **预期结果：** 扫描成功，允许不同工单的托盘混装

### 3. 白名单工单数量限制测试

#### 测试用例 3.1：添可订单 - 设置1个工单白名单
- **前置条件：** 添可销售订单，白名单为空
- **测试步骤：** 
  1. 在白名单中添加1个工单
- **预期结果：** 设置成功

#### 测试用例 3.2：添可订单 - 设置多个工单白名单
- **前置条件：** 添可销售订单，白名单为空
- **测试步骤：** 
  1. 尝试在白名单中添加2个或更多工单
- **预期结果：** 设置失败，显示数量限制错误信息

#### 测试用例 3.3：非添可订单 - 设置多个工单白名单
- **前置条件：** 非添可销售订单，白名单为空
- **测试步骤：** 
  1. 在白名单中添加多个工单
- **预期结果：** 设置成功，无数量限制

### 4. 白名单保存机制测试

#### 测试用例 4.1：添可订单 - 首次扫描自动保存白名单
- **前置条件：** 添可销售订单，已设置白名单
- **测试步骤：** 
  1. 进行第一次托盘扫描
  2. 检查数据库中的出库单记录
- **预期结果：** 白名单信息已保存到出库单，whitelistLocked=true

#### 测试用例 4.2：非添可订单 - 白名单保存但不锁定
- **前置条件：** 非添可销售订单，已设置白名单
- **测试步骤：** 
  1. 进行第一次托盘扫描
  2. 检查数据库中的出库单记录
- **预期结果：** 白名单信息已保存，whitelistLocked=false

### 5. 白名单不可修改限制测试

#### 测试用例 5.1：添可订单 - 锁定后尝试修改白名单
- **前置条件：** 添可销售订单，白名单已锁定
- **测试步骤：** 
  1. 尝试修改白名单设置
- **预期结果：** 修改失败，显示白名单已锁定错误信息

#### 测试用例 5.2：非添可订单 - 未锁定时可修改白名单
- **前置条件：** 非添可销售订单，白名单未锁定
- **测试步骤：** 
  1. 修改白名单设置
- **预期结果：** 修改成功

## 边界条件测试

### 测试用例 6.1：空白名单扫描
- **前置条件：** 添可销售订单，白名单为空
- **测试步骤：** 
  1. 直接扫描托盘
- **预期结果：** 扫描失败，提示必须设置白名单

### 测试用例 6.2：白名单外工单托盘扫描
- **前置条件：** 添可销售订单，白名单包含工单A
- **测试步骤：** 
  1. 扫描属于工单B的托盘
- **预期结果：** 扫描失败，提示托盘工单不在白名单中

## 异常情况测试

### 测试用例 7.1：网络异常处理
- **测试步骤：** 
  1. 模拟网络中断
  2. 进行托盘扫描操作
- **预期结果：** 显示友好的错误信息，不会导致系统崩溃

### 测试用例 7.2：数据库异常处理
- **测试步骤：** 
  1. 模拟数据库连接异常
  2. 进行出库单操作
- **预期结果：** 显示友好的错误信息，不会导致数据丢失

## 性能测试

### 测试用例 8.1：大量托盘扫描性能
- **测试步骤：** 
  1. 连续扫描100个托盘
  2. 记录响应时间
- **预期结果：** 每次扫描响应时间 < 2秒

### 测试用例 8.2：并发扫描测试
- **测试步骤：** 
  1. 模拟10个用户同时扫描托盘
  2. 检查数据一致性
- **预期结果：** 所有操作正确执行，无数据冲突

## 用户界面测试

### 测试用例 9.1：错误信息显示
- **测试步骤：** 
  1. 触发各种错误场景
  2. 检查错误信息的显示
- **预期结果：** 错误信息清晰、准确、用户友好

### 测试用例 9.2：白名单锁定状态显示
- **测试步骤：** 
  1. 查看已锁定白名单的出库单
  2. 检查UI状态显示
- **预期结果：** 清晰显示锁定状态，相关操作被禁用

## 回归测试

### 测试用例 10.1：原有功能验证
- **测试步骤：** 
  1. 执行所有原有的出库单功能
  2. 验证功能正常性
- **预期结果：** 所有原有功能正常工作，无功能退化

## 测试环境要求

- **测试数据：** 包含添可和非添可两种类型的销售订单
- **测试工单：** 至少3个不同的工单数据
- **测试托盘：** 每个工单至少5个托盘
- **测试用户：** 具有出库操作权限的用户账号

## 测试执行计划

1. **单元测试：** 开发完成后立即执行
2. **集成测试：** 所有模块集成后执行
3. **系统测试：** 部署到测试环境后执行
4. **用户验收测试：** 业务用户参与验证

## 测试通过标准

- 所有测试用例执行通过率 ≥ 95%
- 无严重级别的缺陷
- 性能指标满足要求
- 用户界面友好，操作流畅

## 风险评估

- **高风险：** 数据一致性问题，可能导致出库数据错误
- **中风险：** 性能问题，可能影响用户体验
- **低风险：** 界面显示问题，不影响核心功能

## 测试结论

测试完成后，需要提供详细的测试报告，包括：
- 测试执行情况统计
- 发现的问题及解决方案
- 系统稳定性评估
- 上线建议
