(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-234e7e72"],{"176b":function(e,t,a){},2:function(e,t){},3575:function(e,t,a){"use strict";a("6a1f")},3927:function(e,t,a){},4:function(e,t){},5:function(e,t){},"64f6":function(e,t,a){},"6a1f":function(e,t,a){},74196:function(e,t,a){"use strict";a("176b")},b58f:function(e,t,a){"use strict";a("3927")},ed91:function(e,t,a){"use strict";a.d(t,"a",(function(){return s})),a.d(t,"c",(function(){return n})),a.d(t,"d",(function(){return o})),a.d(t,"e",(function(){return i})),a.d(t,"b",(function(){return c}));var r=a("b775");function s(e){return Object(r.a)({url:"/create-flow",method:"post",data:e})}function n(e){return Object(r.a)({url:"/scan-components",method:"post",data:e})}function o(e){return Object(r.a)({url:"/unbind-components",method:"post",data:e})}function i(e){return Object(r.a)({url:"/update-flow-nodes",method:"post",data:e})}function c(e){return Object(r.a)({url:"/all-process-steps/".concat(e),method:"get"})}},fb50:function(e,t,a){"use strict";a.r(t);var r=(a("7f7f"),a("ade3")),s=a("3835"),n=(a("ffc1"),a("c5f6"),a("a481"),a("c7eb")),o=(a("20d6"),a("96cf"),a("1da1")),i=a("5530"),c=(a("55dd"),a("ac6a"),a("5df3"),a("f400"),a("7e1e")),l={name:"FlowNode",props:{node:{type:Object,required:!0}}},d=(a("3575"),a("2877")),u=Object(d.a)(l,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"flow-level"},[a("div",{staticClass:"node-container"},[a("div",{staticClass:"material-node",class:{"root-node":!e.node.materialQuantity,completed:e.node.barcode||"COMPLETED"===e.node.status}},[a("div",{staticClass:"node-title"},[e._v(e._s(e.node.materialName))]),e._v(" "),e.node.craftName?a("div",{staticClass:"node-subtitle"},[e._v("\n                Â∑•Ëâ∫Ôºö"+e._s(e.node.craftName)+"\n            ")]):e._e(),e._v(" "),e.node.barcode?a("div",{staticClass:"node-info"},[e._v("\n                Êù°Á†ÅÔºö"+e._s(e.node.barcode)+"\n            ")]):e._e(),e._v(" "),e.node.materialCode?a("div",{staticClass:"node-info"},[e._v("\n                ÁºñÁ†ÅÔºö"+e._s(e.node.materialCode)+"\n            ")]):e._e(),e._v(" "),e.node.scanOperation?a("div",{staticClass:"node-info"},[e._v("\n                Êâ´Á†ÅÊìç‰ΩúÔºö"+e._s(e.node.scanOperation?"ÈúÄË¶ÅÊâ´Á†Å":"‰∏çÈúÄË¶ÅÊâ´Á†Å")+"\n            ")]):e._e(),e._v(" "),e.node.isComponent?a("div",{staticClass:"node-info"},[e._v("\n                ÊòØÂê¶ÁªÑ‰ª∂Ôºö"+e._s(e.node.isComponent?"ÊòØ":"Âê¶")+"\n            ")]):e._e(),e._v(" "),e.node.materialQuantity?a("div",{staticClass:"node-info"},[e._v("\n                Áî®ÈáèÔºö"+e._s(e.node.materialQuantity)+e._s(e.node.unit||"‰∏™")+"\n            ")]):e._e()])]),e._v(" "),e.node.children&&e.node.children.length?[e._m(0),e._v(" "),a("div",{staticClass:"process-level"},e._l(e.node.children,(function(t){return a("div",{key:t._id,staticClass:"process-container"},[a("div",{staticClass:"process-node"},[a("div",{staticClass:"node-title",style:{background:"COMPLETED"===t.status?"#67C23A":"#ffa640"}},[e._v(e._s(t.processSort)+"."+e._s(t.processName))]),e._v(" "),a("div",{staticClass:"node-content"},[t.children&&t.children.length?e._l(t.children,(function(e){return a("div",{key:e._id,staticClass:"sub-material"},[a("flow-node",{attrs:{node:e}})],1)})):a("div",{staticClass:"no-materials"},[e._v("\n                            ÊöÇÊó†ÂÖ≥ËÅîÁâ©Êñô\n                        ")])],2)])])})),0)]:e._e()],2)}),[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"arrow-container"},[t("div",{staticClass:"arrow-right"})])}],!1,null,"2dccef75",null),v={name:"MaterialFlowChart",components:{FlowNode:u.exports},props:{visible:{type:Boolean,default:!1},loading:{type:Boolean,default:!1},flowData:{type:Array,default:function(){return[]}}},computed:{dialogVisible:{get:function(){return this.visible},set:function(e){this.$emit("update:visible",e)}}},data:function(){return{scale:1,minScale:.5,maxScale:2,scaleStep:.1,position:{x:0,y:0},isDragging:!1,dragStart:{x:0,y:0},lastPosition:{x:0,y:0}}},methods:{zoomIn:function(){this.scale<this.maxScale&&(this.scale=Math.min(this.scale+this.scaleStep,this.maxScale))},zoomOut:function(){this.scale>this.minScale&&(this.scale=Math.max(this.scale-this.scaleStep,this.minScale))},resetZoom:function(){this.scale=1,this.position={x:0,y:0}},handleWheel:function(e){e.ctrlKey&&(e.preventDefault(),e.deltaY<0?this.zoomIn():this.zoomOut())},startDrag:function(e){this.isDragging=!0,this.dragStart={x:e.clientX-this.position.x,y:e.clientY-this.position.y},this.lastPosition=Object(i.a)({},this.position)},onDrag:function(e){this.isDragging&&(e.preventDefault(),this.position={x:e.clientX-this.dragStart.x,y:e.clientY-this.dragStart.y})},stopDrag:function(){this.isDragging=!1}},mounted:function(){this.$el.querySelector(".flow-container").addEventListener("wheel",this.handleWheel,{passive:!1})},beforeDestroy:function(){this.$el.querySelector(".flow-container").removeEventListener("wheel",this.handleWheel)}},_=v,h=(a("b58f"),Object(d.a)(_,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"flow-chart-dialog",attrs:{title:"Áâ©ÊñôÂ∑•Ëâ∫ÊµÅÁ®ãÂõæ","custom-class":"material-flow-dialog"}},[a("div",{staticClass:"zoom-controls"},[a("el-button-group",[a("el-button",{attrs:{size:"small",icon:"el-icon-zoom-in"},on:{click:e.zoomIn}}),e._v(" "),a("el-button",{attrs:{size:"small",icon:"el-icon-zoom-out"},on:{click:e.zoomOut}}),e._v(" "),a("el-button",{attrs:{size:"small",icon:"el-icon-refresh"},on:{click:e.resetZoom}},[e._v("ÈáçÁΩÆ")])],1)],1),e._v(" "),a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"flow-container",on:{mousedown:e.startDrag,mousemove:e.onDrag,mouseup:e.stopDrag,mouseleave:e.stopDrag}},[a("div",{staticClass:"zoom-wrapper",style:{transform:"scale("+e.scale+") translate("+e.position.x+"px, "+e.position.y+"px)",cursor:e.isDragging?"grabbing":"grab"}},[e.flowData&&0!==e.flowData.length?[a("flow-node",{attrs:{node:e.flowData[0]}})]:a("div",{staticClass:"empty-data"},[e._v("\n                ÊöÇÊó†ÊµÅÁ®ãÂõæÊï∞ÊçÆ\n            ")])],2)])])}),[],!1,null,null,null)),p=h.exports,f=a("2909");function m(e){var t,a,r,s=2;for("undefined"!=typeof Symbol&&(a=Symbol.asyncIterator,r=Symbol.iterator);s--;){if(a&&null!=(t=e[a]))return t.call(e);if(r&&null!=(t=e[r]))return new b(t.call(e));a="@@asyncIterator",r="@@iterator"}throw new TypeError("Object is not async iterable")}function b(e){function t(e){if(Object(e)!==e)return Promise.reject(new TypeError(e+" is not an object."));var t=e.done;return Promise.resolve(e.value).then((function(e){return{value:e,done:t}}))}return b=function(e){this.s=e,this.n=e.next},b.prototype={s:null,n:null,next:function(){return t(this.n.apply(this.s,arguments))},return:function(e){var a=this.s.return;return void 0===a?Promise.resolve({value:e,done:!0}):t(a.apply(this.s,arguments))},throw:function(e){var a=this.s.return;return void 0===a?Promise.reject(e):t(a.apply(this.s,arguments))}},new b(e)}var g,w={name:"InspectionList",props:{inspections:{type:Object,default:function(){}}},data:function(){return{displayData:[],barcodeList:[],historyDialogVisible:!1,detailDialogVisible:!1,historyData:[],historyLoading:!1,selectedRecord:null,currentPage:1,pageSize:20,total:0,currentBarcode:"",currentProcessStep:null}},watch:{inspections:{handler:function(){var e=Object(o.a)(Object(n.a)().mark((function e(t){var a,r,s,o,i,l,d,u,v,_,h,p,b;return Object(n.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return");case 2:if(!(a=Array.isArray(t)?t[0]:t)){e.next=46;break}if(r={barcode:a.barcode,inspectionItem:"‰∏ªÁâ©Êñô",inspectionTime:null,inspector:null,materialCode:a.materialCode,materialId:a.materialId,materialName:a.materialName,materialSpec:a.materialSpec,standard:"",result:""},a.barcode,s=a.processNodes||[],o=[a.barcode].concat(Object(f.a)(s.map((function(e){return e.barcode})))).filter((function(e){return e&&e.trim()})),i=[r].concat(Object(f.a)(s)),0!==o.length){e.next=12;break}return this.displayData=[],e.abrupt("return");case 12:return e.next=14,Object(c.b)("InspectionLastData",{query:{scanCode:{$in:o}},populate:JSON.stringify([{path:"processId",select:"processCode processName processDesc processStage processType"}])});case 14:l=e.sent,d=l.data,u=!1,v=!1,e.prev=18,h=Object(n.a)().mark((function e(){var t,a,r;return Object(n.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=b.value,a=t.barcode,r=d.filter((function(e){return e.scanCode==a})),r.length>0&&(console.log("üöÄ ~ handler ~ processNode:",r),t.inspectionData=r);case 4:case"end":return e.stop()}}),e)})),p=m(i);case 21:return e.next=23,p.next();case 23:if(!(u=!(b=e.sent).done)){e.next=28;break}return e.delegateYield(h(),"t0",25);case 25:u=!1,e.next=21;break;case 28:e.next=34;break;case 30:e.prev=30,e.t1=e.catch(18),v=!0,_=e.t1;case 34:if(e.prev=34,e.prev=35,!u||null==p.return){e.next=39;break}return e.next=39,p.return();case 39:if(e.prev=39,!v){e.next=42;break}throw _;case 42:return e.finish(39);case 43:return e.finish(34);case 44:console.log("üöÄ ~ handler ~ allBarcodesData:",i),this.displayData=i.filter((function(e){return e.inspectionData}));case 46:case"end":return e.stop()}}),e,this,[[18,30,34,44],[35,,39,43]])})));return function(t){return e.apply(this,arguments)}}(),immediate:!0}},methods:{formatDate:function(e){return e?new Date(e).toLocaleString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"}):"ÊöÇÊó†Êï∞ÊçÆ"},formatValue:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";if(!e)return"Êú™ÊµãËØï";var a="number"==typeof e?Number(e).toFixed(2):e;return"".concat(a).concat(t)},showHistory:function(){var e=Object(o.a)(Object(n.a)().mark((function e(t,a){return Object(n.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.currentBarcode=t,this.currentProcessStep=a,this.historyDialogVisible=!0,this.currentPage=1,e.next=6,this.fetchHistoryData();case 6:case"end":return e.stop()}}),e,this)})));return function(t,a){return e.apply(this,arguments)}}(),fetchHistoryData:function(){var e=Object(o.a)(Object(n.a)().mark((function e(){var t,a;return Object(n.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.historyLoading=!0,e.prev=1,t={scanCode:this.currentBarcode},this.currentProcessStep&&(t.processId=this.currentProcessStep._id),e.next=6,Object(c.b)("InspectionData",{query:t,page:this.currentPage,limit:this.pageSize,sort:{createTime:-1},populate:JSON.stringify([{path:"processId",select:"processCode processName processDesc processStage processType"}])});case 6:a=e.sent,this.historyData=a.data,this.total=a.total,e.next=15;break;case 11:e.prev=11,e.t0=e.catch(1),console.error("Ëé∑ÂèñÂéÜÂè≤Êï∞ÊçÆÂ§±Ë¥•:",e.t0),this.$message.error("Ëé∑ÂèñÂéÜÂè≤Êï∞ÊçÆÂ§±Ë¥•");case 15:return e.prev=15,this.historyLoading=!1,e.finish(15);case 18:case"end":return e.stop()}}),e,this,[[1,11,15,18]])})));return function(){return e.apply(this,arguments)}}(),handleClose:function(){this.historyDialogVisible=!1,this.historyData=[],this.currentBarcode="",this.currentProcessStep=null},showHistoryDetail:function(e){this.selectedRecord=e,this.detailDialogVisible=!0},handleSizeChange:function(e){this.pageSize=e,this.fetchHistoryData()},handleCurrentChange:function(e){this.currentPage=e,this.fetchHistoryData()},hasLampBoardTestData:function(e){return e.red||e.blue||e.infrared||e.red2||e.blue2||e.infrared2},hasSemiFinishedTestData:function(e){return e.udiCode||e.lampBoardQrCode||e.batteryCellCode},hasTemperatureTestData:function(e){return e.instrumentNtcDifferenceBeforeCooling||e.coolingStatus},hasVoltageWithstandTestData:function(e){return e.chargingTest||e.withstandVoltageTest},hasFullMachineTestData:function(e){return e.cellCode||e.handheldControllerPcbaCode},hasWeightData:function(e){return e.weight},hasRemoteControlTestData:function(e){return e.showSerialNo||e.chkPowerOn||e.enterDebugMode}},computed:{}},C=w,y=(a("fdfc"),Object(d.a)(C,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-table",{attrs:{data:e.displayData,border:"","header-cell-style":{background:"#f5f7fa",color:"#606266",fontWeight:"bold",textAlign:"center"},"cell-style":{textAlign:"center"}}},[a("el-table-column",{attrs:{label:"Êù°Á†Å",prop:"barcode"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tooltip",{attrs:{content:t.row.barcode,placement:"top",effect:"light"}},[a("span",[e._v(e._s(t.row.barcode))])])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"Áâ©Êñô‰ø°ÊÅØ"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticClass:"material-info"},[a("div",[e._v("Áâ©ÊñôÁºñÁ†ÅÔºö"+e._s(t.row.materialCode))]),e._v(" "),a("div",[e._v("Áâ©ÊñôÂêçÁß∞Ôºö"+e._s(t.row.materialName))]),e._v(" "),t.row.materialSpec?a("div",[e._v("ËßÑÊ†ºÔºö"+e._s(t.row.materialSpec))]):e._e()])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"Ê£ÄÊµãÁªìÊûú",width:"300"},scopedSlots:e._u([{key:"default",fn:function(t){return e._l(t.row.inspectionData,(function(r,s){return a("div",{key:s,staticClass:"inspection-result"},[a("div",{staticClass:"result-info"},[r?a("el-popover",{attrs:{placement:"right",width:"500",trigger:"hover"}},[a("div",{staticClass:"test-details"},[a("div",{staticClass:"detail-section"},[a("div",{staticClass:"section-title"},[e._v("Âü∫Á°Ä‰ø°ÊÅØ")]),e._v(" "),r.startDate?a("div",[e._v("Êó•ÊúüÔºö"+e._s(r.startDate))]):e._e(),e._v(" "),r.workstation?a("div",[e._v("Â∑•‰ΩçÂè∑Ôºö"+e._s(r.workstation))]):e._e(),e._v(" "),r.productModel?a("div",[e._v("‰∫ßÂìÅÂûãÂè∑Ôºö"+e._s(r.productModel))]):e._e()]),e._v(" "),e.hasLampBoardTestData(r)?a("div",{staticClass:"detail-section"},[a("div",{staticClass:"section-title"},[e._v("Èù¢ÁΩ©ÁÅØÊùøÊµãËØï")]),e._v(" "),r.red?a("div",[e._v("Á∫¢Ëâ≤Ôºö"+e._s(r.red))]):e._e(),e._v(" "),r.blue?a("div",[e._v("ËìùËâ≤Ôºö"+e._s(r.blue))]):e._e(),e._v(" "),r.infrared?a("div",[e._v("Á∫¢Â§ñÔºö"+e._s(r.infrared))]):e._e(),e._v(" "),r.red2?a("div",[e._v("Á∫¢Ëâ≤2Ôºö"+e._s(r.red2))]):e._e(),e._v(" "),r.blue2?a("div",[e._v("ËìùËâ≤2Ôºö"+e._s(r.blue2))]):e._e(),e._v(" "),r.infrared2?a("div",[e._v("Á∫¢Â§ñ2Ôºö"+e._s(r.infrared2))]):e._e()]):e._e(),e._v(" "),e.hasSemiFinishedTestData(r)?a("div",{staticClass:"detail-section"},[a("div",{staticClass:"section-title"},[e._v("Èù¢ÁΩ©ÂçäÊàêÂìÅÊµãËØï")]),e._v(" "),r.udiCode?a("div",[e._v("UDIÁ†ÅÔºö"+e._s(r.udiCode))]):e._e(),e._v(" "),r.lampBoardQrCode?a("div",[e._v("ÁÅØÊùø‰∫åÁª¥Á†ÅÔºö"+e._s(r.lampBoardQrCode))]):e._e(),e._v(" "),r.batteryCellCode?a("div",[e._v("ÁîµËäØÁ†ÅÔºö"+e._s(r.batteryCellCode))]):e._e(),e._v(" "),r.chargingBoardPcbaCode?a("div",[e._v("ÂÖÖÁîµÊùøPCBAÁ†ÅÔºö"+e._s(r.chargingBoardPcbaCode))]):e._e(),e._v(" "),r.maskPcbaCode?a("div",[e._v("Èù¢ÁΩ©PCBAÁ†ÅÔºö"+e._s(r.maskPcbaCode))]):e._e(),e._v(" "),r.controllerPcbaCode?a("div",[e._v("ÊâãÊéßÂô®PCBAÁ†ÅÔºö"+e._s(r.controllerPcbaCode))]):e._e(),e._v(" "),r.controllerSoftwareVersion?a("div",[e._v("ÊâãÊéßÂô®ËΩØ‰ª∂ÁâàÊú¨Ôºö"+e._s(r.controllerSoftwareVersion))]):e._e(),e._v(" "),r.maskSoftwareVersion?a("div",[e._v("Èù¢ÁΩ©ËΩØ‰ª∂ÁâàÊú¨Ôºö"+e._s(r.maskSoftwareVersion))]):e._e(),e._v(" "),r.controllerFactoryQrCode?a("div",[e._v("ÊâãÊéßÂô®Âá∫ÂéÇ‰∫åÁª¥Á†ÅÔºö"+e._s(r.controllerFactoryQrCode))]):e._e(),e._v(" "),r.faceDetectionProgramVersion?a("div",[e._v("Èù¢ÈÉ®Êé¢ÊµãÁ®ãÂ∫èÁâàÊú¨Ôºö"+e._s(r.faceDetectionProgramVersion))]):e._e(),e._v(" "),r.circuitFaultCode?a("div",[e._v("ÁîµË∑ØÊïÖÈöúÁ†ÅÔºö"+e._s(r.circuitFaultCode)+"\n                  ")]):e._e(),e._v(" "),a("div",{staticClass:"sub-section"},[a("div",{staticClass:"sub-title"},[e._v("ÂÖâÊ≥¢ÂèÇÊï∞")]),e._v(" "),r.redLightWavelength?a("div",[e._v("Á∫¢ÁÅØÊ≥¢ÈïøÔºö"+e._s(r.redLightWavelength)+"\n                    ")]):e._e(),e._v(" "),r.blueLightWavelength?a("div",[e._v("ËìùÁÅØÊ≥¢ÈïøÔºö"+e._s(r.blueLightWavelength))]):e._e(),e._v(" "),r.infraredLightWavelength?a("div",[e._v("Á∫¢Â§ñÁÅØÊ≥¢ÈïøÔºö"+e._s(r.infraredLightWavelength))]):e._e(),e._v(" "),r.redLightCurrent?a("div",[e._v("Á∫¢ÁÅØÁîµÊµÅÔºö"+e._s(r.redLightCurrent))]):e._e(),e._v(" "),r.blueLightCurrent?a("div",[e._v("ËìùÁÅØÁîµÊµÅÔºö"+e._s(r.blueLightCurrent)+"\n                    ")]):e._e(),e._v(" "),r.infraredLightCurrent?a("div",[e._v("Á∫¢Â§ñÁÅØÁîµÊµÅÔºö"+e._s(r.infraredLightCurrent))]):e._e(),e._v(" "),r.msiLightCurrent?a("div",[e._v("MSIÁÅØÁîµÊµÅÔºö"+e._s(r.msiLightCurrent)+"\n                    ")]):e._e()]),e._v(" "),a("div",{staticClass:"sub-section"},[a("div",{staticClass:"sub-title"},[e._v("ÁîµÊ±†ÂèÇÊï∞")]),e._v(" "),r.batteryVoltage?a("div",[e._v("ÁîµÊ±†ÁîµÂéãÔºö"+e._s(r.batteryVoltage))]):e._e(),e._v(" "),r.dischargeCurrent?a("div",[e._v("ÊîæÁîµÁîµÊµÅÔºö"+e._s(r.dischargeCurrent)+"\n                    ")]):e._e(),e._v(" "),r.batteryPower?a("div",[e._v("ÁîµÊ±†ÁîµÈáèÔºö"+e._s(r.batteryPower))]):e._e(),e._v(" "),r.batteryCell1Voltage?a("div",[e._v("ÁîµËäØ1ÁîµÂéãÔºö"+e._s(r.batteryCell1Voltage))]):e._e(),e._v(" "),r.batteryCell2Voltage?a("div",[e._v("ÁîµËäØ2ÁîµÂéãÔºö"+e._s(r.batteryCell2Voltage))]):e._e()]),e._v(" "),a("div",{staticClass:"sub-section"},[a("div",{staticClass:"sub-title"},[e._v("‰º†ÊÑüÂô®ÂèÇÊï∞")]),e._v(" "),r.faceSensorStatus?a("div",[e._v("Èù¢ÈÉ®‰º†ÊÑüÂô®Áä∂ÊÄÅÔºö"+e._s(r.faceSensorStatus)+"\n                    ")]):e._e(),e._v(" "),r.faceSensorValue?a("div",[e._v("Èù¢ÈÉ®‰º†ÊÑüÂô®ÂÄºÔºö"+e._s(r.faceSensorValue)+"\n                    ")]):e._e(),e._v(" "),r.fanCurrent?a("div",[e._v("È£éÊâáÁîµÊµÅÔºö"+e._s(r.fanCurrent))]):e._e()])]):e._e(),e._v(" "),e.hasTemperatureTestData(r)?a("div",{staticClass:"detail-section"},[a("div",{staticClass:"section-title"},[e._v("Èù¢ÁΩ©Ê∏©Â∫¶ÊµãËØï")]),e._v(" "),r.instrumentNtcDifferenceBeforeCooling?a("div",[e._v("Âà∂ÂÜ∑ÂâçNTCÂ∑ÆÂÄºÔºö"+e._s(r.instrumentNtcDifferenceBeforeCooling))]):e._e(),e._v(" "),r.productAndInstrumentNtc1Difference?a("div",[e._v("‰∫ßÂìÅNTC1Âíå‰ª™Âô®NTC1Â∑ÆÂÄºÔºö"+e._s(r.productAndInstrumentNtc1Difference))]):e._e(),e._v(" "),r.productAndInstrumentNtc2Difference?a("div",[e._v("‰∫ßÂìÅNTC2Âíå‰ª™Âô®NTC2Â∑ÆÂÄºÔºö"+e._s(r.productAndInstrumentNtc2Difference))]):e._e(),e._v(" "),r.coolingStatus?a("div",[e._v("Âà∂ÂÜ∑Áä∂ÊÄÅÔºö"+e._s(r.coolingStatus))]):e._e(),e._v(" "),r.coolingSetTemperature?a("div",[e._v("Âà∂ÂÜ∑ËÆæÁΩÆÊ∏©Â∫¶Ôºö"+e._s(r.coolingSetTemperature))]):e._e()]):e._e(),e._v(" "),e.hasVoltageWithstandTestData(r)?a("div",{staticClass:"detail-section"},[a("div",{staticClass:"section-title"},[e._v("ËÄêÂéãÊµãËØï")]),e._v(" "),r.chargingTest?a("div",[e._v("ÂÖÖÁîµÊµãËØïÔºö"+e._s(r.chargingTest))]):e._e(),e._v(" "),r.withstandVoltageTest?a("div",[e._v("ËÄêÂéãÊµãËØïÔºö"+e._s(r.withstandVoltageTest))]):e._e()]):e._e(),e._v(" "),e.hasFullMachineTestData(r)?a("div",{staticClass:"detail-section"},[a("div",{staticClass:"section-title"},[e._v("Êï¥Êú∫ÁÅØÂÖâÊµãËØï")]),e._v(" "),r.cellCode?a("div",[e._v("ÁîµËäØÁ†ÅÔºö"+e._s(r.cellCode))]):e._e(),e._v(" "),r.handheldControllerPcbaCode?a("div",[e._v("ÊâãÊéßÂô®PCBAÁ†ÅÔºö"+e._s(r.handheldControllerPcbaCode))]):e._e(),e._v(" "),r.handheldSoftwareVersion?a("div",[e._v("ÊâãÊéßÂô®ËΩØ‰ª∂ÁâàÊú¨Ôºö"+e._s(r.handheldSoftwareVersion))]):e._e(),e._v(" "),r.handheldFactoryQrCode?a("div",[e._v("ÊâãÊéßÂô®Âá∫ÂéÇ‰∫åÁª¥Á†ÅÔºö"+e._s(r.handheldFactoryQrCode))]):e._e(),e._v(" "),r.batteryCapacity?a("div",[e._v("ÁîµÊ±†ÁîµÈáèÔºö"+e._s(r.batteryCapacity))]):e._e(),e._v(" "),r.cell1Voltage?a("div",[e._v("ÁîµËäØ1ÁîµÂéãÔºö"+e._s(r.cell1Voltage))]):e._e(),e._v(" "),r.cell2Voltage?a("div",[e._v("ÁîµËäØ2ÁîµÂéãÔºö"+e._s(r.cell2Voltage))]):e._e(),e._v(" "),r.meterChargingCurrent?a("div",[e._v("‰ª™Ë°®ÂÖÖÁîµÁîµÊµÅÔºö"+e._s(r.meterChargingCurrent))]):e._e()]):e._e(),e._v(" "),e.hasWeightData(r)?a("div",{staticClass:"detail-section"},[a("div",{staticClass:"section-title"},[e._v("ÁîµÂ≠êÁß§ÈáçÈáè")]),e._v(" "),r.weight?a("div",[e._v("Áß∞ÈáçÈáçÈáèÔºö"+e._s(r.weight))]):e._e()]):e._e(),e._v(" "),e.hasRemoteControlTestData(r)?a("div",{staticClass:"detail-section"},[a("div",{staticClass:"section-title"},[e._v("ÈÅ•ÊéßÊµãËØï")]),e._v(" "),r.showSerialNo?a("div",[e._v("ÊòæÁ§∫Â∫èÂàóÂè∑Ôºö"+e._s(r.showSerialNo))]):e._e(),e._v(" "),r.chkPowerOn?a("div",[e._v("‰∏äÁîµÂºÄÊú∫Ôºö"+e._s(r.chkPowerOn))]):e._e(),e._v(" "),r.enterDebugMode?a("div",[e._v("ËøõÂÖ•Ë∞ÉËØïÊ®°ÂºèÔºö"+e._s(r.enterDebugMode))]):e._e(),e._v(" "),r.readAllKeyOff?a("div",[e._v("ÊåâÈîÆÂÖ≥Èó≠Áä∂ÊÄÅÔºö"+e._s(r.readAllKeyOff))]):e._e(),e._v(" "),r.readK4K5?a("div",[e._v("Â∑¶Âè≥ÈîÆÁä∂ÊÄÅÔºö"+e._s(r.readK4K5))]):e._e(),e._v(" "),r.readPotentiometer?a("div",[e._v("ÁºñÁ†ÅÂºÄÂÖ≥Ôºö"+e._s(r.readPotentiometer)+"\n                  ")]):e._e(),e._v(" "),r.chkUiVersion?a("div",[e._v("ËΩØ‰ª∂ÁâàÊú¨Ôºö"+e._s(r.chkUiVersion))]):e._e(),e._v(" "),r.chkUiTx?a("div",[e._v("ÈÄöËÆØÂè£Ê†°È™åÔºö"+e._s(r.chkUiTx))]):e._e()]):e._e(),e._v(" "),r.passFail?a("div",{staticClass:"detail-section"},[a("div",{staticClass:"section-title"},[e._v("ÊµãËØïÁªìÊûú")]),e._v(" "),r.passFail?a("div",[e._v("ÊµãËØïÁªìÊûúÔºö"+e._s(r.passFail))]):e._e(),e._v(" "),r.testTime?a("div",[e._v("ÊµãËØïËÄóÊó∂Ôºö"+e._s(r.testTime)+"Áßí")]):e._e(),e._v(" "),r.startTime?a("div",[e._v("ÂºÄÂßãÊó∂Èó¥Ôºö"+e._s(r.startTime))]):e._e()]):e._e()]),e._v(" "),a("div",{staticClass:"result-main",attrs:{slot:"reference"},slot:"reference"},[a("div",{staticClass:"process-info"},[r.processId?a("el-tag",{attrs:{type:r.error?"danger":"success",size:"small"}},[e._v(e._s(r.processId.processName))]):e._e(),e._v(" "),r.processId?a("span",[e._v("("+e._s(r.processId.processStage)+")")]):e._e()],1),e._v(" "),a("span",{class:{success:!1===r.error,error:!0===r.error}},[e._v(e._s(r.error?"‰∏çÂêàÊ†º":"ÂêàÊ†º"))])])]):e._e(),e._v(" "),a("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(a){return e.showHistory(t.row.barcode,r.processId)}}},[e._v("ÂéÜÂè≤ËÆ∞ÂΩï")])],1)])}))}}])})],1),e._v(" "),a("el-dialog",{attrs:{title:"Ê£ÄÊµãÂéÜÂè≤ËÆ∞ÂΩï","append-to-body":"",visible:e.historyDialogVisible,width:"80%","before-close":e.handleClose},on:{"update:visible":function(t){e.historyDialogVisible=t}}},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.historyLoading,expression:"historyLoading"}],attrs:{data:e.historyData,border:"",stripe:"",height:"500"}},[a("el-table-column",{attrs:{label:"Ê£ÄÊµãÊó∂Èó¥",prop:"testTime",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n          "+e._s(e.formatDate(t.row.testTime||t.row.createTime))+"\n        ")]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"Ê£ÄÊµãÁªìÊûú",prop:"allTestEnd",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",{class:{success:"PASS"===t.row.allTestEnd,error:"FAIL"===t.row.allTestEnd}},[e._v("\n            "+e._s(t.row.allTestEnd)+"\n          ")])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"ÁîµÊ±†ÂåÖÁîµÂéã",prop:"readPackVol",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticClass:"result-info"},[a("el-popover",{attrs:{placement:"right",width:"500",trigger:"hover"}},[a("div",{staticClass:"test-details"},[a("div",{staticClass:"detail-section"},[a("div",{staticClass:"section-title"},[e._v("Âü∫Á°Ä‰ø°ÊÅØ")]),e._v(" "),t.row.startDate?a("div",[e._v("Êó•ÊúüÔºö"+e._s(t.row.startDate))]):e._e(),e._v(" "),t.row.workstation?a("div",[e._v("Â∑•‰ΩçÂè∑Ôºö"+e._s(t.row.workstation))]):e._e(),e._v(" "),t.row.productModel?a("div",[e._v("‰∫ßÂìÅÂûãÂè∑Ôºö"+e._s(t.row.productModel))]):e._e()]),e._v(" "),t.row.red?a("div",{staticClass:"detail-section"},[a("div",{staticClass:"section-title"},[e._v("Èù¢ÁΩ©ÁÅØÊùøÊµãËØï")]),e._v(" "),t.row.red?a("div",[e._v("Á∫¢Ëâ≤Ôºö"+e._s(t.row.red))]):e._e(),e._v(" "),t.row.blue?a("div",[e._v("ËìùËâ≤Ôºö"+e._s(t.row.blue))]):e._e(),e._v(" "),t.row.infrared?a("div",[e._v("Á∫¢Â§ñÔºö"+e._s(t.row.infrared))]):e._e(),e._v(" "),t.row.red2?a("div",[e._v("Á∫¢Ëâ≤2Ôºö"+e._s(t.row.red2))]):e._e(),e._v(" "),t.row.blue2?a("div",[e._v("ËìùËâ≤2Ôºö"+e._s(t.row.blue2))]):e._e(),e._v(" "),t.row.infrared2?a("div",[e._v("Á∫¢Â§ñ2Ôºö"+e._s(t.row.infrared2))]):e._e()]):e._e(),e._v(" "),t.row.udiCode?a("div",{staticClass:"detail-section"},[a("div",{staticClass:"section-title"},[e._v("Èù¢ÁΩ©ÂçäÊàêÂìÅÊµãËØï")]),e._v(" "),t.row.udiCode?a("div",[e._v("UDIÁ†ÅÔºö"+e._s(t.row.udiCode))]):e._e(),e._v(" "),t.row.lampBoardQrCode?a("div",[e._v("ÁÅØÊùø‰∫åÁª¥Á†ÅÔºö"+e._s(t.row.lampBoardQrCode))]):e._e(),e._v(" "),t.row.batteryCellCode?a("div",[e._v("ÁîµËäØÁ†ÅÔºö"+e._s(t.row.batteryCellCode))]):e._e(),e._v(" "),t.row.chargingBoardPcbaCode?a("div",[e._v("ÂÖÖÁîµÊùøPCBAÁ†ÅÔºö"+e._s(t.row.chargingBoardPcbaCode))]):e._e(),e._v(" "),t.row.maskPcbaCode?a("div",[e._v("Èù¢ÁΩ©PCBAÁ†ÅÔºö"+e._s(t.row.maskPcbaCode))]):e._e(),e._v(" "),t.row.controllerPcbaCode?a("div",[e._v("ÊâãÊéßÂô®PCBAÁ†ÅÔºö"+e._s(t.row.controllerPcbaCode))]):e._e(),e._v(" "),t.row.controllerSoftwareVersion?a("div",[e._v("ÊâãÊéßÂô®ËΩØ‰ª∂ÁâàÊú¨Ôºö"+e._s(t.row.controllerSoftwareVersion)+"\n                  ")]):e._e(),e._v(" "),t.row.maskSoftwareVersion?a("div",[e._v("Èù¢ÁΩ©ËΩØ‰ª∂ÁâàÊú¨Ôºö"+e._s(t.row.maskSoftwareVersion))]):e._e(),e._v(" "),t.row.controllerFactoryQrCode?a("div",[e._v("ÊâãÊéßÂô®Âá∫ÂéÇ‰∫åÁª¥Á†ÅÔºö"+e._s(t.row.controllerFactoryQrCode))]):e._e(),e._v(" "),t.row.faceDetectionProgramVersion?a("div",[e._v("Èù¢ÈÉ®Êé¢ÊµãÁ®ãÂ∫èÁâàÊú¨Ôºö"+e._s(t.row.faceDetectionProgramVersion))]):e._e(),e._v(" "),t.row.circuitFaultCode?a("div",[e._v("ÁîµË∑ØÊïÖÈöúÁ†ÅÔºö"+e._s(t.row.circuitFaultCode))]):e._e(),e._v(" "),a("div",{staticClass:"sub-section"},[a("div",{staticClass:"sub-title"},[e._v("ÂÖâÊ≥¢ÂèÇÊï∞")]),e._v(" "),t.row.redLightWavelength?a("div",[e._v("Á∫¢ÁÅØÊ≥¢ÈïøÔºö"+e._s(t.row.redLightWavelength))]):e._e(),e._v(" "),t.row.blueLightWavelength?a("div",[e._v("ËìùÁÅØÊ≥¢ÈïøÔºö"+e._s(t.row.blueLightWavelength))]):e._e(),e._v(" "),t.row.infraredLightWavelength?a("div",[e._v("Á∫¢Â§ñÁÅØÊ≥¢ÈïøÔºö"+e._s(t.row.infraredLightWavelength))]):e._e(),e._v(" "),t.row.redLightCurrent?a("div",[e._v("Á∫¢ÁÅØÁîµÊµÅÔºö"+e._s(t.row.redLightCurrent))]):e._e(),e._v(" "),t.row.blueLightCurrent?a("div",[e._v("ËìùÁÅØÁîµÊµÅÔºö"+e._s(t.row.blueLightCurrent))]):e._e(),e._v(" "),t.row.infraredLightCurrent?a("div",[e._v("Á∫¢Â§ñÁÅØÁîµÊµÅÔºö"+e._s(t.row.infraredLightCurrent))]):e._e(),e._v(" "),t.row.msiLightCurrent?a("div",[e._v("MSIÁÅØÁîµÊµÅÔºö"+e._s(t.row.msiLightCurrent))]):e._e()]),e._v(" "),a("div",{staticClass:"sub-section"},[a("div",{staticClass:"sub-title"},[e._v("ÁîµÊ±†ÂèÇÊï∞")]),e._v(" "),t.row.batteryVoltage?a("div",[e._v("ÁîµÊ±†ÁîµÂéãÔºö"+e._s(t.row.batteryVoltage))]):e._e(),e._v(" "),t.row.dischargeCurrent?a("div",[e._v("ÊîæÁîµÁîµÊµÅÔºö"+e._s(t.row.dischargeCurrent))]):e._e(),e._v(" "),t.row.batteryPower?a("div",[e._v("ÁîµÊ±†ÁîµÈáèÔºö"+e._s(t.row.batteryPower))]):e._e(),e._v(" "),t.row.batteryCell1Voltage?a("div",[e._v("ÁîµËäØ1ÁîµÂéãÔºö"+e._s(t.row.batteryCell1Voltage))]):e._e(),e._v(" "),t.row.batteryCell2Voltage?a("div",[e._v("ÁîµËäØ2ÁîµÂéãÔºö"+e._s(t.row.batteryCell2Voltage))]):e._e()]),e._v(" "),a("div",{staticClass:"sub-section"},[a("div",{staticClass:"sub-title"},[e._v("‰º†ÊÑüÂô®ÂèÇÊï∞")]),e._v(" "),t.row.faceSensorStatus?a("div",[e._v("Èù¢ÈÉ®‰º†ÊÑüÂô®Áä∂ÊÄÅÔºö"+e._s(t.row.faceSensorStatus))]):e._e(),e._v(" "),t.row.faceSensorValue?a("div",[e._v("Èù¢ÈÉ®‰º†ÊÑüÂô®ÂÄºÔºö"+e._s(t.row.faceSensorValue))]):e._e(),e._v(" "),t.row.fanCurrent?a("div",[e._v("È£éÊâáÁîµÊµÅÔºö"+e._s(t.row.fanCurrent))]):e._e()])]):e._e(),e._v(" "),t.row.instrumentNtcDifferenceBeforeCooling?a("div",{staticClass:"detail-section"},[a("div",{staticClass:"section-title"},[e._v("Èù¢ÁΩ©Ê∏©Â∫¶ÊµãËØï")]),e._v(" "),t.row.instrumentNtcDifferenceBeforeCooling?a("div",[e._v("Âà∂ÂÜ∑ÂâçNTCÂ∑ÆÂÄºÔºö"+e._s(t.row.instrumentNtcDifferenceBeforeCooling))]):e._e(),e._v(" "),t.row.productAndInstrumentNtc1Difference?a("div",[e._v("‰∫ßÂìÅNTC1Âíå‰ª™Âô®NTC1Â∑ÆÂÄºÔºö"+e._s(t.row.productAndInstrumentNtc1Difference))]):e._e(),e._v(" "),t.row.productAndInstrumentNtc2Difference?a("div",[e._v("‰∫ßÂìÅNTC2Âíå‰ª™Âô®NTC2Â∑ÆÂÄºÔºö"+e._s(t.row.productAndInstrumentNtc2Difference))]):e._e(),e._v(" "),t.row.coolingStatus?a("div",[e._v("Âà∂ÂÜ∑Áä∂ÊÄÅÔºö"+e._s(t.row.coolingStatus))]):e._e(),e._v(" "),t.row.coolingSetTemperature?a("div",[e._v("Âà∂ÂÜ∑ËÆæÁΩÆÊ∏©Â∫¶Ôºö"+e._s(t.row.coolingSetTemperature))]):e._e()]):e._e(),e._v(" "),t.row.chargingTest?a("div",{staticClass:"detail-section"},[a("div",{staticClass:"section-title"},[e._v("ËÄêÂéãÊµãËØï")]),e._v(" "),t.row.chargingTest?a("div",[e._v("ÂÖÖÁîµÊµãËØïÔºö"+e._s(t.row.chargingTest))]):e._e(),e._v(" "),t.row.withstandVoltageTest?a("div",[e._v("ËÄêÂéãÊµãËØïÔºö"+e._s(t.row.withstandVoltageTest))]):e._e()]):e._e(),e._v(" "),t.row.cellCode?a("div",{staticClass:"detail-section"},[a("div",{staticClass:"section-title"},[e._v("Êï¥Êú∫ÁÅØÂÖâÊµãËØï")]),e._v(" "),t.row.cellCode?a("div",[e._v("ÁîµËäØÁ†ÅÔºö"+e._s(t.row.cellCode))]):e._e(),e._v(" "),t.row.handheldControllerPcbaCode?a("div",[e._v("ÊâãÊéßÂô®PCBAÁ†ÅÔºö"+e._s(t.row.handheldControllerPcbaCode)+"\n                  ")]):e._e(),e._v(" "),t.row.handheldSoftwareVersion?a("div",[e._v("ÊâãÊéßÂô®ËΩØ‰ª∂ÁâàÊú¨Ôºö"+e._s(t.row.handheldSoftwareVersion))]):e._e(),e._v(" "),t.row.handheldFactoryQrCode?a("div",[e._v("ÊâãÊéßÂô®Âá∫ÂéÇ‰∫åÁª¥Á†ÅÔºö"+e._s(t.row.handheldFactoryQrCode))]):e._e(),e._v(" "),t.row.batteryCapacity?a("div",[e._v("ÁîµÊ±†ÁîµÈáèÔºö"+e._s(t.row.batteryCapacity))]):e._e(),e._v(" "),t.row.cell1Voltage?a("div",[e._v("ÁîµËäØ1ÁîµÂéãÔºö"+e._s(t.row.cell1Voltage))]):e._e(),e._v(" "),t.row.cell2Voltage?a("div",[e._v("ÁîµËäØ2ÁîµÂéãÔºö"+e._s(t.row.cell2Voltage))]):e._e(),e._v(" "),t.row.meterChargingCurrent?a("div",[e._v("‰ª™Ë°®ÂÖÖÁîµÁîµÊµÅÔºö"+e._s(t.row.meterChargingCurrent))]):e._e()]):e._e(),e._v(" "),t.row.weight?a("div",{staticClass:"detail-section"},[a("div",{staticClass:"section-title"},[e._v("ÁîµÂ≠êÁß§ÈáçÈáè")]),e._v(" "),t.row.weight?a("div",[e._v("Áß∞ÈáçÈáçÈáèÔºö"+e._s(t.row.weight))]):e._e()]):e._e(),e._v(" "),t.row.showSerialNo?a("div",{staticClass:"detail-section"},[a("div",{staticClass:"section-title"},[e._v("ÈÅ•ÊéßÊµãËØï")]),e._v(" "),t.row.showSerialNo?a("div",[e._v("ÊòæÁ§∫Â∫èÂàóÂè∑Ôºö"+e._s(t.row.showSerialNo))]):e._e(),e._v(" "),t.row.chkPowerOn?a("div",[e._v("‰∏äÁîµÂºÄÊú∫Ôºö"+e._s(t.row.chkPowerOn))]):e._e(),e._v(" "),t.row.enterDebugMode?a("div",[e._v("ËøõÂÖ•Ë∞ÉËØïÊ®°ÂºèÔºö"+e._s(t.row.enterDebugMode))]):e._e(),e._v(" "),t.row.readAllKeyOff?a("div",[e._v("ÊåâÈîÆÂÖ≥Èó≠Áä∂ÊÄÅÔºö"+e._s(t.row.readAllKeyOff))]):e._e(),e._v(" "),t.row.readK4K5?a("div",[e._v("Â∑¶Âè≥ÈîÆÁä∂ÊÄÅÔºö"+e._s(t.row.readK4K5))]):e._e(),e._v(" "),t.row.readPotentiometer?a("div",[e._v("ÁºñÁ†ÅÂºÄÂÖ≥Ôºö"+e._s(t.row.readPotentiometer))]):e._e(),e._v(" "),t.row.chkUiVersion?a("div",[e._v("ËΩØ‰ª∂ÁâàÊú¨Ôºö"+e._s(t.row.chkUiVersion))]):e._e(),e._v(" "),t.row.chkUiTx?a("div",[e._v("ÈÄöËÆØÂè£Ê†°È™åÔºö"+e._s(t.row.chkUiTx))]):e._e()]):e._e(),e._v(" "),a("div",{staticClass:"detail-section"},[a("div",{staticClass:"section-title"},[e._v("ÊµãËØïÁªìÊûú")]),e._v(" "),t.row.passFail?a("div",[e._v("ÊµãËØïÁªìÊûúÔºö"+e._s(t.row.passFail))]):e._e(),e._v(" "),t.row.testTime?a("div",[e._v("ÊµãËØïËÄóÊó∂Ôºö"+e._s(t.row.testTime)+"Áßí")]):e._e(),e._v(" "),t.row.startTime?a("div",[e._v("ÂºÄÂßãÊó∂Èó¥Ôºö"+e._s(t.row.startTime))]):e._e()])]),e._v(" "),a("div",{staticClass:"result-main"},[a("span",{class:{success:!t.row.error,error:t.row.error}},[e._v(e._s(t.row.error?"‰∏çÂêàÊ†º":"ÂêàÊ†º"))]),e._v(" "),a("span",{staticClass:"time"},[e._v(e._s(e.formatDate(t.row.testTime||t.row.createTime)))])])])],1)]}}])})],1),e._v(" "),a("div",{staticClass:"pagination-container"},[a("el-pagination",{attrs:{"current-page":e.currentPage,"page-sizes":[10,20,50,100],"page-size":e.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)],1)],1)}),[],!1,null,"461ddc81",null)),S=y.exports,x=a("ed91"),k=a("1146"),O=a.n(k),D=a("c4e3"),T=a.n(D),N=a("21a6"),j=a.n(N),P={name:"SaleOrder",components:{ProcessStepList:p,InspectionList:S},data:function(){return{searchForm:{barcode:"",materialCode:"",status:"",dateRange:[],progress:""},tableList:[],total:0,currentPage:1,pageSize:10,listLoading:!0,showAdvanced:!1,dialogFormVisible:!1,dialogStatus:"",selection:[],dataForm:{barcode:"",materialCode:"",materialName:"",materialSpec:"",craftVersion:"",startTime:null,planCompletionTime:null,endTime:null,status:"PENDING",progress:0,processNodes:[],remark:""},rules:{FCustomerName:[{required:!0,message:"ËØ∑ËæìÂÖ•ÂÆ¢Êà∑ÂêçÁß∞",trigger:"blur"}],FDate:[{required:!0,message:"ËØ∑ÈÄâÊã©ËÆ¢ÂçïÊó•Êúü",trigger:"change"}],FSaleDeptName:[{required:!0,message:"ËØ∑ËæìÂÖ•ÈîÄÂîÆÈÉ®Èó®",trigger:"blur"}]},processedFlowChartData:[],activeTab:"process",barcodeSearchVisible:!1,searchBarcode:"",searchResults:[],searchLoading:!1,unbindRecord:[],exportDialogVisible:!1,exportForm:{exportOption:"current"},exportLoading:!1}},computed:{processedMaterialBarcodeData:function(){if(!this.dataForm.processNodes)return[];var e=new Map;return this.dataForm.processNodes.forEach((function(t){"PROCESS_STEP"===t.nodeType&&e.set(t.nodeId,{processName:t.processName,processCode:t.processCode})})),this.dataForm.processNodes.filter((function(e){return"MATERIAL"===e.nodeType&&e.barcode})).map((function(t){var a=t.parentNodeId?e.get(t.parentNodeId):null;return Object(i.a)(Object(i.a)({},t),{},{processName:a?a.processName:"-",processCode:a?a.processCode:""})})).sort((function(e,t){return new Date(t.scanTime||0)-new Date(e.scanTime||0)}))},formattedUnbindRecord:function(){var e=this;return this.unbindRecord.map((function(t){return Object(i.a)(Object(i.a)({},t),{},{formattedTime:e.formatDate(t.operateTime),materialList:t.unbindMaterials?t.unbindMaterials.map((function(e){return Object(i.a)(Object(i.a)({},e),{},{displayText:"".concat(e.materialCode," - ").concat(e.materialName)})})):[]})}))}},methods:(g={handleUnbind:function(){var e=Object(o.a)(Object(n.a)().mark((function e(t){var a,r,s,o,i,c=this;return Object(n.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.$confirm("Ê≠§Êìç‰ΩúÂ∞ÜËß£ÁªëÂΩìÂâçÂ∑•Â∫èÂèäÂÖ∂ÂêéÁª≠ÊâÄÊúâÂ∑•Â∫èÁöÑÁâ©ÊñôÔºåÊòØÂê¶ÁªßÁª≠Ôºü","Ëß£ÁªëÁ°ÆËÆ§",{confirmButtonText:"Á°ÆÂÆö",cancelButtonText:"ÂèñÊ∂à",type:"warning",showInput:!0,inputPlaceholder:"ËØ∑ËæìÂÖ•Ëß£ÁªëÂéüÂõ†(ÈùûÂøÖÂ°´)",inputValidator:function(e){return!0}});case 3:if(a=e.sent,r=a.value,s=this.$loading({lock:!0,text:"Ê≠£Âú®Ëß£Áªë...",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"}),e.prev=6,"PROCESS_STEP"!==t.nodeType){e.next=25;break}return e.next=10,Object(x.d)({mainBarcode:this.dataForm.barcode,processStepId:t.processStepId,userId:this.$store.state.user.id,reason:r||"Êú™Â°´ÂÜôËß£ÁªëÂéüÂõ†",unbindSubsequent:!0});case 10:if(200!==(o=e.sent).code||!o.success){e.next=22;break}return this.$message.success("Ëß£ÁªëÊàêÂäü"),o.data&&(this.dataForm=JSON.parse(JSON.stringify(o.data)),this.dataForm.processNodes&&(this.processedFlowChartData=this.processNodes(this.dataForm.processNodes))),e.next=16,this.getUnbindRecords();case 16:this.activeTab="unbind",i=this.tableList.findIndex((function(e){return e._id===c.dataForm._id})),-1!==i&&this.$set(this.tableList,i,JSON.parse(JSON.stringify(o.data))),this.$nextTick((function(){c.$forceUpdate()})),e.next=23;break;case 22:throw new Error(o.message||"Ëß£ÁªëÂ§±Ë¥•");case 23:e.next=26;break;case 25:throw new Error("Âè™ËÉΩÂØπÂ∑•Â∫èËäÇÁÇπËøõË°åËß£ÁªëÊìç‰Ωú");case 26:e.next=31;break;case 28:e.prev=28,e.t0=e.catch(6),this.$message.error(e.t0.message||"Ëß£ÁªëÂ§±Ë¥•");case 31:return e.prev=31,s.close(),e.finish(31);case 34:e.next=39;break;case 36:e.prev=36,e.t1=e.catch(0),"cancel"!==e.t1&&this.$message.error(e.t1.message||"Ëß£ÁªëÂ§±Ë¥•");case 39:case"end":return e.stop()}}),e,this,[[0,36],[6,28,31,34]])})));return function(t){return e.apply(this,arguments)}}(),getUnbindRecords:function(){var e=Object(o.a)(Object(n.a)().mark((function e(){var t;return Object(n.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(c.b)("unbindRecord",{query:{flowRecordId:this.dataForm._id},populate:JSON.stringify([{path:"operatorId"}]),sort:{createTime:-1}});case 3:200===(t=e.sent).code&&(this.unbindRecord=t.data),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.error("Ëé∑ÂèñËß£ÁªëËÆ∞ÂΩïÂ§±Ë¥•:",e.t0);case 10:case"end":return e.stop()}}),e,this,[[0,7]])})));return function(){return e.apply(this,arguments)}}(),getProcessStatusType:function(e){return{PENDING:"info",IN_PROCESS:"warning",COMPLETED:"success",ABNORMAL:"danger"}[e]||"info"},getProcessStatusText:function(e){return{PENDING:"ÂæÖÂ§ÑÁêÜ",IN_PROCESS:"ËøõË°å‰∏≠",COMPLETED:"Â∑≤ÂÆåÊàê",ABNORMAL:"ÂºÇÂ∏∏"}[e]||e},fetchData:function(){var e=Object(o.a)(Object(n.a)().mark((function e(){var t,a;return Object(n.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.listLoading=!0,e.prev=1,(t=this.searchData()).page=this.currentPage,t.skip=(this.currentPage-1)*this.pageSize,t.limit=this.pageSize,t.sort={createAt:-1},t.count=!0,e.next=10,Object(c.b)("material_process_flow",t);case 10:200===(a=e.sent).code?(this.tableList=a.data,this.total=a.countnum||a.data.length):this.$message.error(a.msg||"Ëé∑ÂèñÊï∞ÊçÆÂ§±Ë¥•"),e.next=18;break;case 14:e.prev=14,e.t0=e.catch(1),console.error("Ëé∑ÂèñÊï∞ÊçÆÂ§±Ë¥•:",e.t0),this.$message.error("Ëé∑ÂèñÊï∞ÊçÆÂ§±Ë¥•: "+e.t0.message);case 18:return e.prev=18,this.listLoading=!1,e.finish(18);case 21:case"end":return e.stop()}}),e,this,[[1,14,18,21]])})));return function(){return e.apply(this,arguments)}}(),baseTableHandleCurrentChange:function(e){this.currentPage=e,this.fetchData()},baseTableHandleSizeChange:function(e){this.pageSize=e,this.fetchData()},toggleAdvanced:function(){this.showAdvanced=!this.showAdvanced},formatDate:function(e){return e?new Date(e).toLocaleString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"}):"ÊöÇÊó†Êï∞ÊçÆ"},formatNumber:function(e){return e||0===e?"¬•"+Number(e).toFixed(2).replace(/\B(?=(\d{3})+(?!\d))/g,","):"¬•0.00"},search:function(){this.currentPage=1,this.fetchData()},handleSelectionChange:function(e){this.selection=e},handleInit:function(){var e=Object(o.a)(Object(n.a)().mark((function e(t){var a;return Object(n.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,console.log(t,"row"),e.next=4,this.$confirm("Á°ÆËÆ§Ë¶ÅÊàêÂìÅÂàùÂßãÂåñÂêó?ËØ•Êìç‰ΩúÊó†Ê≥ïÊí§ÂõûÔºÅËØ∑Ë∞®ÊÖéÊìç‰ΩúÔºÅ","ÊèêÁ§∫",{confirmButtonText:"Á°ÆÂÆö",cancelButtonText:"ÂèñÊ∂à",type:"warning"});case 4:if(t._id){e.next=7;break}return this.$message.error("ËØ∑ÈÄâÊã©Ë¶ÅÂàùÂßãÂåñÁöÑËÆ∞ÂΩï"),e.abrupt("return");case 7:return e.next=9,Object(c.c)("material_process_flow",{query:{_id:t._id}});case 9:if(200!==(a=e.sent).code){e.next=15;break}this.$message.success("ÂàùÂßãÂåñÊàêÂäü"),this.fetchData(),e.next=16;break;case 15:throw new Error(a.msg||"ÂàùÂßãÂåñÂ§±Ë¥•");case 16:e.next=21;break;case 18:e.prev=18,e.t0=e.catch(0),"cancel"!==e.t0&&(console.error("Âà†Èô§Â§±Ë¥•:",e.t0),this.$message.error(e.t0.message||"Âà†Èô§Â§±Ë¥•"));case 21:case"end":return e.stop()}}),e,this,[[0,18]])})));return function(t){return e.apply(this,arguments)}}(),handleUpdateFlowNodes:function(){var e=Object(o.a)(Object(n.a)().mark((function e(t){var a;return Object(n.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.$confirm("Á°ÆËÆ§Ë¶ÅÊõ¥Êñ∞ÊµÅÁ®ãËäÇÁÇπÂêó?","ÊèêÁ§∫",{confirmButtonText:"Á°ÆÂÆö",cancelButtonText:"ÂèñÊ∂à",type:"warning"});case 3:return e.next=5,Object(x.e)({barcode:t.barcode});case 5:a=e.sent,console.log(a,"result"),200===a.code&&a.success?(this.$message.success("Êõ¥Êñ∞ÊàêÂäü"),this.fetchData()):this.$message.error("Êõ¥Êñ∞Â§±Ë¥•"),e.next=14;break;case 10:e.prev=10,e.t0=e.catch(0),console.error("Êõ¥Êñ∞Â§±Ë¥•:",e.t0),this.$message.error("Êõ¥Êñ∞Â§±Ë¥•: "+e.t0.message);case 14:case"end":return e.stop()}}),e,this,[[0,10]])})));return function(t){return e.apply(this,arguments)}}(),handleView:function(){var e=Object(o.a)(Object(n.a)().mark((function e(t){var a,r;return Object(n.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,this.listLoading=!0,e.next=4,Object(c.b)("material_process_flow",{query:{_id:t._id}});case 4:if(a=e.sent,console.log(a,"result"),!(200===a.code&&a.data.length>0)){e.next=17;break}return this.dataForm=a.data[0],this.processedFlowChartData=this.processNodes(this.dataForm.processNodes),this.dialogFormVisible=!0,e.next=12,Object(c.b)("unbindRecord",{query:{flowRecordId:t._id},populate:JSON.stringify([{path:"operatorId"}])});case 12:r=e.sent,console.log(r,"unbindRecord"),this.unbindRecord=r.data,e.next=18;break;case 17:this.$message.error("Ëé∑ÂèñËØ¶ÊÉÖÂ§±Ë¥•");case 18:e.next=24;break;case 20:e.prev=20,e.t0=e.catch(0),console.error("Ëé∑ÂèñËØ¶ÊÉÖÂ§±Ë¥•:",e.t0),this.$message.error("Ëé∑ÂèñËØ¶ÊÉÖÂ§±Ë¥•: "+e.t0.message);case 24:return e.prev=24,this.listLoading=!1,e.finish(24);case 27:case"end":return e.stop()}}),e,this,[[0,20,24,27]])})));return function(t){return e.apply(this,arguments)}}(),handleDelete:function(){var e=Object(o.a)(Object(n.a)().mark((function e(t){return Object(n.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.$confirm("Á°ÆËÆ§Ë¶ÅÂà†Èô§ËØ•ËÆ¢ÂçïÂêóÔºüÂà†Èô§Âêé‰∏çÂèØÊÅ¢Â§çÔºÅ","Ë≠¶Âëä",{type:"warning",confirmButtonText:"Á°ÆÂÆöÂà†Èô§",confirmButtonClass:"el-button--danger"});case 3:return e.next=5,Object(c.c)("k3_SAL_SaleOrder",{query:{_id:t._id}});case 5:this.$message.success("Âà†Èô§ÊàêÂäü"),this.fetchData(),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),"cancel"===e.t0?this.$message.info("Â∑≤ÂèñÊ∂àÂà†Èô§"):(console.error("Âà†Èô§Â§±Ë¥•:",e.t0),this.$message.error("Âà†Èô§Â§±Ë¥•"));case 12:case"end":return e.stop()}}),e,this,[[0,9]])})));return function(t){return e.apply(this,arguments)}}(),handleSubmit:function(){var e=Object(o.a)(Object(n.a)().mark((function e(t){return Object(n.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,"edit"!==this.dialogStatus){e.next=7;break}return e.next=4,Object(c.d)("k3_SAL_SaleOrder",t._id,t);case 4:this.$message.success("Êõ¥Êñ∞ÊàêÂäü"),e.next=10;break;case 7:return e.next=9,Object(c.a)("k3_SAL_SaleOrder",t);case 9:this.$message.success("Ê∑ªÂä†ÊàêÂäü");case 10:this.dialogFormVisible=!1,this.fetchData(),e.next=18;break;case 14:e.prev=14,e.t0=e.catch(0),console.error("Êìç‰ΩúÂ§±Ë¥•:",e.t0),this.$message.error("Êìç‰ΩúÂ§±Ë¥•");case 18:case"end":return e.stop()}}),e,this,[[0,14]])})));return function(t){return e.apply(this,arguments)}}(),searchData:function(){var e={query:{$and:[]}};return Object.entries(this.searchForm).forEach((function(t){var a=Object(s.a)(t,2),n=a[0],o=a[1];if(o)switch(n){case"barcode":case"materialCode":if(o.trim()){var i=o.trim().replace(/[.*+?^${}()|[\]\\]/g,"\\$&");e.query.$and.push(Object(r.a)({},n,{$regex:i,$options:"i"}))}break;case"status":e.query.$and.push(Object(r.a)({},n,o));break;case"progress":""!==o&&e.query.$and.push({progress:o});break;case"dateRange":Array.isArray(o)&&2===o.length&&e.query.$and.push({startTime:{$gte:o[0]+" 00:00:00",$lte:o[1]+" 23:59:59"}})}})),e.query.$and.length||delete e.query.$and,e},resetForm:function(){this.$refs.searchForm.resetFields(),this.searchForm={barcode:"",materialCode:"",status:"",dateRange:[],progress:""},this.currentPage=1,this.fetchData()},handleEdit:function(e){var t=this;this.dialogStatus="edit",this.dialogFormVisible=!0,this.$nextTick((function(){t.$refs.dataForm.resetFields(),t.dataForm=Object.assign({},e)}))}},Object(r.a)(Object(r.a)(Object(r.a)(Object(r.a)(Object(r.a)(Object(r.a)(Object(r.a)(Object(r.a)(Object(r.a)(Object(r.a)(g,"handleDelete",function(){var e=Object(o.a)(Object(n.a)().mark((function e(t){return Object(n.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.$confirm("Á°ÆËÆ§Ë¶ÅÂà†Èô§ËØ•ËÆ¢ÂçïÂêóÔºü","Ë≠¶Âëä",{confirmButtonText:"Á°ÆÂÆö",cancelButtonText:"ÂèñÊ∂à",type:"warning"});case 3:return e.next=5,Object(c.c)("k3_SAL_SaleOrder",{query:{_id:t._id}});case 5:this.$message.success("Âà†Èô§ÊàêÂäü"),this.fetchData(),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),"cancel"!==e.t0&&(console.error("Âà†Èô§Â§±Ë¥•:",e.t0),this.$message.error("Âà†Èô§Â§±Ë¥•: "+e.t0.message));case 12:case"end":return e.stop()}}),e,this,[[0,9]])})));return function(t){return e.apply(this,arguments)}}()),"handleSubmitAudit",function(){var e=Object(o.a)(Object(n.a)().mark((function e(t){var a;return Object(n.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.$confirm("Á°ÆËÆ§Êèê‰∫§Ê≠§ËÆ¢ÂçïËøõË°åÂÆ°Ê†∏Ôºü","ÊèêÁ§∫",{confirmButtonText:"Á°ÆÂÆö",cancelButtonText:"ÂèñÊ∂à",type:"warning"});case 3:return a=Object(i.a)(Object(i.a)({},t),{},{FDocumentStatus:"B",FModifyDate:new Date,FModifierId:this.$store.state.user.name}),e.next=6,Object(c.d)("k3_SAL_SaleOrder",t._id,a);case 6:this.$message.success("Êèê‰∫§ÂÆ°Ê†∏ÊàêÂäü"),this.fetchData(),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),"cancel"!==e.t0&&(console.error("Êèê‰∫§ÂÆ°Ê†∏Â§±Ë¥•:",e.t0),this.$message.error("Êèê‰∫§ÂÆ°Ê†∏Â§±Ë¥•: "+e.t0.message));case 13:case"end":return e.stop()}}),e,this,[[0,10]])})));return function(t){return e.apply(this,arguments)}}()),"submitForm",(function(){var e=this;this.$refs.dataForm.validate(function(){var t=Object(o.a)(Object(n.a)().mark((function t(a){return Object(n.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!a){t.next=19;break}if(t.prev=1,"create"!==e.dialogStatus){t.next=8;break}return t.next=5,Object(c.a)("k3_SAL_SaleOrder",e.dataForm);case 5:e.$message.success("ÂàõÂª∫ÊàêÂäü"),t.next=11;break;case 8:return t.next=10,Object(c.d)("k3_SAL_SaleOrder",e.dataForm._id,e.dataForm);case 10:e.$message.success("Êõ¥Êñ∞ÊàêÂäü");case 11:e.dialogFormVisible=!1,e.fetchData(),t.next=19;break;case 15:t.prev=15,t.t0=t.catch(1),console.error("Êìç‰ΩúÂ§±Ë¥•:",t.t0),e.$message.error("Êìç‰ΩúÂ§±Ë¥•: "+t.t0.message);case 19:case"end":return t.stop()}}),t,null,[[1,15]])})));return function(e){return t.apply(this,arguments)}}())})),"getNodeIcon",(function(e){return{PROCESS_STEP:{icon:"el-icon-s-operation",color:"#409EFF"},MATERIAL:{icon:"el-icon-box",color:"#67c23a"}}[e.nodeType]||{icon:"el-icon-more",color:"#909399"}})),"getTimelineItemType",(function(e){return{COMPLETED:"success",IN_PROCESS:"primary",ABNORMAL:"danger",PENDING:"info"}[e]||"info"})),"getScanIcon",(function(e){if(!e.requireScan)return"el-icon-minus info";return{COMPLETED:"el-icon-check success",IN_PROCESS:"el-icon-loading warning",ABNORMAL:"el-icon-close danger",PENDING:"el-icon-time info"}[e.status]||"el-icon-time info"})),"getScanStatus",(function(e){if(!e.requireScan)return"Êó†ÈúÄÊâ´Á†Å";return{COMPLETED:"Â∑≤ÂÆåÊàêÊâ´Á†Å",IN_PROCESS:"Á≠âÂæÖÊâ´Á†Å",ABNORMAL:"Êâ´Á†ÅÂºÇÂ∏∏",PENDING:"Êú™ÂºÄÂßã"}[e.status]||"Êú™ÂºÄÂßã"})),"getActiveStep",(function(e){var t=e.findIndex((function(e){return"IN_PROCESS"===e.status}));return-1===t?e.filter((function(e){return"COMPLETED"===e.status})).length:t+1})),"getStepStatus",(function(e){return{COMPLETED:"success",IN_PROCESS:"process",ABNORMAL:"error",PENDING:"wait"}[e]||"wait"})),"getStepIcon",(function(e){return"PROCESS_STEP"===e.nodeType?"el-icon-s-operation":"el-icon-box"})),Object(r.a)(Object(r.a)(Object(r.a)(Object(r.a)(Object(r.a)(Object(r.a)(Object(r.a)(Object(r.a)(Object(r.a)(Object(r.a)(g,"getProcessOverallStatus",(function(e){return e.some((function(e){return"ABNORMAL"===e.status}))?"error":e.some((function(e){return"IN_PROCESS"===e.status}))?"process":e.every((function(e){return"COMPLETED"===e.status}))?"success":"wait"})),"getProcessSteps",(function(){return this.dataForm.processNodes.filter((function(e){return"PROCESS_STEP"===e.nodeType&&1===e.level})).sort((function(e,t){return e.processSort-t.processSort}))})),"getRelatedMaterials",(function(e){return this.dataForm.processNodes.filter((function(t){return"MATERIAL"===t.nodeType&&t.parentNodeId===e&&2===t.level}))})),"hasRequireScanMaterials",(function(e){return this.getRelatedMaterials(e).some((function(e){return e.requireScan}))})),"processNodes",(function(e){if(!e||!e.length)return[];var t=new Map;e.forEach((function(e){t.set(e.nodeId,Object(i.a)(Object(i.a)({},e),{},{children:[]}))}));var a=[];e.forEach((function(e){var r=t.get(e.nodeId);e.parentNodeId&&t.has(e.parentNodeId)?t.get(e.parentNodeId).children.push(r):a.push(r)}));var r=function(e){e.children&&e.children.length&&("PROCESS_STEP"===e.nodeType?e.children.sort((function(e,t){return(e.materialCode||"").localeCompare(t.materialCode||"")})):"MATERIAL"===e.nodeType&&e.children.sort((function(e,t){return(e.processSort||0)-(t.processSort||0)})),e.children.forEach((function(e){return r(e)})))};return a.forEach((function(e){return r(e)})),a})),"openBarcodeSearch",(function(){this.barcodeSearchVisible=!0,this.searchBarcode="",this.searchResults=[]})),"handleBarcodeSearch",function(){var e=Object(o.a)(Object(n.a)().mark((function e(){var t,a,r,s,o=this;return Object(n.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.searchBarcode.trim()){e.next=3;break}return this.$message.warning("ËØ∑ËæìÂÖ•Ë¶ÅÊêúÁ¥¢ÁöÑÊù°Á†Å"),e.abrupt("return");case 3:return this.searchLoading=!0,e.prev=4,t={query:{"processNodes.barcode":this.searchBarcode}},e.next=8,Object(c.b)("material_process_flow",t);case 8:if(!(200===(a=e.sent).code&&a.data&&a.data.length>0)){e.next=13;break}return this.searchResults=[],a.data.forEach((function(e){o.searchResults.push(Object(i.a)({isMainBarcode:!0,barcode:e.barcode,materialCode:e.materialCode,materialName:e.materialName,materialSpec:e.materialSpec,status:e.status},e))})),e.abrupt("return");case 13:return r={query:{barcode:this.searchBarcode}},e.next=16,Object(c.b)("material_process_flow",r);case 16:if(!(200===(s=e.sent).code&&s.data&&s.data.length>0)){e.next=21;break}return this.searchResults=[],s.data.forEach((function(e){o.searchResults.push(Object(i.a)({isMainBarcode:!1,barcode:e.barcode,materialCode:e.materialCode,materialName:e.materialName,materialSpec:e.materialSpec,status:e.status},e))})),e.abrupt("return");case 21:this.$message.warning("Êú™ÊâæÂà∞Áõ∏ÂÖ≥Êï∞ÊçÆ"),e.next=28;break;case 24:e.prev=24,e.t0=e.catch(4),console.error("ÊêúÁ¥¢Â§±Ë¥•:",e.t0),this.$message.error("ÊêúÁ¥¢Â§±Ë¥•: "+e.t0.message);case 28:return e.prev=28,this.searchBarcode="",this.searchLoading=!1,e.finish(28);case 32:case"end":return e.stop()}}),e,this,[[4,24,28,32]])})));return function(){return e.apply(this,arguments)}}()),"handleProcessedMaterialBarcodeData",(function(e){if(!e.processNodes)return[];var t=new Map;return e.processNodes.forEach((function(e){"PROCESS_STEP"===e.nodeType&&t.set(e.nodeId,{processName:e.processName,processCode:e.processCode})})),e.processNodes.filter((function(e){return"MATERIAL"===e.nodeType&&e.barcode})).map((function(e){var a=e.parentNodeId?t.get(e.parentNodeId):null;return Object(i.a)(Object(i.a)({},e),{},{processName:a?a.processName:"-",processCode:a?a.processCode:""})})).sort((function(e,t){return new Date(t.scanTime||0)-new Date(e.scanTime||0)}))})),"handleAllExport",(function(){this.exportDialogVisible=!0,this.exportForm.exportOption="current"})),"confirmExport",function(){var e=Object(o.a)(Object(n.a)().mark((function e(){var t,a,r,s,o,i,l,d,u,v,_,h,p,f,m,b,g,w,C,y,S,x=this;return Object(n.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("all"!==(t=this.exportForm.exportOption)){e.next=12;break}return e.prev=2,e.next=5,this.$confirm("Á°ÆËÆ§ÂØºÂá∫ÂÖ®ÈÉ®Êï∞ÊçÆÂêó?Êï∞ÊçÆÈáèËæÉÂ§ßÂèØËÉΩÈúÄË¶ÅËæÉÈïøÊó∂Èó¥","‰∫åÊ¨°Á°ÆËÆ§",{type:"warning"});case 5:e.next=12;break;case 7:if(e.prev=7,e.t0=e.catch(2),"cancel"!==e.t0){e.next=12;break}return this.$message.info("Â∑≤ÂèñÊ∂àÂØºÂá∫"),e.abrupt("return");case 12:this.exportLoading=!0,e.prev=13,a=[],e.t1=t,e.next="all"===e.t1?18:"search"===e.t1?27:42;break;case 18:return e.next=20,Object(c.b)("material_process_flow",{query:{}});case 20:if(200!==(r=e.sent).code){e.next=25;break}a=r.data,e.next=26;break;case 25:throw new Error(r.msg||"Ëé∑ÂèñÊï∞ÊçÆÂ§±Ë¥•");case 26:return e.abrupt("break",42);case 27:return(s=this.searchData()).page=this.currentPage,s.skip=(this.currentPage-1)*this.pageSize,s.limit=this.pageSize,s.sort={createAt:-1},s.count=!0,e.next=35,Object(c.b)("material_process_flow",s);case 35:if(200!==(o=e.sent).code){e.next=40;break}a=o.data,e.next=41;break;case 40:throw new Error(o.msg||"Ëé∑ÂèñÊï∞ÊçÆÂ§±Ë¥•");case 41:return e.abrupt("break",42);case 42:if(console.log(a),0!==a.length){e.next=46;break}return this.$message.warning("Ê≤°ÊúâÂèØÂØºÂá∫ÁöÑÊï∞ÊçÆ"),e.abrupt("return");case 46:i=this.$loading({lock:!0,text:"Ê≠£Âú®Â§ÑÁêÜÁ¨¨ 0/".concat(a.length," Êù°Êï∞ÊçÆ..."),spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"}),l=new T.a,d=0;case 49:if(!(d<a.length)){e.next=88;break}return i.text="Ê≠£Âú®Â§ÑÁêÜÁ¨¨ ".concat(d+1,"/").concat(a.length," Êù°Êï∞ÊçÆ..."),u=a[d],e.prev=52,e.next=55,Object(c.b)("material_process_flow",{query:{_id:u._id}});case 55:if(!(200===(v=e.sent).code&&v.data.length>0)){e.next=79;break}if(_=v.data[0],0!==(h=this.handleProcessedMaterialBarcodeData(_)).length){e.next=61;break}return e.abrupt("continue",85);case 61:p=h.map((function(e){return{"Êù°Á†Å":e.barcode||"-","Áâ©ÊñôÁºñÁ†Å":e.materialCode||"-","Áâ©ÊñôÂêçÁß∞":e.materialName||"-","ËßÑÊ†ºÂûãÂè∑":e.materialSpec||"-","Áä∂ÊÄÅ":x.getProcessStatusText(e.status)||"-","ÊâÄÂ±ûÂ∑•Â∫è":"".concat(e.processName||""," ").concat(e.processCode?"(".concat(e.processCode,")"):""),"Êâ´Á†ÅÊó∂Èó¥":e.scanTime?x.formatDate(e.scanTime):"-"}})),f=O.a.utils.book_new(),(m=O.a.utils.json_to_sheet(p))["!cols"]=[{wch:20},{wch:15},{wch:20},{wch:15},{wch:10},{wch:20},{wch:20}],b=O.a.utils.decode_range(m["!ref"]),g=b.s.c;case 67:if(!(g<=b.e.c)){e.next=75;break}if(w=O.a.utils.encode_cell({r:0,c:g}),m[w]){e.next=71;break}return e.abrupt("continue",72);case 71:m[w].s={font:{bold:!0},alignment:{horizontal:"center"},fill:{fgColor:{rgb:"f5f7fa"}}};case 72:++g,e.next=67;break;case 75:O.a.utils.book_append_sheet(f,m,"Áâ©ÊñôÊù°Á†Å‰ø°ÊÅØ"),C=O.a.write(f,{bookType:"xlsx",type:"array"}),y="".concat(u.materialCode,"_").concat(u.materialName,"_").concat(u.barcode,".xlsx"),l.file(y,C);case 79:e.next=85;break;case 81:return e.prev=81,e.t2=e.catch(52),console.error("Â§ÑÁêÜÊï∞ÊçÆÂ§±Ë¥•:",e.t2),e.abrupt("continue",85);case 85:d++,e.next=49;break;case 88:return e.next=90,l.generateAsync({type:"blob"});case 90:S=e.sent,j.a.saveAs(S,"Áâ©ÊñôÊù°Á†Å‰ø°ÊÅØ_".concat((new Date).toLocaleDateString(),".zip")),this.$message.success("ÂØºÂá∫ÊàêÂäü"),this.exportDialogVisible=!1,i.close(),e.next=101;break;case 97:e.prev=97,e.t3=e.catch(13),console.error("ÂØºÂá∫Â§±Ë¥•:",e.t3),this.$message.error("ÂØºÂá∫Â§±Ë¥•: "+e.t3.message);case 101:return e.prev=101,this.exportLoading=!1,e.finish(101);case 104:case"end":return e.stop()}}),e,this,[[2,7],[13,97,101,104],[52,81]])})));return function(){return e.apply(this,arguments)}}()),Object(r.a)(Object(r.a)(g,"processMaterialBarcodeData",(function(e){return e?e.filter((function(e){return"MATERIAL"===e.nodeType&&e.barcode})).map((function(e){return{barcode:e.barcode,materialCode:e.materialCode,materialName:e.materialName,materialSpec:e.materialSpec,status:e.status,processName:e.processName,processCode:e.processCode,scanTime:e.scanTime}})).sort((function(e,t){return new Date(t.scanTime||0)-new Date(e.scanTime||0)})):[]})),"handleSingleMainExport",function(){var e=Object(o.a)(Object(n.a)().mark((function e(t){var a,r,s,o,i,l,d,u,v,_,h,p,f,m,b,g=this;return Object(n.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a=this.$loading({lock:!0,text:"Ê≠£Âú®Ëé∑ÂèñÊï∞ÊçÆÔºåËØ∑Á®çÂÄô...",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"}),e.prev=2,e.next=5,Object(c.b)("material_process_flow",{query:{_id:t._id}});case 5:if(!(200===(r=e.sent).code&&r.data.length>0)){e.next=37;break}if(s=r.data[0],0!==(o=this.handleProcessedMaterialBarcodeData(s)).length){e.next=13;break}return this.$message.warning("ËØ•ËÆ∞ÂΩïÊ≤°ÊúâÂèØÂØºÂá∫ÁöÑÊù°Á†ÅÊï∞ÊçÆ"),a.close(),e.abrupt("return");case 13:i=o.map((function(e){return{"Êù°Á†Å":e.barcode||"-","Áâ©ÊñôÁºñÁ†Å":e.materialCode||"-","Áâ©ÊñôÂêçÁß∞":e.materialName||"-","ËßÑÊ†ºÂûãÂè∑":e.materialSpec||"-","Áä∂ÊÄÅ":g.getProcessStatusText(e.status)||"-","ÊâÄÂ±ûÂ∑•Â∫è":"".concat(e.processName||""," ").concat(e.processCode?"(".concat(e.processCode,")"):""),"Êâ´Á†ÅÊó∂Èó¥":e.scanTime?g.formatDate(e.scanTime):"-"}})),l=O.a.utils.book_new(),d=O.a.utils.json_to_sheet(i),u=[{wch:20},{wch:15},{wch:20},{wch:15},{wch:10},{wch:20},{wch:20}],d["!cols"]=u,v={font:{bold:!0},alignment:{horizontal:"center"},fill:{fgColor:{rgb:"f5f7fa"}}},_=O.a.utils.decode_range(d["!ref"]),h=_.s.c;case 21:if(!(h<=_.e.c)){e.next=29;break}if(p=O.a.utils.encode_cell({r:0,c:h}),d[p]){e.next=25;break}return e.abrupt("continue",26);case 25:d[p].s=v;case 26:++h,e.next=21;break;case 29:O.a.utils.book_append_sheet(l,d,"Áâ©ÊñôÊù°Á†Å‰ø°ÊÅØ"),f=O.a.write(l,{bookType:"xlsx",type:"array"}),m=new Blob([f],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),b="".concat(t.materialCode,"_").concat(t.materialName,"_").concat(t.barcode,".xlsx"),j.a.saveAs(m,b),this.$message.success("ÂØºÂá∫ÊàêÂäü"),e.next=38;break;case 37:throw new Error("Ëé∑ÂèñÊï∞ÊçÆÂ§±Ë¥•");case 38:e.next=44;break;case 40:e.prev=40,e.t0=e.catch(2),console.error("ÂØºÂá∫Â§±Ë¥•:",e.t0),this.$message.error("ÂØºÂá∫Â§±Ë¥•: "+e.t0.message);case 44:return e.prev=44,a.close(),e.finish(44);case 47:e.next=53;break;case 49:e.prev=49,e.t1=e.catch(0),console.error("ÂØºÂá∫Â§±Ë¥•:",e.t1),this.$message.error("ÂØºÂá∫Â§±Ë¥•: "+e.t1.message);case 53:case"end":return e.stop()}}),e,this,[[0,49],[2,40,44,47]])})));return function(t){return e.apply(this,arguments)}}())),created:function(){this.fetchData()}},F=P,L=(a("74196"),Object(d.a)(F,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("el-card",{staticClass:"filter-container"},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",[e._v("Á≠õÈÄâÊêúÁ¥¢")]),e._v(" "),a("el-button",{staticStyle:{float:"right",padding:"3px 0"},attrs:{type:"text"},on:{click:e.toggleAdvanced}},[e._v("\n                "+e._s(e.showAdvanced?"Êî∂Ëµ∑":"Â±ïÂºÄ")+"È´òÁ∫ßÊêúÁ¥¢\n            ")])],1),e._v(" "),a("el-form",{ref:"searchForm",staticClass:"demo-form-inline",attrs:{model:e.searchForm}},[a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"‰∏ªÊù°Á†Å"}},[a("el-input",{attrs:{placeholder:"ËØ∑ËæìÂÖ•‰∏ªÊù°Á†Å",clearable:""},model:{value:e.searchForm.barcode,callback:function(t){e.$set(e.searchForm,"barcode",t)},expression:"searchForm.barcode"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"Áâ©ÊñôÁºñÁ†Å"}},[a("el-input",{attrs:{placeholder:"ËØ∑ËæìÂÖ•Áâ©ÊñôÁºñÁ†Å",clearable:""},model:{value:e.searchForm.materialCode,callback:function(t){e.$set(e.searchForm,"materialCode",t)},expression:"searchForm.materialCode"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"ÊµÅÁ®ãÁä∂ÊÄÅ"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"ËØ∑ÈÄâÊã©ÊµÅÁ®ãÁä∂ÊÄÅ",clearable:""},model:{value:e.searchForm.status,callback:function(t){e.$set(e.searchForm,"status",t)},expression:"searchForm.status"}},[a("el-option",{attrs:{label:"ÂæÖÂ§ÑÁêÜ",value:"PENDING"}}),e._v(" "),a("el-option",{attrs:{label:"ËøõË°å‰∏≠",value:"IN_PROCESS"}}),e._v(" "),a("el-option",{attrs:{label:"Â∑≤ÂÆåÊàê",value:"COMPLETED"}}),e._v(" "),a("el-option",{attrs:{label:"ÂºÇÂ∏∏",value:"ABNORMAL"}})],1)],1)],1)],1),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:e.showAdvanced,expression:"showAdvanced"}]},[a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"ÂºÄÂßãÊó∂Èó¥"}},[a("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"daterange","range-separator":"Ëá≥","start-placeholder":"ÂºÄÂßãÊó•Êúü","end-placeholder":"ÁªìÊùüÊó•Êúü","value-format":"yyyy-MM-dd"},model:{value:e.searchForm.dateRange,callback:function(t){e.$set(e.searchForm,"dateRange",t)},expression:"searchForm.dateRange"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"ÂÆåÊàêËøõÂ∫¶"}},[a("el-input-number",{attrs:{min:0,max:100,placeholder:"ÂÆåÊàêËøõÂ∫¶"},model:{value:e.searchForm.progress,callback:function(t){e.$set(e.searchForm,"progress",t)},expression:"searchForm.progress"}})],1)],1)],1)],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:e.search}},[e._v("Êü•ËØ¢ÊêúÁ¥¢")]),e._v(" "),a("el-button",{on:{click:e.resetForm}},[e._v("ÈáçÁΩÆ")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.openBarcodeSearch}},[e._v("ÊàêÂìÅËøΩÊ∫Ø")])],1)],1)],1),e._v(" "),a("div",{staticClass:"screen1"},[a("div",{staticClass:"screen_content"},[a("div",{staticClass:"screen_content_first"},[a("i",{staticClass:"el-icon-tickets"},[e._v("‰∏ªÊù°Á†ÅÁîü‰∫ßÊµÅÁ®ãÂàóË°®")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.handleAllExport}},[e._v("ÊâπÈáèÂØºÂá∫Êï∞ÊçÆ")])],1)])]),e._v(" "),a("base-table",{ref:"baseTable",attrs:{currentPage:e.currentPage,"highlight-current-row":!0,pageSize:e.pageSize,tableData:e.tableList,tableDataloading:e.listLoading,total:e.total,"cell-style":{textAlign:"center"}},on:{"selection-change":e.handleSelectionChange,handleCurrentChange:e.baseTableHandleCurrentChange,handleSizeChange:e.baseTableHandleSizeChange}},[a("template",{slot:"law"},[a("el-table-column",{attrs:{label:"‰∏ªÊù°Á†Å",prop:"barcode"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                    "+e._s(t.row.barcode)+"\n                ")]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"Áâ©Êñô‰ø°ÊÅØ"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[e._v("ÁºñÁ†ÅÔºö"+e._s(t.row.materialCode))]),e._v(" "),a("div",[e._v("ÂêçÁß∞Ôºö"+e._s(t.row.materialName))]),e._v(" "),a("div",[e._v("ËßÑÊ†ºÔºö"+e._s(t.row.materialSpec))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"ÊµÅÁ®ãÁä∂ÊÄÅ",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tag",{attrs:{type:e.getProcessStatusType(t.row.status)}},[e._v("\n                        "+e._s(e.getProcessStatusText(t.row.status))+"\n                    ")])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"ÂÆåÊàêËøõÂ∫¶",width:"200"},scopedSlots:e._u([{key:"default",fn:function(e){return[a("el-progress",{attrs:{percentage:e.row.progress||0}})]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"Êìç‰Ωú",fixed:"right",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){return e.handleView(t.row)}}},[e._v("Êü•Áúã")]),e._v(" "),a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){return e.handleUpdateFlowNodes(t.row)}}},[e._v("Êõ¥Êñ∞ÊµÅÁ®ãËäÇÁÇπ")]),e._v(" "),a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){return e.handleSingleMainExport(t.row)}}},[e._v("\n                        ÂØºÂá∫Êù°Á†ÅÊï∞ÊçÆ\n                    ")])]}}])})],1)],2),e._v(" "),a("el-dialog",{staticClass:"process-flow-dialog",attrs:{title:"Â∑•Ëâ∫ÊµÅÁ®ãËØ¶ÊÉÖ - "+e.dataForm.barcode,visible:e.dialogFormVisible,width:"80%","close-on-click-modal":!1},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[a("div",{staticClass:"process-flow-container"},[a("div",{staticClass:"process-section"},[a("el-card",{staticClass:"process-card"},[a("div",{attrs:{slot:"header"},slot:"header"},[a("span",[a("i",{staticClass:"el-icon-time"}),e._v(" Â∑•Ëâ∫ÊµÅÁ®ã")])]),e._v(" "),a("div",{staticClass:"process-flow"},[a("div",{staticClass:"main-material"},[a("div",{staticClass:"main-material-header"},[a("i",{staticClass:"el-icon-box"}),e._v(" "),a("span",{staticClass:"title"},[e._v("‰∏ª‰∫ßÂìÅ‰ø°ÊÅØ")]),e._v(" "),a("el-tag",{attrs:{type:"primary",size:"mini"}},[e._v(e._s(e.dataForm.materialCode))])],1),e._v(" "),a("div",{staticClass:"main-material-content"},[a("div",{staticClass:"info-row"},[a("div",{staticClass:"info-item"},[a("label",[e._v("‰∫ßÂìÅÊù°Á†ÅÔºö")]),e._v(" "),a("span",[e._v(e._s(e.dataForm.barcode))])])]),e._v(" "),a("div",{staticClass:"info-row"},[a("div",{staticClass:"info-item"},[a("label",[e._v("Áâ©ÊñôÂêçÁß∞Ôºö")]),e._v(" "),a("span",[e._v(e._s(e.dataForm.materialName))])]),e._v(" "),a("div",{staticClass:"info-item"},[a("label",[e._v("ËßÑÊ†ºÂûãÂè∑Ôºö")]),e._v(" "),a("span",[e._v(e._s(e.dataForm.materialSpec))])])]),e._v(" "),a("div",{staticClass:"info-row"},[a("div",{staticClass:"info-item"},[a("label",[e._v("Êï¥‰ΩìËøõÂ∫¶Ôºö")]),e._v(" "),a("el-progress",{attrs:{percentage:e.dataForm.progress||0}})],1),e._v(" "),a("div",{staticClass:"info-item"},[a("label",[e._v("ÂΩìÂâçÁä∂ÊÄÅÔºö")]),e._v(" "),a("el-tag",{attrs:{type:e.getProcessStatusType(e.dataForm.status)}},[e._v("\n                                            "+e._s(e.getProcessStatusText(e.dataForm.status))+"\n                                        ")])],1)])])]),e._v(" "),a("el-tabs",{attrs:{type:"border-card"},model:{value:e.activeTab,callback:function(t){e.activeTab=t},expression:"activeTab"}},[a("el-tab-pane",{attrs:{label:"Â∑•Â∫è‰ø°ÊÅØ",name:"process"}},[a("process-step-list",{ref:"processStepList",attrs:{loading:e.listLoading,"flow-data":e.processedFlowChartData}})],1),e._v(" "),a("el-tab-pane",{attrs:{label:"Áâ©Êñô‰ø°ÊÅØ",name:"material"}},[a("div",{staticClass:"material-info-container"},[a("div",{staticClass:"table-header"},[a("i",{staticClass:"el-icon-box"}),e._v(" "),a("span",[e._v("Â∑•Ëâ∫Áâ©ÊñôÊ∏ÖÂçï")])]),e._v(" "),a("el-table",{staticClass:"material-table",attrs:{data:e.processedFlowChartData[0]&&e.processedFlowChartData[0].children?e.processedFlowChartData[0].children.filter((function(e){return"PROCESS_STEP"===e.nodeType})):[],border:"","header-cell-style":{background:"#f5f7fa",color:"#606266",fontWeight:"bold",fontSize:"14px",textAlign:"center",height:"50px"},"cell-style":{textAlign:"center"}}},[a("el-table-column",{attrs:{label:"Â∑•Â∫è",width:"300"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticClass:"process-info"},[a("el-tag",{attrs:{size:"medium",type:e.getProcessStatusType(t.row.status)}},[e._v("\n                                                        "+e._s(t.row.processName)+"\n                                                        "),a("el-tag",{attrs:{size:"mini",type:"info"}},[e._v(e._s(t.row.processCode))])],1)],1)]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"ÂÖ≥ËÅîÁâ©Êñô"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.children&&t.row.children.length?a("el-table",{staticClass:"inner-table",attrs:{data:t.row.children.filter((function(e){return"MATERIAL"===e.nodeType})),border:""}},[a("el-table-column",{attrs:{label:"Áâ©ÊñôÁºñÁ†Å",prop:"materialCode","min-width":"120"}}),e._v(" "),a("el-table-column",{attrs:{label:"Áâ©ÊñôÂêçÁß∞",prop:"materialName","min-width":"150"}}),e._v(" "),a("el-table-column",{attrs:{label:"ËßÑÊ†ºÂûãÂè∑",prop:"materialSpec","min-width":"120"}}),e._v(" "),a("el-table-column",{attrs:{label:"Êï∞Èáè",width:"80"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                                                            "+e._s(t.row.materialQuantity)+" "+e._s(t.row.materialUnit)+"\n                                                        ")]}}],null,!0)}),e._v(" "),a("el-table-column",{attrs:{label:"Áä∂ÊÄÅ",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tag",{attrs:{type:e.getProcessStatusType(t.row.status),size:"small"}},[e._v("\n                                                                "+e._s(e.getProcessStatusText(t.row.status))+"\n                                                            ")])]}}],null,!0)}),e._v(" "),a("el-table-column",{attrs:{label:"Êù°Á†Å","min-width":"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.barcode?a("span",[e._v(e._s(t.row.barcode))]):a("span",{staticClass:"no-barcode"},[e._v("-")])]}}],null,!0)}),e._v(" "),a("el-table-column",{attrs:{label:"Á±ªÂûã",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.isComponent?a("el-tag",{attrs:{type:"warning",size:"mini"}},[e._v("ÁªÑ‰ª∂")]):e._e(),e._v(" "),t.row.isKeyMaterial?a("el-tag",{attrs:{type:"danger",size:"mini"}},[e._v("ÂÖ≥ÈîÆ")]):e._e(),e._v(" "),t.row.isComponent||t.row.isKeyMaterial?e._e():a("span",[e._v("-")])]}}],null,!0)})],1):a("div",{staticClass:"no-material"},[e._v("ÊöÇÊó†ÂÖ≥ËÅîÁâ©Êñô")])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"Êìç‰Ωú",width:"120",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){return e.handleUnbind(t.row)}}},[e._v("Ëß£Áªë")])]}}])})],1)],1)]),e._v(" "),a("el-tab-pane",{attrs:{label:"Áâ©ÊñôÊù°Á†Å‰ø°ÊÅØ",name:"materialBarcode"}},[a("el-table",{attrs:{data:e.processedMaterialBarcodeData,border:"","header-cell-style":{background:"#f5f7fa",color:"#606266",fontWeight:"bold",textAlign:"center"},"cell-style":{textAlign:"center"}}},[a("el-table-column",{attrs:{label:"Êù°Á†Å",prop:"barcode","min-width":"150"}}),e._v(" "),a("el-table-column",{attrs:{label:"Áâ©ÊñôÁºñÁ†Å",prop:"materialCode","min-width":"120"}}),e._v(" "),a("el-table-column",{attrs:{label:"Áâ©ÊñôÂêçÁß∞",prop:"materialName","min-width":"150"}}),e._v(" "),a("el-table-column",{attrs:{label:"ËßÑÊ†ºÂûãÂè∑",prop:"materialSpec","min-width":"120"}}),e._v(" "),a("el-table-column",{attrs:{label:"Áä∂ÊÄÅ",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tag",{attrs:{type:e.getProcessStatusType(t.row.status)}},[e._v("\n                                                "+e._s(e.getProcessStatusText(t.row.status))+"\n                                            ")])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"ÊâÄÂ±ûÂ∑•Â∫è","min-width":"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tag",{attrs:{size:"medium",type:"info"}},[e._v("\n                                                "+e._s(t.row.processName)+"\n                                                "),t.row.processCode?a("el-tag",{attrs:{size:"mini",type:"info"}},[e._v("\n                                                    "+e._s(t.row.processCode)+"\n                                                ")]):e._e()],1)]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"Êâ´Á†ÅÊó∂Èó¥",width:"160"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                                            "+e._s(e.formatDate(t.row.scanTime))+"\n                                        ")]}}])})],1)],1),e._v(" "),a("el-tab-pane",{attrs:{label:"Ê£ÄÊµã‰ø°ÊÅØ",name:"inspection"}},[a("inspection-list",{attrs:{inspections:e.dataForm}})],1),e._v(" "),a("el-tab-pane",{attrs:{label:"Ëß£Áªë‰ø°ÊÅØ",name:"unbind"}},[a("el-table",{attrs:{data:e.unbindRecord||[],border:"","header-cell-style":{background:"#f5f7fa",color:"#606266",fontWeight:"bold",textAlign:"center"},"cell-style":{textAlign:"center"}}},[a("el-table-column",{attrs:{label:"Ëß£ÁªëÊó∂Èó¥",width:"160"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                                            "+e._s(e.formatDate(t.row.operateTime))+"\n                                        ")]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"Â∑•Â∫è‰ø°ÊÅØ","min-width":"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tag",{attrs:{size:"medium",type:"info"}},[e._v("\n                                                "+e._s(t.row.processName)+"\n                                                "),t.row.processCode?a("el-tag",{attrs:{size:"mini",type:"info"}},[e._v("\n                                                    "+e._s(t.row.processCode)+"\n                                                ")]):e._e()],1)]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"Ëß£ÁªëÁâ©Êñô","min-width":"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.unbindMaterials&&t.row.unbindMaterials.length?a("el-table",{staticClass:"inner-table",attrs:{data:t.row.unbindMaterials,border:"",size:"mini"}},[a("el-table-column",{attrs:{label:"Áâ©ÊñôÁºñÁ†Å",prop:"materialCode","min-width":"120"}}),e._v(" "),a("el-table-column",{attrs:{label:"Áâ©ÊñôÂêçÁß∞",prop:"materialName","min-width":"150"}}),e._v(" "),a("el-table-column",{attrs:{label:"ÂéüÊù°Á†Å",prop:"originalBarcode","min-width":"150"}})],1):a("span",[e._v("-")])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"Ëß£ÁªëÂéüÂõ†","min-width":"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.reason?a("el-tooltip",{attrs:{content:t.row.reason,placement:"top"}},[a("span",[e._v(e._s(t.row.reason))])]):a("span",[e._v("-")])]}}])})],1)],1)],1)],1)])],1)])]),e._v(" "),a("el-dialog",{attrs:{title:"Êù°Á†ÅÊü•ËØ¢",visible:e.barcodeSearchVisible,width:"70%","close-on-click-modal":!1},on:{"update:visible":function(t){e.barcodeSearchVisible=t}}},[a("div",{staticClass:"barcode-search-container"},[a("div",{staticClass:"search-area"},[a("el-input",{attrs:{placeholder:"ËØ∑ËæìÂÖ•Êù°Á†Å",clearable:""},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleBarcodeSearch(t)}},model:{value:e.searchBarcode,callback:function(t){e.searchBarcode=t},expression:"searchBarcode"}},[a("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:e.handleBarcodeSearch},slot:"append"},[e._v("\n                        ÊêúÁ¥¢\n                    ")])],1)],1),e._v(" "),a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.searchLoading,expression:"searchLoading"}],staticClass:"search-result"},[e.searchResults.length?a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.searchResults,border:"","header-cell-style":{background:"#f5f7fa",color:"#606266",fontWeight:"bold",textAlign:"center"},"cell-style":{textAlign:"center"}}},[a("el-table-column",{attrs:{label:"Êù°Á†ÅÁ±ªÂûã",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tag",{attrs:{type:t.row.isMainBarcode?"primary":"success"}},[e._v("\n                                "+e._s(t.row.isMainBarcode?"‰∏ªÊù°Á†Å":"Â≠êÊù°Á†Å")+"\n                            ")])]}}],null,!1,1158433612)}),e._v(" "),a("el-table-column",{attrs:{label:"Êù°Á†Å",prop:"barcode","min-width":"150"}}),e._v(" "),a("el-table-column",{attrs:{label:"Áâ©Êñô‰ø°ÊÅØ","min-width":"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[e._v("ÁºñÁ†ÅÔºö"+e._s(t.row.materialCode))]),e._v(" "),a("div",[e._v("ÂêçÁß∞Ôºö"+e._s(t.row.materialName))]),e._v(" "),a("div",[e._v("ËßÑÊ†ºÔºö"+e._s(t.row.materialSpec))])]}}],null,!1,2839144854)}),e._v(" "),a("el-table-column",{attrs:{label:"Áä∂ÊÄÅ",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tag",{attrs:{type:e.getProcessStatusType(t.row.status)}},[e._v("\n                                "+e._s(e.getProcessStatusText(t.row.status))+"\n                            ")])]}}],null,!1,363000109)}),e._v(" "),a("el-table-column",{attrs:{label:"ÂÆåÊàêËøõÂ∫¶",width:"200"},scopedSlots:e._u([{key:"default",fn:function(e){return[a("el-progress",{attrs:{percentage:e.row.progress||0}})]}}],null,!1,3194896933)}),e._v(" "),a("el-table-column",{attrs:{label:"Êìç‰Ωú",width:"120",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text"},on:{click:function(a){return e.handleView(t.row.isMainBarcode?t.row:t.row.mainBarcodeData)}}},[e._v("\n                                Êü•ÁúãËØ¶ÊÉÖ\n                            ")]),e._v(" "),a("el-button",{staticStyle:{color:"red"},attrs:{type:"text"},on:{click:function(a){return e.handleInit(t.row)}}},[e._v("ÊàêÂìÅÂàùÂßãÂåñ")])]}}],null,!1,390256671)})],1):e.searchLoading?e._e():a("div",{staticClass:"no-result"},[a("i",{staticClass:"el-icon-warning-outline"}),e._v(" "),a("span",[e._v("ÊöÇÊó†ÊêúÁ¥¢ÁªìÊûú")])])],1)])]),e._v(" "),a("el-dialog",{attrs:{title:"ÂØºÂá∫ÈÄâÈ°π",visible:e.exportDialogVisible,width:"400px","close-on-click-modal":!1},on:{"update:visible":function(t){e.exportDialogVisible=t}}},[a("el-form",{attrs:{model:e.exportForm,"label-width":"0px"}},[a("el-form-item",[a("el-radio-group",{staticStyle:{width:"100%",height:"100%","align-items":"center",display:"flex","flex-wrap":"wrap","justify-content":"space-around"},model:{value:e.exportForm.exportOption,callback:function(t){e.$set(e.exportForm,"exportOption",t)},expression:"exportForm.exportOption"}},[a("el-radio-button",{attrs:{border:"",label:"search",value:"search"}}),e._v(" "),a("el-radio-button",{attrs:{border:"",label:"all",value:"all"}})],1)],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.exportDialogVisible=!1}}},[e._v("Âèñ Ê∂à")]),e._v(" "),a("el-button",{attrs:{type:"primary",loading:e.exportLoading},on:{click:e.confirmExport}},[e._v("\n                Á°Æ ÂÆö\n            ")])],1)],1)],1)}),[],!1,null,"44b6fcfe",null));t.default=L.exports},fdfc:function(e,t,a){"use strict";a("64f6")}}]);