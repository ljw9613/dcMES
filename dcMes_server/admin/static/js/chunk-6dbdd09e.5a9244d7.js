(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-6dbdd09e","chunk-70222d9f","chunk-35f948aa"],{"19c2":function(e,t,i){"use strict";i.r(t);var n=i("5530"),o=(i("7f7f"),i("ac6a"),i("5df3"),i("4f7f"),i("2909")),s=i("c7eb"),a=(i("96cf"),i("1da1")),c=i("7e1e"),l=i("5aee"),r=i("46ac"),u=i("6b5d"),d={components:{IconSelect:l.a,CustomMenuTree:u.default},dicts:["buttonPermissions"],porps:["dialogFormVisible"],data:function(){return{menu:!1,dialogFormVisible:!1,add:!0,_id:null,postList:{},buttonList:[],optionsList:null,isShow:!1}},created:function(){var e=Object(a.a)(Object(s.a)().mark((function e(){return Object(s.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),methods:{getTree:function(e,t){var i=this.$refs.menuTree.getCheckedNodes(),n=this.$refs.menuTree.getHalfCheckedNodes(),s=i.map((function(e){return e._id})),a=n.map((function(e){return e._id}));this.postList.menuList=Object(o.a)(new Set([].concat(Object(o.a)(s),Object(o.a)(a)))),console.log({"完全选中的节点":s,"半选中的父节点":a,"最终选中列表":this.postList.menuList})},getSelectData:function(){var e=Object(a.a)(Object(s.a)().mark((function e(){var t,i;return Object(s.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(c.b)("menu",{query:{},sort:{sortNum:1}});case 2:t=e.sent,i=t.data,this.optionsList=Object(r.a)(i,null,[]),console.log(JSON.stringify(this.optionsList));case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),AddClick:function(){var e=this;console.log("AddClick"),this.menu=!1,this.isShow=!1,this.postList={},this.add=!0,this.dialogFormVisible=!0,this.getSelectData(),this.$nextTick((function(){e.menu=!0,e.isShow=!0}))},EditClick:function(e){var t=this;this.menu=!1,this.add=!1,this.isShow=!0,this._id=e._id,this.postList=e,this.dialogFormVisible=!0,this.getSelectData(),this.$nextTick((function(){t.menu=!0,t.initTreeSelection(),t.$forceUpdate()}))},createData:function(){var e=Object(a.a)(Object(s.a)().mark((function e(){var t,i;return Object(s.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.postList.name){e.next=5;break}return this.$message.warning("角色名称不能为空"),e.abrupt("return");case 5:if(this.postList.label){e.next=8;break}return this.$message.warning("角色标识不能为空"),e.abrupt("return");case 8:return t=Object(n.a)({},this.postList),console.log(t),e.next=12,Object(c.a)("role",t);case 12:i=e.sent,console.log(i),i?(console.log(i),this.$emit("custom-event"),this.dialogFormVisible=!1,this.postList={type:"目录",sortNum:1,status:!0},this.$notify({title:"添加角色成功",message:"Add Successfully",type:"success",duration:2e3})):this.$notify({title:"添加失败，请重试或刷新",message:"Add unsuccessful",type:"warning",duration:2e3});case 15:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),getMenuList:function(e){return e.filter((function(t,i){return e.indexOf(t)===i}))},editData:function(){if(this.postList.name)if(this.postList.label){delete this.postList._id;var e={query:{_id:this._id},update:Object(n.a)({},this.postList)};console.log(e);var t=Object(c.d)("role",e);console.log(t),this.dialogFormVisible=!1,this.$emit("custom-event"),this.$notify({title:"修改成功",message:"edit Successfully",type:"success",duration:2e3})}else this.$message.warning("角色标识不能为空");else this.$message.warning("角色名称不能为空")},getParentId:function(e){console.log(e),Array.isArray(e)&&(this.postList.parentId=e[e.length-1],console.log(this.postList.parentId))},initTreeSelection:function(){var e=this;this.postList.menuList&&this.postList.menuList.length>0&&this.$nextTick((function(){e.$refs.menuTree.setCheckedKeys(e.postList.menuList)}))}}},h=d,f=i("2877"),p=Object(f.a)(h,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"app-container"},[i("el-dialog",{attrs:{title:e.add?"添加角色":"编辑角色",visible:e.dialogFormVisible},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[e.isShow?i("el-form",{ref:"dataForm",attrs:{"label-position":"right"},model:{value:e.postList,callback:function(t){e.postList=t},expression:"postList"}},[i("el-form-item",{attrs:{label:"角色名称","label-width":"100px",required:""}},[i("el-input",{attrs:{placeholder:"请输入角色名称"},model:{value:e.postList.name,callback:function(t){e.$set(e.postList,"name",t)},expression:"postList.name"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"角色标识","label-width":"100px",required:""}},[i("el-input",{attrs:{placeholder:"请输入角色标识"},model:{value:e.postList.label,callback:function(t){e.$set(e.postList,"label",t)},expression:"postList.label"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"按钮权限","label-width":"100px",required:""}},[i("el-select",{attrs:{multiple:"",placeholder:"请选择按钮权限"},model:{value:e.postList.buttonList,callback:function(t){e.$set(e.postList,"buttonList",t)},expression:"postList.buttonList"}},e._l(e.dict.type.buttonPermissions,(function(e){return i("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),e._v(" "),i("el-form-item",{attrs:{label:"菜单权限","label-width":"100px",required:""}},[e.menu?i("el-card",{attrs:{shadow:"never"}},[e.optionsList.length>0?i("custom-menu-tree",{attrs:{options:e.optionsList},model:{value:e.postList.menuList,callback:function(t){e.$set(e.postList,"menuList",t)},expression:"postList.menuList"}}):e._e()],1):e._e()],1),e._v(" "),i("el-form-item",{attrs:{label:"备注","label-width":"100px"}},[i("el-input",{attrs:{placeholder:"请输入备注",type:"textarea"},model:{value:e.postList.remark,callback:function(t){e.$set(e.postList,"remark",t)},expression:"postList.remark"}})],1)],1):e._e(),e._v(" "),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(t){e.dialogFormVisible=!1}}},[e._v("取消")]),e._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:function(t){e.add?e.createData():e.editData()}}},[e._v("确定\n      ")])],1)],1)],1)}),[],!1,null,"4af5c3ca",null);t.default=p.exports},"49e2":function(e,t,i){"use strict";i("ff8b")},"4cd6":function(e,t,i){},"52e5":function(e,t,i){},"552b":function(e,t,i){"use strict";i("52e5")},"5aee":function(e,t,i){"use strict";var n=["platform-eleme","eleme","delete-solid","delete","s-tools","setting","user-solid","user","phone","phone-outline","more","more-outline","star-on","star-off","s-goods","goods","warning","warning-outline","question","info","remove","circle-plus","success","error","zoom-in","zoom-out","remove-outline","circle-plus-outline","circle-check","circle-close","s-help","help","minus","plus","check","close","picture","picture-outline","picture-outline-round","upload","upload2","download","camera-solid","camera","video-camera-solid","video-camera","message-solid","bell","s-cooperation","s-order","s-platform","s-fold","s-unfold","s-operation","s-promotion","s-home","s-release","s-ticket","s-management","s-open","s-shop","s-marketing","s-flag","s-comment","s-finance","s-claim","s-custom","s-opportunity","s-data","s-check","s-grid","menu","share","d-caret","caret-left","caret-right","caret-bottom","caret-top","bottom-left","bottom-right","back","right","bottom","top","top-left","top-right","arrow-left","arrow-right","arrow-down","arrow-up","d-arrow-left","d-arrow-right","video-pause","video-play","refresh","refresh-right","refresh-left","finished","sort","sort-up","sort-down","rank","loading","view","c-scale-to-original","date","edit","edit-outline","folder","folder-opened","folder-add","folder-remove","folder-delete","folder-checked","tickets","document-remove","document-delete","document-copy","document-checked","document","document-add","printer","paperclip","takeaway-box","search","monitor","attract","mobile","scissors","umbrella","headset","brush","mouse","coordinate","magic-stick","reading","data-line","data-board","pie-chart","data-analysis","collection-tag","film","suitcase","suitcase-1","receiving","collection","files","notebook-1","notebook-2","toilet-paper","office-building","school","table-lamp","house","no-smoking","smoking","shopping-cart-full","shopping-cart-1","shopping-cart-2","shopping-bag-1","shopping-bag-2","sold-out","sell","present","box","bank-card","money","coin","wallet","discount","price-tag","news","guide","male","female","thumb","cpu","link","connection","open","turn-off","set-up","chat-round","chat-line-round","chat-square","chat-dot-round","chat-dot-square","chat-line-square","message","postcard","position","turn-off-microphone","microphone","close-notification","bangzhu","time","odometer","crop","aim","switch-button","full-screen","copy-document","mic","stopwatch","medal-1","medal","trophy","trophy-1","first-aid-kit","discover","place","location","location-outline","location-information","add-location","delete-location","map-location","alarm-clock","timer","watch-1","watch","lock","unlock","key","service","mobile-phone","bicycle","truck","ship","basketball","football","soccer","baseball","wind-power","light-rain","lightning","heavy-rain","sunrise","sunrise-1","sunset","sunny","cloudy","partly-cloudy","cloudy-and-sunny","moon","moon-night","dish","dish-1","food","chicken","fork-spoon","knife-fork","burger","tableware","sugar","dessert","ice-cream","hot-water","water-cup","coffee-cup","cold-drink","goblet","goblet-full","goblet-square","goblet-square-full","refrigerator","grape","watermelon","cherry","apple","pear","orange","coffee","ice-tea","ice-drink","milk-tea","potato-strips","lollipop","ice-cream-square","ice-cream-round"].map((function(e){return"el-icon-"+e})),o={name:"IconSelects",props:["IconData"],data:function(){return{userChooseIcon:"",chooseIcons:"请选择图标",iconList:[]}},watch:{IconData:function(e){e&&(console.log(e),this.userChooseIcon=e,this.chooseIcons=e)}},created:function(){this.iconList=n},methods:{editClicks:function(){this.userChooseIcon=this.IconData,this.chooseIcons=this.IconData},setIcon:function(e){console.log(e),this.userChooseIcon=e,this.chooseIcons=e,this.$emit("update:IconData",e)}}},s=o,a=(i("49e2"),i("2877")),c=Object(a.a)(s,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"chooseIcons"},[i("el-popover",{attrs:{placement:"top-start","append-to-body":!1,width:"30vw",trigger:"click"}},[i("div",{staticClass:"iconDiv",attrs:{slot:"reference"},slot:"reference"},[i("div",{staticClass:"iconName"},[i("i",{class:e.userChooseIcon}),e._v("\n         "+e._s(e.chooseIcons))])]),e._v(" "),i("div",{staticClass:"iconList"},e._l(e.iconList,(function(t){return i("i",{key:t,class:[t,"icon"],staticStyle:{"font-size":"20px"},on:{click:function(i){return e.setIcon(t)}}})})),0)])],1)}),[],!1,null,"3b31ed31",null);t.a=c.exports},"676f":function(e,t,i){"use strict";i("4cd6")},"6b5d":function(e,t,i){"use strict";i.r(t);var n=(i("6762"),i("2fdb"),i("ac6a"),i("5530")),o={name:"CustomMenuTree",props:{value:{type:Array,default:function(){return[]}},options:{type:Array,default:function(){return[]}}},data:function(){return{menuList:[]}},watch:{options:{handler:function(e){this.initMenuList(e)},immediate:!0},value:{handler:function(e){this.initSelectedMenus(e)},immediate:!0}},methods:{initMenuList:function(e){this.menuList=e.map((function(e){return Object(n.a)(Object(n.a)({},e),{},{checked:!1,indeterminate:!1,expanded:!1,children:e.children?e.children.map((function(e){return Object(n.a)(Object(n.a)({},e),{},{checked:!1})})):null})}))},expandAll:function(){this.menuList.forEach((function(e){e.expanded=!0}))},collapseAll:function(){this.menuList.forEach((function(e){e.expanded=!1}))},toggleExpand:function(e){e.expanded=!e.expanded},initSelectedMenus:function(e){e&&e.length&&this.menuList.forEach((function(t){if(t.checked=e.includes(t._id),t.children){var i=0;t.children.forEach((function(t){t.checked=e.includes(t._id),t.checked&&i++})),i===t.children.length?(t.checked=!0,t.indeterminate=!1):i>0?(t.checked=!1,t.indeterminate=!0):(t.checked=!1,t.indeterminate=!1)}}))},handleDirectoryCheck:function(e,t){e.indeterminate=!1,e.children&&e.children.forEach((function(e){e.checked=t})),this.emitChange()},handleMenuCheck:function(e,t,i){var n=e.children.filter((function(e){return e.checked}));e.checked=n.length===e.children.length,e.indeterminate=n.length>0&&n.length<e.children.length,this.emitChange()},emitChange:function(){var e=[];this.menuList.forEach((function(t){(t.checked||t.indeterminate)&&e.push(t._id),t.children&&t.children.forEach((function(t){t.checked&&e.push(t._id)}))})),this.$emit("input",e)}}},s=o,a=(i("552b"),i("2877")),c=Object(a.a)(s,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"custom-menu-tree"},[i("div",{staticClass:"tree-operations"},[i("el-button",{attrs:{type:"text",size:"small"},on:{click:e.expandAll}},[i("i",{staticClass:"el-icon-circle-plus-outline"}),e._v(" 展开全部\n    ")]),e._v(" "),i("el-divider",{attrs:{direction:"vertical"}}),e._v(" "),i("el-button",{attrs:{type:"text",size:"small"},on:{click:e.collapseAll}},[i("i",{staticClass:"el-icon-remove-outline"}),e._v(" 收起全部\n    ")])],1),e._v(" "),e._l(e.menuList,(function(t){return i("div",{key:t._id,staticClass:"menu-item"},[i("div",{staticClass:"menu-directory",class:{"is-expanded":t.expanded}},[i("div",{staticClass:"menu-header",on:{click:function(i){return e.toggleExpand(t)}}},[i("el-checkbox",{attrs:{indeterminate:t.indeterminate},on:{change:function(i){return e.handleDirectoryCheck(t,i)},click:function(e){e.stopPropagation()}},model:{value:t.checked,callback:function(i){e.$set(t,"checked",i)},expression:"menu.checked"}},[i("i",{staticClass:"menu-icon",class:t.icon}),e._v("\n          "+e._s(t.menuName)+"\n        ")]),e._v(" "),t.children?i("i",{staticClass:"el-icon-arrow-right expand-icon",class:{"is-expanded":t.expanded}}):e._e()],1)]),e._v(" "),i("el-collapse-transition",[t.children&&t.expanded?i("div",{staticClass:"sub-menu"},e._l(t.children,(function(n){return i("div",{key:n._id,staticClass:"sub-menu-item"},[i("el-checkbox",{on:{change:function(i){return e.handleMenuCheck(t,n,i)}},model:{value:n.checked,callback:function(t){e.$set(n,"checked",t)},expression:"subMenu.checked"}},[i("i",{staticClass:"menu-icon",class:n.icon}),e._v("\n            "+e._s(n.menuName)+"\n          ")])],1)})),0):e._e()])],1)}))],2)}),[],!1,null,"09f89080",null);t.default=c.exports},"6c35":function(e,t,i){"use strict";i.r(t);var n=(i("7f7f"),i("5530")),o=i("c7eb"),s=(i("96cf"),i("1da1")),a=i("7e1e"),c=i("19c2"),l=i("cf1e"),r=i.n(l),u={components:{roleDialog:c.default},data:function(){return{list:[],backupslist:null,listLoading:!0,downloadLoading:!1,inputVisible:!1,rows:"",dialogFormVisible:!1,dialogFormVisible1:!1,seachdataname:"",add:!0,temp:[],postlist:{}}},created:function(){this.fetchData()},methods:{variables:function(){return{background:r.a.tableBg,color:r.a.tableText,"font-weight":r.a.tableTextWeight}},fetchData:function(){var e=Object(s.a)(Object(o.a)().mark((function e(){var t,i;return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.listLoading=!0,e.next=3,Object(a.b)("role",{query:{}});case 3:t=e.sent,i=t.data,this.list=i,console.log(this.list),this.listLoading=!1;case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),handleFilter:function(){this.$refs.roleDialogRef.AddClick()},createData:function(){var e=this,t=Object(n.a)({},this.postlist);console.log(t),postrole(t).then((function(t){t?(console.log(t),e.fetchData(),console.log(e.list),e.dialogFormVisible=!1,e.postlist={label:"",value:"",sort:0,type:"角色"},e.$notify({title:"添加Success",message:"Add Successfully",type:"success",duration:2e3})):e.$notify({title:"Add失败，请重试或刷新",message:"Add unsuccessful",type:"warning",duration:2e3})}))},handleClose:function(e){console.log(e),this.temp.splice(e,1)},handleEdit:function(e){this.$refs.roleDialogRef.EditClick(e)},editData:function(){var e=this,t=this.postlist._id;delete this.postlist._id;var i={query:{_id:t},update:Object(n.a)({},this.postlist)};console.log(i),putrole(i).then((function(t){console.log(t),200==t.code?(e.dialogFormVisible=!1,e.fetchData(),e.$notify({title:"修改成功",message:"edit Successfully",type:"success",duration:2e3})):e.$notify({title:"修改失败，请重新刷新",message:"edit failly",type:"warning",duration:2e3})}))},showInput:function(){var e=this;this.inputVisible=!0,this.$nextTick((function(t){e.$refs.saveTagInput.$refs.input.focus()}))},handleDelete:function(e,t){var i=this;console.log(e),this.$confirm("确定删除"+e.name+"吗？").then(function(){var t=Object(s.a)(Object(o.a)().mark((function t(n){var s;return Object(o.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e._id,t.next=3,Object(a.c)("role",{query:{_id:e._id}});case 3:s=t.sent,console.log(s),i.fetchData(),i.$notify({title:"删除成功",message:"已将"+e.name+"删除",type:"danger",duration:2e3});case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()).catch((function(e){i.dialogVisible=!1}))},handleDownload:function(){var e=this;this.downloadLoading=!0,Promise.all([i.e("chunk-6e83591c"),i.e("chunk-ce0ae100"),i.e("chunk-5837544a")]).then(i.bind(null,"4bf8d")).then((function(t){var i=Object.getOwnPropertyNames(e.list[0]),n=i,o=i,s=e.formatJson(o);t.export_json_to_excel({header:n,data:s,filename:"职位信息表"}),e.downloadLoading=!1}))},formatJson:function(e){return this.list.map((function(t){return e.map((function(e){return"Add_time"===e?parseTime(t[e]):t[e]}))}))},imgSaveToUrl:function(e,t,i){var n=this;console.log(i),console.log(e.raw),this.localFile=e.raw;var o=new FormData;o.append("file",this.localFile),console.log(o),postroleimg(o).then((function(e){if(2e4==e.code){var t=e.filename;console.log(t),n.temp1[i].subImg=t}else that.$message.error(e.message)}))},handleSizeChange:function(e){this.pagesize=e},handleCurrentChange:function(e){this.currentPage=e}}},d=u,h=(i("676f"),i("2877")),f=Object(h.a)(d,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"app-container"},[i("div",{staticClass:"filter-container"},[i("el-button",{staticClass:"filter-item",attrs:{icon:"el-icon-plus",type:"primary"},on:{click:e.handleFilter}},[e._v("添加角色\n    ")])],1),e._v(" "),i("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],staticStyle:{width:"100%"},attrs:{data:e.list,"header-cell-style":e.variables(),"tree-props":{children:"children"},border:"","element-loading-text":"Loading",fit:"","highlight-current-row":"","row-key":"_id"}},[i("el-table-column",{attrs:{align:"left",fixed:"left",label:"角色标题",width:"200px"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",[e._v(e._s(t.row.name))])]}}])}),e._v(" "),i("el-table-column",{attrs:{align:"center",label:"角色标识"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",[e._v(e._s(t.row.label))])]}}])}),e._v(" "),i("el-table-column",{attrs:{align:"center",label:"菜单权限"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",{staticClass:"link-type",on:{click:function(i){return e.handleEdit(t.row)}}},[e._v("查看")])]}}])}),e._v(" "),i("el-table-column",{attrs:{align:"center",label:"更新时间",prop:"created_at",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("i",{staticClass:"el-icon-time"}),e._v(" "),i("span",[e._v(e._s(e._f("parseTime")(t.row.updateAt,"{y}-{m}-{d} {h}:{i}")))])]}}])}),e._v(" "),i("el-table-column",{attrs:{align:"center",label:"备注"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",[e._v(e._s(t.row.remark))])]}}])}),e._v(" "),i("el-table-column",{attrs:{align:"center",fixed:"right",label:"操作",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[i("el-button",{staticStyle:{color:"blue"},attrs:{size:"mini",type:"text"},on:{click:function(t){return e.handleEdit(n)}}},[e._v("编辑\n        ")]),e._v(" "),i("el-button",{staticStyle:{color:"red"},attrs:{size:"mini",type:"text"},on:{click:function(t){return e.handleDelete(n)}}},[e._v("删除\n        ")])]}}])})],1),e._v(" "),i("roleDialog",{ref:"roleDialogRef",attrs:{dialogFormVisible:e.dialogFormVisible},on:{"custom-event":e.fetchData}})],1)}),[],!1,null,"137835ca",null);t.default=f.exports},ff8b:function(e,t,i){}}]);