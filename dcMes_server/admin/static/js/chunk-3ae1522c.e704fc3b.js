(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-3ae1522c"],{"0457":function(e,t,n){},"316f":function(e,t,n){"use strict";n("0457")},5260:function(e,t,n){"use strict";n.r(t);var r=(n("7514"),n("c7eb")),a=(n("5df3"),n("f400"),n("ac6a"),n("2909")),s=(n("6762"),n("2fdb"),n("96cf"),n("1da1")),c=n("7e1e"),i={name:"ExpertSelect",props:{value:{type:Array,default:function(){return[]}}},data:function(){return{loading:!1,experts:[],selectedExperts:this.value}},watch:{value:{handler:function(e){this.selectedExperts=e,e&&e.length&&!this.experts.length&&this.fetchExpertsByIds(e)},immediate:!0}},methods:{remoteSearch:function(){var e=Object(s.a)(Object(r.a)().mark((function e(t){var n,s,i=this;return Object(r.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(""===t){e.next=15;break}return this.loading=!0,e.prev=2,e.next=5,Object(c.b)("expert",{query:JSON.stringify({nickname:{$regex:t,$options:"i"}}),limit:20});case 5:n=e.sent,s=this.experts.filter((function(e){return i.selectedExperts.includes(e._id)})),this.experts=Object(a.a)(new Map([].concat(Object(a.a)(s),Object(a.a)(n.data)).map((function(e){return[e._id,e]}))).values()),e.next=14;break;case 10:e.prev=10,e.t0=e.catch(2),this.$message.error("搜索达人失败");case 14:this.loading=!1;case 15:case"end":return e.stop()}}),e,this,[[2,10]])})));return function(t){return e.apply(this,arguments)}}(),handleChange:function(e){this.$emit("input",e);var t=this.experts.filter((function(t){return e.includes(t._id)}));this.$emit("select",t)},fetchExpertsByIds:function(){var e=Object(s.a)(Object(r.a)().mark((function e(t){var n,s;return Object(r.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.length){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,e.next=5,Object(c.b)("expert",{query:JSON.stringify({_id:{$in:t}})});case 5:(n=e.sent).data&&n.data.length>0&&(s=this.experts.filter((function(e){return!n.data.find((function(t){return t._id===e._id}))})),this.experts=[].concat(Object(a.a)(s),Object(a.a)(n.data))),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(2);case 12:case"end":return e.stop()}}),e,this,[[2,9]])})));return function(t){return e.apply(this,arguments)}}()}},l=i,u=(n("316f"),n("2877")),o=Object(u.a)(l,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-select",{attrs:{multiple:"",filterable:"",remote:"","reserve-keyword":"",placeholder:"请输入达人昵称搜索","remote-method":e.remoteSearch,loading:e.loading,clearable:"","collapse-tags":""},on:{change:e.handleChange},model:{value:e.selectedExperts,callback:function(t){e.selectedExperts=t},expression:"selectedExperts"}},e._l(e.experts,(function(t){return n("el-option",{key:t._id,attrs:{label:t.nickname,value:t._id}},[n("div",{staticClass:"expert-option"},[n("span",[e._v(e._s(t.nickname))]),e._v(" "),n("small",{staticClass:"platform-info"},[e._v("\n        "+e._s(t.platform)+" | "+e._s(t.mainCategory)+"\n      ")])])])})),1)}),[],!1,null,"3e1c6cf4",null);t.default=o.exports}}]);