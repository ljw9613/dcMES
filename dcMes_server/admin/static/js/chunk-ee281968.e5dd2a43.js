(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-ee281968","chunk-2d215d10"],{"1aa1":function(t,e,a){"use strict";a.r(e);var r=(a("a481"),a("7f7f"),a("6762"),a("2fdb"),a("c7eb")),n=(a("96cf"),a("1da1")),o=(a("7514"),a("3452"),a("c08e")),i=a("c466"),s={name:"ProductionOrder",data:function(){return{modelName:"PRD_MO",model:null,searchForm:{FBillNo:"",FDocumentStatus:"",FDate:[],FMaterialId:"",FWorkShopID0:"",FProductType:"",FPlanStartDate:"",FPlanFinishDate:""},showAdvanced:!1,tableData:[],loading:!1,page:{current:1,size:10,total:0},orgList:[],workshopList:[]}},created:function(){this.init(),this.getList(),this.getOrgList(),this.getWorkshopList()},methods:{init:function(){var t=this;this.model=o.find((function(e){return e.modelName===t.modelName}))},getList:function(){var t=Object(n.a)(Object(r.a)().mark((function t(){var e,a=this;return Object(r.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.loading=!0,t.prev=1,t.next=4,this.$requestK3Data({modelName:"PRD_MO",method:"BillQuery",methodData:{FormId:"PRD_MO",FieldKeys:this.getFieldKeys(),FilterString:this.getFilterString(),OrderString:"",TopRowCount:this.page.size,StartRow:(this.page.current-1)*this.page.size,Limit:this.page.size}});case 4:e=t.sent,this.tableData=e.data.map((function(t){return a.convertArrayToObject(t)})),this.page.total=e.total,t.next=13;break;case 9:t.prev=9,t.t0=t.catch(1),this.$message.error("获取数据失败");case 13:this.loading=!1;case 14:case"end":return t.stop()}}),t,this,[[1,9]])})));return function(){return t.apply(this,arguments)}}(),getFieldKeys:function(){return this.model.header.map((function(t){return t.name.includes("_")?t.name.replace("_","."):t.name})).join(",")},getFilterString:function(){var t=[];return this.searchForm.FBillNo&&t.push("FBillNo like '%".concat(this.searchForm.FBillNo,"%'")),this.searchForm.FDocumentStatus&&t.push("FDocumentStatus = '".concat(this.searchForm.FDocumentStatus,"'")),this.searchForm.FDate&&2===this.searchForm.FDate.length&&(t.push("FDate >= '".concat(Object(i.a)(this.searchForm.FDate[0]),"'")),t.push("FDate <= '".concat(Object(i.a)(this.searchForm.FDate[1]),"'"))),this.searchForm.FMaterialId&&t.push("FMaterialId = '".concat(this.searchForm.FMaterialId,"'")),this.searchForm.FProductType&&t.push("FProductType = '".concat(this.searchForm.FProductType,"'")),this.searchForm.FPlanStartDate&&t.push("FPlanStartDate >= '".concat(Object(i.a)(this.searchForm.FPlanStartDate),"'")),this.searchForm.FPlanFinishDate&&t.push("FPlanFinishDate <= '".concat(Object(i.a)(this.searchForm.FPlanFinishDate),"'")),t.join(" and ")},getOrgList:function(){var t=Object(n.a)(Object(r.a)().mark((function t(){return Object(r.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),getWorkshopList:function(){var t=Object(n.a)(Object(r.a)().mark((function t(){return Object(r.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),handleSearch:function(){this.page.current=1,this.getList()},resetForm:function(){this.$refs.searchForm.resetFields(),this.handleSearch()},handleAdd:function(){this.$router.push("/production/order/add")},handleEdit:function(t){this.$router.push("/production/order/edit/".concat(t.FID))},handleView:function(t){this.$router.push("/production/order/view/".concat(t.FID))},handleDelete:function(t){this.$confirm("确认删除该生产订单?","提示",{type:"warning"}).then((function(){}))},handleSizeChange:function(t){this.page.size=t,this.getList()},handleCurrentChange:function(t){this.page.current=t,this.getList()},formatDate:i.a,getStatusType:function(t){return{DRAFT:"info",APPROVED:"success",CLOSED:"warning"}[t]||"info"},getStatusText:function(t){return{DRAFT:"草稿",APPROVED:"已审核",CLOSED:"已关闭"}[t]||t},toggleAdvanced:function(){this.showAdvanced=!this.showAdvanced},convertArrayToObject:function(t){return this.model.header.reduce((function(e,a,r){return e[a.name]=t[r],e}),{})}}},l=s,c=(a("f8a6"),a("2877")),u=Object(c.a)(l,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"app-container"},[a("el-card",{staticClass:"filter-container"},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",[t._v("筛选搜索")]),t._v(" "),a("el-button",{staticStyle:{float:"right",padding:"3px 0"},attrs:{type:"text"},on:{click:t.toggleAdvanced}},[t._v("\n                "+t._s(t.showAdvanced?"收起":"展开")+"高级搜索\n            ")])],1),t._v(" "),a("el-form",{ref:"searchForm",staticClass:"demo-form-inline",attrs:{model:t.searchForm}},[a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"单据编号"}},[a("el-input",{attrs:{placeholder:"请输入单据编号",clearable:""},model:{value:t.searchForm.FBillNo,callback:function(e){t.$set(t.searchForm,"FBillNo",e)},expression:"searchForm.FBillNo"}})],1)],1),t._v(" "),a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"单据状态"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择单据状态",clearable:""},model:{value:t.searchForm.FDocumentStatus,callback:function(e){t.$set(t.searchForm,"FDocumentStatus",e)},expression:"searchForm.FDocumentStatus"}},[a("el-option",{attrs:{label:"草稿",value:"DRAFT"}}),t._v(" "),a("el-option",{attrs:{label:"已审核",value:"APPROVED"}}),t._v(" "),a("el-option",{attrs:{label:"已关闭",value:"CLOSED"}})],1)],1)],1),t._v(" "),a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"单据日期"}},[a("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期"},model:{value:t.searchForm.FDate,callback:function(e){t.$set(t.searchForm,"FDate",e)},expression:"searchForm.FDate"}})],1)],1),t._v(" "),a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"物料编码"}},[a("el-input",{attrs:{placeholder:"请输入物料编码",clearable:""},model:{value:t.searchForm.FMaterialId,callback:function(e){t.$set(t.searchForm,"FMaterialId",e)},expression:"searchForm.FMaterialId"}})],1)],1)],1),t._v(" "),a("el-collapse-transition",[a("div",{directives:[{name:"show",rawName:"v-show",value:t.showAdvanced,expression:"showAdvanced"}]},[a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"生产车间"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择生产车间",clearable:""},model:{value:t.searchForm.FWorkShopID0,callback:function(e){t.$set(t.searchForm,"FWorkShopID0",e)},expression:"searchForm.FWorkShopID0"}},t._l(t.workshopList,(function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1)],1),t._v(" "),a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"产品类型"}},[a("el-input",{attrs:{placeholder:"请输入产品类型",clearable:""},model:{value:t.searchForm.FProductType,callback:function(e){t.$set(t.searchForm,"FProductType",e)},expression:"searchForm.FProductType"}})],1)],1),t._v(" "),a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"计划开工时间"}},[a("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"date",placeholder:"选择开工时间"},model:{value:t.searchForm.FPlanStartDate,callback:function(e){t.$set(t.searchForm,"FPlanStartDate",e)},expression:"searchForm.FPlanStartDate"}})],1)],1),t._v(" "),a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"计划完工时间"}},[a("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"date",placeholder:"选择完工时间"},model:{value:t.searchForm.FPlanFinishDate,callback:function(e){t.$set(t.searchForm,"FPlanFinishDate",e)},expression:"searchForm.FPlanFinishDate"}})],1)],1)],1)],1)]),t._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:t.handleSearch}},[t._v("查询")]),t._v(" "),a("el-button",{on:{click:t.resetForm}},[t._v("重置")]),t._v(" "),a("el-button",{attrs:{type:"success"},on:{click:t.handleAdd}},[t._v("新增订单")])],1)],1)],1),t._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticStyle:{width:"100%","margin-top":"20px"},attrs:{data:t.tableData,border:""}},[a("el-table-column",{attrs:{prop:"FBillNo",label:"单据编号",width:"150"}}),t._v(" "),a("el-table-column",{attrs:{prop:"FDocumentStatus",label:"单据状态",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-tag",{attrs:{type:t.getStatusType(e.row.FDocumentStatus)}},[t._v("\n                    "+t._s(t.getStatusText(e.row.FDocumentStatus))+"\n                ")])]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"FDate",label:"单据日期",width:"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n                "+t._s(t.formatDate(e.row.FDate))+"\n            ")]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"FMaterialId",label:"物料编码",width:"120"}}),t._v(" "),a("el-table-column",{attrs:{prop:"FMaterialName",label:"物料名称",width:"150"}}),t._v(" "),a("el-table-column",{attrs:{prop:"FSpecification",label:"规格型号",width:"120"}}),t._v(" "),a("el-table-column",{attrs:{prop:"FProductType",label:"产品类型",width:"120"}}),t._v(" "),a("el-table-column",{attrs:{prop:"FQty",label:"数量",width:"100"}}),t._v(" "),a("el-table-column",{attrs:{prop:"FUnitId",label:"单位",width:"80"}}),t._v(" "),a("el-table-column",{attrs:{prop:"FWorkShopID_FName",label:"生产车间",width:"120"}}),t._v(" "),a("el-table-column",{attrs:{prop:"FPlanStartDate",label:"计划开工时间",width:"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n                "+t._s(t.formatDate(e.row.FPlanStartDate))+"\n            ")]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"FPlanFinishDate",label:"计划完工时间",width:"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n                "+t._s(t.formatDate(e.row.FPlanFinishDate))+"\n            ")]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"操作",width:"150",fixed:"right"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(a){return t.handleEdit(e.row)}}},[t._v("编辑")]),t._v(" "),a("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(a){return t.handleView(e.row)}}},[t._v("查看")]),t._v(" "),"DRAFT"===e.row.FDocumentStatus?a("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(a){return t.handleDelete(e.row)}}},[t._v("删除")]):t._e()]}}])})],1),t._v(" "),a("el-pagination",{staticStyle:{"margin-top":"20px"},attrs:{"current-page":t.page.current,"page-sizes":[10,20,50,100],"page-size":t.page.size,layout:"total, sizes, prev, pager, next, jumper",total:t.page.total},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1)}),[],!1,null,"82b7d234",null);e.default=u.exports},"346f":function(t,e,a){},5:function(t,e){},c08e:function(t){t.exports=[{modelName:"PRD_MO",description:"生产订单",header:[{name:"FID",type:"number",description:"实体主键",required:!1},{name:"FBillNo",type:"string",description:"单据编号",required:!1},{name:"FDocumentStatus",type:"string",description:"单据状态",required:!1},{name:"FApproverId",type:"string",description:"审核人",required:!1},{name:"FApproveDate",type:"date",description:"审核日期",required:!1},{name:"FDate",type:"date",description:"单据日期",required:!0},{name:"FWorkShopID_FName",type:"string",description:"生产车间",required:!1},{name:"FMaterialId",type:"string",description:"物料编码",required:!0},{name:"FMaterialName",type:"string",description:"物料名称",required:!1},{name:"FSpecification",type:"string",description:"规格型号",required:!1},{name:"FProductType",type:"string",description:"产品类型",required:!0},{name:"FUnitId",type:"string",description:"单位",required:!0},{name:"FQty",type:"number",description:"数量",required:!0},{name:"FPlanStartDate",type:"date",description:"计划开工时间",required:!0},{name:"FPlanFinishDate",type:"date",description:"计划完工时间",required:!0}]}]},c466:function(t,e,a){"use strict";function r(t){return t?(("string"==typeof t||"number"==typeof t)&&(t=new Date(t)),t.getFullYear()+"-"+(t.getMonth()+1)+"-"+(t.getDate()<10?"0"+t.getDate():t.getDate())+" "+(t.getHours()<10?"0"+t.getHours():t.getHours())+":"+(t.getMinutes()<10?"0"+t.getMinutes():t.getMinutes())+":"+(t.getSeconds()<10?"0"+t.getSeconds():t.getSeconds())):""}function n(t){return t||0===t?t.toString().replace(/\B(?=(\d{3})+(?!\d))/g,","):"0"}a.d(e,"a",(function(){return r})),a.d(e,"b",(function(){return n})),a("6b54"),a("a481")},f8a6:function(t,e,a){"use strict";a("346f")}}]);