(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-14731cba","chunk-99622d58"],{"4f09":function(e,t,a){},5190:function(e,t,a){},"5a03":function(e,t,a){"use strict";a("5190")},a9b1:function(e,t,a){"use strict";a.r(t);var r=a("c7eb"),s=(a("96cf"),a("1da1")),l=a("5530"),i={name:"EditDialog",dicts:["templateType","businessType"],props:{visible:{type:Boolean,default:!1},dialogStatus:{type:String,default:"create"},rowData:{type:Object,default:function(){return{}}}},data:function(){return{dialogVisible:this.visible,form:{templateName:"",templateCode:"",templateType:"",businessType:"",config:{paperSize:"A4",orientation:"portrait",width:210,height:297},content:"",version:"1.0.0",isDefault:!1,status:!0,remark:""},rules:{templateName:[{required:!0,message:"请输入模板名称",trigger:"blur"}],templateCode:[{required:!0,message:"请输入模板编号",trigger:"blur"}],businessType:[{required:!0,message:"请选择业务类型",trigger:"change"}],"config.paperSize":[{required:!0,message:"请选择纸张大小",trigger:"change"}],"config.orientation":[{required:!0,message:"请选择打印方向",trigger:"change"}],version:[{required:!0,message:"请输入版本号",trigger:"blur"}]},submitLoading:!1}},computed:{dialogTitle:function(){return"create"===this.dialogStatus?"新增打印模板":"编辑打印模板"}},watch:{visible:function(e){this.dialogVisible=e,e&&this.initFormData()}},methods:{initFormData:function(){"edit"===this.dialogStatus?(this.form=Object(l.a)({},this.rowData),this.form.config=this.form.config||{paperSize:"A4",orientation:"portrait",width:210,height:297}):this.form={templateName:"",templateCode:"",templateType:"",businessType:"",config:{paperSize:"A4",orientation:"portrait",width:210,height:297},content:"",version:"1.0.0",isDefault:!1,status:!0,remark:""}},handleClose:function(){this.$emit("update:visible",!1),this.$refs.form&&this.$refs.form.resetFields()},handleSubmit:function(){var e=this;this.$refs.form.validate(function(){var t=Object(s.a)(Object(r.a)().mark((function t(a){var s;return Object(r.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a){e.submitLoading=!0;try{s=Object(l.a)({},e.form),e.$emit("submit",s),e.handleClose()}catch(t){console.error("提交失败:",t),e.$message.error("提交失败")}finally{e.submitLoading=!1}}case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}}},n=i,o=(a("ecf1"),a("2877")),c=Object(o.a)(n,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{attrs:{title:e.dialogTitle,visible:e.dialogVisible,width:"60%"},on:{close:e.handleClose,"update:visible":function(t){return e.$emit("update:visible",t)}}},[a("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"120px",size:"small"}},[a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"模板名称",prop:"templateName"}},[a("el-input",{attrs:{placeholder:"请输入模板名称"},model:{value:e.form.templateName,callback:function(t){e.$set(e.form,"templateName",t)},expression:"form.templateName"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"模板编号",prop:"templateCode"}},[a("el-input",{attrs:{placeholder:"请输入模板编号"},model:{value:e.form.templateCode,callback:function(t){e.$set(e.form,"templateCode",t)},expression:"form.templateCode"}})],1)],1)],1),e._v(" "),a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"模板类型",prop:"templateType"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择模板类型"},model:{value:e.form.templateType,callback:function(t){e.$set(e.form,"templateType",t)},expression:"form.templateType"}},e._l(e.dict.type.templateType,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)],1),e._v(" "),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"业务类型",prop:"businessType"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择业务类型"},model:{value:e.form.businessType,callback:function(t){e.$set(e.form,"businessType",t)},expression:"form.businessType"}},e._l(e.dict.type.businessType,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)],1)],1),e._v(" "),a("el-divider",{attrs:{"content-position":"left"}},[e._v("模板配置")]),e._v(" "),a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"纸张大小",prop:"config.paperSize"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择纸张大小"},model:{value:e.form.config.paperSize,callback:function(t){e.$set(e.form.config,"paperSize",t)},expression:"form.config.paperSize"}},[a("el-option",{attrs:{label:"A4",value:"A4"}}),e._v(" "),a("el-option",{attrs:{label:"A5",value:"A5"}}),e._v(" "),a("el-option",{attrs:{label:"自定义",value:"custom"}})],1)],1)],1),e._v(" "),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"打印方向",prop:"config.orientation"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择打印方向"},model:{value:e.form.config.orientation,callback:function(t){e.$set(e.form.config,"orientation",t)},expression:"form.config.orientation"}},[a("el-option",{attrs:{label:"纵向",value:"portrait"}}),e._v(" "),a("el-option",{attrs:{label:"横向",value:"landscape"}})],1)],1)],1)],1),e._v(" "),"custom"===e.form.config.paperSize?a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"宽度(mm)",prop:"config.width"}},[a("el-input-number",{staticStyle:{width:"100%"},attrs:{min:1,max:1e3},model:{value:e.form.config.width,callback:function(t){e.$set(e.form.config,"width",t)},expression:"form.config.width"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"高度(mm)",prop:"config.height"}},[a("el-input-number",{staticStyle:{width:"100%"},attrs:{min:1,max:1e3},model:{value:e.form.config.height,callback:function(t){e.$set(e.form.config,"height",t)},expression:"form.config.height"}})],1)],1)],1):e._e(),e._v(" "),a("el-divider",{attrs:{"content-position":"left"}},[e._v("模板内容")]),e._v(" "),a("el-form-item",{attrs:{label:"模板内容",prop:"content"}},[a("el-input",{attrs:{type:"textarea",rows:6,placeholder:"请输入模板内容（HTML/JSON格式）"},model:{value:e.form.content,callback:function(t){e.$set(e.form,"content",t)},expression:"form.content"}})],1),e._v(" "),a("el-divider",{attrs:{"content-position":"left"}},[e._v("其他设置")]),e._v(" "),a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"版本号",prop:"version"}},[a("el-input",{attrs:{placeholder:"请输入版本号"},model:{value:e.form.version,callback:function(t){e.$set(e.form,"version",t)},expression:"form.version"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"是否默认",prop:"isDefault"}},[a("el-switch",{model:{value:e.form.isDefault,callback:function(t){e.$set(e.form,"isDefault",t)},expression:"form.isDefault"}})],1)],1)],1),e._v(" "),a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"状态",prop:"status"}},[a("el-switch",{model:{value:e.form.status,callback:function(t){e.$set(e.form,"status",t)},expression:"form.status"}})],1)],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"备注说明",prop:"remark"}},[a("el-input",{attrs:{type:"textarea",rows:3,placeholder:"请输入备注说明"},model:{value:e.form.remark,callback:function(t){e.$set(e.form,"remark",t)},expression:"form.remark"}})],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:e.handleClose}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary",loading:e.submitLoading},on:{click:e.handleSubmit}},[e._v("确 定")])],1)],1)}),[],!1,null,"29b028a5",null);t.default=c.exports},ecf1:function(e,t,a){"use strict";a("4f09")},ff60:function(e,t,a){"use strict";a.r(t);var r=(a("8615"),a("c7eb")),s=(a("96cf"),a("1da1")),l=a("ade3"),i=(a("456d"),a("ac6a"),a("7e1e")),n=a("a9b1"),o=a("b54a3"),c={name:"printTemplate",dicts:["templateType","businessType"],components:{EditDialog:n.default,Designer:o.a},data:function(){return{searchForm:{templateName:"",templateCode:"",templateType:"",businessType:"",status:""},tableList:[],total:0,currentPage:1,pageSize:10,listLoading:!0,showAdvanced:!1,dialogFormVisible:!1,dialogVisible1:!1,dialogStatus:"",selection:[],dataForm:{},template:{}}},methods:{dayinForm:function(){this.dialogVisible1=!0},closeDialog:function(){this.dialogVisible1=!1},getStatusType:function(e){return{"运行中":"success","停机":"warning","故障":"danger","离线":"info"}[e]||"info"},searchData:function(){var e=this,t={query:{$and:[]}};return Object.keys(this.searchForm).forEach((function(a){e.searchForm[a]&&t.query.$and.push(Object(l.a)({},a,{$regex:e.searchForm[a],$options:"i"}))})),t.query.$and.length||delete t.query.$and,t},fetchData:function(){var e=Object(s.a)(Object(r.a)().mark((function e(){var t,a;return Object(r.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.listLoading=!0,e.prev=1,(t=this.searchData()).skip=(this.currentPage-1)*this.pageSize,t.limit=this.pageSize,t.count=!0,e.next=8,Object(i.b)("printTemplate",t);case 8:a=e.sent,this.tableList=a.data,this.total=a.countnum,e.next=17;break;case 13:e.prev=13,e.t0=e.catch(1),console.error("获取数据失败:",e.t0),this.$message.error("获取数据失败");case 17:return e.prev=17,this.listLoading=!1,e.finish(17);case 20:case"end":return e.stop()}}),e,this,[[1,13,17,20]])})));return function(){return e.apply(this,arguments)}}(),formatDate:function(e){return e?new Date(e).toLocaleString():"暂无数据"},resetForm:function(){var e=this;this.searchForm={templateName:"",templateCode:"",templateType:"",businessType:"",status:""},this.$nextTick((function(){e.$refs.searchForm.resetFields()})),this.currentPage=1,this.pageSize=10,this.fetchData()},search:function(){this.currentPage=1,this.fetchData()},handleAdd:function(){this.dialogStatus="create",this.dataForm={},this.dialogFormVisible=!0},handleEdit:function(){var e=Object(s.a)(Object(r.a)().mark((function e(t){var a;return Object(r.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.dialogStatus="edit",e.next=3,Object(i.b)("printTemplate",{query:{_id:t._id}});case 3:a=e.sent,this.dataForm=JSON.parse(JSON.stringify(a.data[0])),this.dialogFormVisible=!0;case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),handleDelete:function(e){var t=this;this.$confirm("确认删除该打印模板吗?","提示",{type:"warning"}).then(Object(s.a)(Object(r.a)().mark((function a(){return Object(r.a)().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,Object(i.c)("printTemplate",{query:{_id:e._id}});case 3:t.$message.success("删除成功"),t.fetchData(),a.next=11;break;case 7:a.prev=7,a.t0=a.catch(0),console.error("删除失败:",a.t0),t.$message.error("删除失败");case 11:case"end":return a.stop()}}),a,null,[[0,7]])})))).catch((function(){}))},handleBatchDelete:function(){var e=this;this.selection.length?this.$confirm("确认删除选中的 ".concat(this.selection.length," 条记录吗？"),"提示",{type:"warning"}).then(Object(s.a)(Object(r.a)().mark((function t(){var a;return Object(r.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,a=e.selection.map((function(e){return e._id})),t.next=4,Object(i.c)("machine",{query:{_id:{$in:a}}});case 4:e.$message.success("批量删除成功"),e.fetchData(),t.next=12;break;case 8:t.prev=8,t.t0=t.catch(0),console.error("批量删除失败:",t.t0),e.$message.error("批量删除失败");case 12:case"end":return t.stop()}}),t,null,[[0,8]])})))).catch((function(){})):this.$message.warning("请选择要删除的记录")},handleSubmit:function(){var e=Object(s.a)(Object(r.a)().mark((function e(t){return Object(r.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,"create"!==this.dialogStatus){e.next=7;break}return e.next=4,Object(i.a)("printTemplate",t);case 4:this.$message.success("添加成功"),e.next=10;break;case 7:return e.next=9,Object(i.d)("printTemplate",{query:{_id:t._id},update:t});case 9:this.$message.success("更新成功");case 10:this.fetchData(),e.next=17;break;case 13:e.prev=13,e.t0=e.catch(0),console.error("操作失败:",e.t0),this.$message.error("操作失败");case 17:case"end":return e.stop()}}),e,this,[[0,13]])})));return function(t){return e.apply(this,arguments)}}(),handleSelectionChange:function(e){this.selection=e},baseTableHandleCurrentChange:function(e){this.currentPage=e,this.fetchData()},baseTableHandleSizeChange:function(e){this.pageSize=e,this.fetchData()},toggleAdvanced:function(){this.showAdvanced=!this.showAdvanced},exportData:function(){var e=this,t=this.tableList,r={templateName:"模板名称",templateCode:"模板编号",templateType:"模板类型",businessType:"业务类型",paperSize:"纸张大小",orientation:"打印方向",version:"版本号",isDefault:"是否默认",status:"状态",createTime:"创建时间"},s=t.map((function(t){var a={};for(var s in r)a[r[s]]="createTime"===s?e.formatDate(t[s]):t[s];return a}));Promise.all([a.e("chunk-aa6495fe"),a.e("chunk-5837544a")]).then(a.bind(null,"4bf8d")).then((function(e){e.export_json_to_excel({header:Object.values(r),data:s.map((function(e){return Object.values(e)})),filename:"打印模板列表",autoWidth:!0,bookType:"xlsx"})}))},onDesigned:function(e){console.log(e)}},created:function(){this.fetchData()}},u=c,p=(a("5a03"),a("2877")),m=Object(p.a)(u,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("el-card",{staticClass:"filter-container"},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",[e._v("筛选搜索")]),e._v(" "),a("el-button",{staticStyle:{float:"right",padding:"3px 0"},attrs:{type:"text"},on:{click:e.toggleAdvanced}},[e._v("\n                "+e._s(e.showAdvanced?"收起":"展开")+"高级搜索\n            ")])],1),e._v(" "),a("el-form",{ref:"searchForm",staticClass:"demo-form-inline",attrs:{model:e.searchForm}},[a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"模板名称"}},[a("el-input",{attrs:{placeholder:"请输入模板名称",clearable:""},model:{value:e.searchForm.templateName,callback:function(t){e.$set(e.searchForm,"templateName",t)},expression:"searchForm.templateName"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"模板编号"}},[a("el-input",{attrs:{placeholder:"请输入模板编号",clearable:""},model:{value:e.searchForm.templateCode,callback:function(t){e.$set(e.searchForm,"templateCode",t)},expression:"searchForm.templateCode"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"模板类型"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择模板类型",clearable:""},model:{value:e.searchForm.templateType,callback:function(t){e.$set(e.searchForm,"templateType",t)},expression:"searchForm.templateType"}},e._l(e.dict.type.templateType,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)],1)],1),e._v(" "),a("el-row",{directives:[{name:"show",rawName:"v-show",value:e.showAdvanced,expression:"showAdvanced"}],attrs:{gutter:20}},[a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"业务类型"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择业务类型",clearable:""},model:{value:e.searchForm.businessType,callback:function(t){e.$set(e.searchForm,"businessType",t)},expression:"searchForm.businessType"}},e._l(e.dict.type.businessType,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)],1),e._v(" "),a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"状态"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择状态",clearable:""},model:{value:e.searchForm.status,callback:function(t){e.$set(e.searchForm,"status",t)},expression:"searchForm.status"}},[a("el-option",{attrs:{label:"启用",value:!0}}),e._v(" "),a("el-option",{attrs:{label:"禁用",value:!1}})],1)],1)],1)],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:e.search}},[e._v("查询搜索")]),e._v(" "),a("el-button",{on:{click:e.resetForm}},[e._v("重置")]),e._v(" "),a("el-button",{attrs:{type:"success"},on:{click:e.exportData}},[e._v("导出数据")]),e._v(" "),a("el-button",{attrs:{type:"primary",icon:"el-icon-plus"},on:{click:e.handleAdd}},[e._v("新增模板")]),e._v(" "),a("el-button",{attrs:{type:"danger",icon:"el-icon-delete",disabled:!e.selection.length},on:{click:e.handleBatchDelete}},[e._v("\n                    批量删除\n                ")])],1)],1)],1),e._v(" "),e._m(0),e._v(" "),a("base-table",{ref:"baseTable",attrs:{currentPage:e.currentPage,"highlight-current-row":!0,pageSize:e.pageSize,tableData:e.tableList,tableDataloading:e.listLoading,total:e.total},on:{"selection-change":e.handleSelectionChange,handleCurrentChange:e.baseTableHandleCurrentChange,handleSizeChange:e.baseTableHandleSizeChange}},[a("template",{slot:"law"},[a("el-table-column",{attrs:{label:"模板名称",prop:"templateName"}}),e._v(" "),a("el-table-column",{attrs:{label:"模板编号",prop:"templateCode"}}),e._v(" "),a("el-table-column",{attrs:{label:"模板类型",prop:"templateType"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tag",[e._v(e._s(t.row.templateType))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"业务类型",prop:"businessType"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tag",{attrs:{type:"warning"}},[e._v(e._s(t.row.businessType))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"纸张大小",prop:"config.paperSize"}}),e._v(" "),a("el-table-column",{attrs:{label:"打印方向",prop:"config.orientation"}}),e._v(" "),a("el-table-column",{attrs:{label:"版本号",prop:"version",width:"100"}}),e._v(" "),a("el-table-column",{attrs:{label:"是否默认",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tag",{attrs:{type:t.row.isDefault?"success":"info"}},[e._v("\n                        "+e._s(t.row.isDefault?"是":"否")+"\n                    ")])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"状态",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tag",{attrs:{type:t.row.status?"success":"danger"}},[e._v("\n                        "+e._s(t.row.status?"启用":"禁用")+"\n                    ")])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"创建时间",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                    "+e._s(e.formatDate(t.row.createAt))+"\n                ")]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"操作",width:"200",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){return e.handleEdit(t.row)}}},[a("i",{staticClass:"el-icon-edit"}),e._v(" 编辑\n                    ")]),e._v(" "),a("el-button",{staticClass:"delete-btn",attrs:{type:"text",size:"small"},on:{click:function(a){return e.handleDelete(t.row)}}},[a("i",{staticClass:"el-icon-delete"}),e._v(" 删除\n                    ")])]}}])})],1)],2),e._v(" "),a("edit-dialog",{attrs:{visible:e.dialogFormVisible,"dialog-status":e.dialogStatus,"row-data":e.dataForm},on:{"update:visible":function(t){e.dialogFormVisible=t},submit:e.handleSubmit}}),e._v(" "),a("el-dialog",{attrs:{title:"打印模板",visible:e.dialogVisible1,fullscreen:""},on:{close:e.closeDialog}},[a("Designer",{staticStyle:{height:"80vh"},attrs:{autoConnect:"",template:e.template},on:{onDesigned:e.onDesigned}})],1)],1)}),[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"screen1"},[a("div",{staticClass:"screen_content"},[a("div",{staticClass:"screen_content_first"},[a("i",{staticClass:"el-icon-tickets"},[e._v("打印模板列表")])])])])}],!1,null,"13dcf988",null);t.default=m.exports}}]);