(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-5188e534","chunk-2d215d10"],{"1aa1":function(e,t,a){"use strict";a.r(t);var r=(a("a481"),a("7f7f"),a("6762"),a("2fdb"),a("c7eb")),n=(a("96cf"),a("1da1")),o=(a("7514"),a("3452"),a("c08e"));function i(e){return e?(("string"==typeof e||"number"==typeof e)&&(e=new Date(e)),console.log(e),e.getFullYear()+"-"+(e.getMonth()+1)+"-"+(e.getDate()<10?"0"+e.getDate():e.getDate())+" "+(e.getHours()<10?"0"+e.getHours():e.getHours())+":"+(e.getMinutes()<10?"0"+e.getMinutes():e.getMinutes())+":"+(e.getSeconds()<10?"0"+e.getSeconds():e.getSeconds())):""}a("6b54");var s={name:"ProductionOrder",data:function(){return{modelName:"PRD_MO",model:null,searchForm:{FBillNo:"",FDocumentStatus:"",FDate:[],FMaterialId:"",FWorkShopID0:"",FProductType:"",FPlanStartDate:"",FPlanFinishDate:""},showAdvanced:!1,tableData:[],loading:!1,page:{current:1,size:10,total:0},orgList:[],workshopList:[]}},created:function(){this.init(),this.getList(),this.getOrgList(),this.getWorkshopList()},methods:{init:function(){var e=this;this.model=o.find((function(t){return t.modelName===e.modelName}))},getList:function(){var e=Object(n.a)(Object(r.a)().mark((function e(){var t,a=this;return Object(r.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.loading=!0,e.prev=1,e.next=4,this.$requestK3Data({modelName:"PRD_MO",method:"BillQuery",methodData:{FormId:"PRD_MO",FieldKeys:this.getFieldKeys(),FilterString:this.getFilterString(),OrderString:"",TopRowCount:this.page.size,StartRow:(this.page.current-1)*this.page.size,Limit:this.page.size}});case 4:t=e.sent,this.tableData=t.data.map((function(e){return a.convertArrayToObject(e)})),this.page.total=t.total,e.next=13;break;case 9:e.prev=9,e.t0=e.catch(1),console.error(e.t0),this.$message.error("获取数据失败");case 13:this.loading=!1;case 14:case"end":return e.stop()}}),e,this,[[1,9]])})));return function(){return e.apply(this,arguments)}}(),getFieldKeys:function(){return this.model.header.map((function(e){return e.name.includes("_")?e.name.replace("_","."):e.name})).join(",")},getFilterString:function(){var e=[];return this.searchForm.FBillNo&&e.push("FBillNo like '%".concat(this.searchForm.FBillNo,"%'")),this.searchForm.FDocumentStatus&&e.push("FDocumentStatus = '".concat(this.searchForm.FDocumentStatus,"'")),this.searchForm.FDate&&2===this.searchForm.FDate.length&&(e.push("FDate >= '".concat(i(this.searchForm.FDate[0]),"'")),e.push("FDate <= '".concat(i(this.searchForm.FDate[1]),"'"))),this.searchForm.FMaterialId&&e.push("FMaterialId = '".concat(this.searchForm.FMaterialId,"'")),this.searchForm.FProductType&&e.push("FProductType = '".concat(this.searchForm.FProductType,"'")),this.searchForm.FPlanStartDate&&e.push("FPlanStartDate >= '".concat(i(this.searchForm.FPlanStartDate),"'")),this.searchForm.FPlanFinishDate&&e.push("FPlanFinishDate <= '".concat(i(this.searchForm.FPlanFinishDate),"'")),e.join(" and ")},getOrgList:function(){var e=Object(n.a)(Object(r.a)().mark((function e(){return Object(r.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),getWorkshopList:function(){var e=Object(n.a)(Object(r.a)().mark((function e(){return Object(r.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),handleSearch:function(){this.page.current=1,this.getList()},resetForm:function(){this.$refs.searchForm.resetFields(),this.handleSearch()},handleAdd:function(){this.$router.push("/production/order/add")},handleEdit:function(e){this.$router.push("/production/order/edit/".concat(e.FID))},handleView:function(e){this.$router.push("/production/order/view/".concat(e.FID))},handleDelete:function(e){this.$confirm("确认删除该生产订单?","提示",{type:"warning"}).then((function(){}))},handleSizeChange:function(e){this.page.size=e,this.getList()},handleCurrentChange:function(e){this.page.current=e,this.getList()},formatDate:i,getStatusType:function(e){return{DRAFT:"info",APPROVED:"success",CLOSED:"warning"}[e]||"info"},getStatusText:function(e){return{DRAFT:"草稿",APPROVED:"已审核",CLOSED:"已关闭"}[e]||e},toggleAdvanced:function(){this.showAdvanced=!this.showAdvanced},convertArrayToObject:function(e){return this.model.header.reduce((function(t,a,r){return t[a.name]=e[r],t}),{})}}},l=s,c=(a("f8a6"),a("2877")),u=Object(c.a)(l,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("el-card",{staticClass:"filter-container"},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",[e._v("筛选搜索")]),e._v(" "),a("el-button",{staticStyle:{float:"right",padding:"3px 0"},attrs:{type:"text"},on:{click:e.toggleAdvanced}},[e._v("\n                "+e._s(e.showAdvanced?"收起":"展开")+"高级搜索\n            ")])],1),e._v(" "),a("el-form",{ref:"searchForm",staticClass:"demo-form-inline",attrs:{model:e.searchForm}},[a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"单据编号"}},[a("el-input",{attrs:{placeholder:"请输入单据编号",clearable:""},model:{value:e.searchForm.FBillNo,callback:function(t){e.$set(e.searchForm,"FBillNo",t)},expression:"searchForm.FBillNo"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"单据状态"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择单据状态",clearable:""},model:{value:e.searchForm.FDocumentStatus,callback:function(t){e.$set(e.searchForm,"FDocumentStatus",t)},expression:"searchForm.FDocumentStatus"}},[a("el-option",{attrs:{label:"草稿",value:"DRAFT"}}),e._v(" "),a("el-option",{attrs:{label:"已审核",value:"APPROVED"}}),e._v(" "),a("el-option",{attrs:{label:"已关闭",value:"CLOSED"}})],1)],1)],1),e._v(" "),a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"单据日期"}},[a("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期"},model:{value:e.searchForm.FDate,callback:function(t){e.$set(e.searchForm,"FDate",t)},expression:"searchForm.FDate"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"物料编码"}},[a("el-input",{attrs:{placeholder:"请输入物料编码",clearable:""},model:{value:e.searchForm.FMaterialId,callback:function(t){e.$set(e.searchForm,"FMaterialId",t)},expression:"searchForm.FMaterialId"}})],1)],1)],1),e._v(" "),a("el-collapse-transition",[a("div",{directives:[{name:"show",rawName:"v-show",value:e.showAdvanced,expression:"showAdvanced"}]},[a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"生产车间"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择生产车间",clearable:""},model:{value:e.searchForm.FWorkShopID0,callback:function(t){e.$set(e.searchForm,"FWorkShopID0",t)},expression:"searchForm.FWorkShopID0"}},e._l(e.workshopList,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)],1),e._v(" "),a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"产品类型"}},[a("el-input",{attrs:{placeholder:"请输入产品类型",clearable:""},model:{value:e.searchForm.FProductType,callback:function(t){e.$set(e.searchForm,"FProductType",t)},expression:"searchForm.FProductType"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"计划开工时间"}},[a("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"date",placeholder:"选择开工时间"},model:{value:e.searchForm.FPlanStartDate,callback:function(t){e.$set(e.searchForm,"FPlanStartDate",t)},expression:"searchForm.FPlanStartDate"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"计划完工时间"}},[a("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"date",placeholder:"选择完工时间"},model:{value:e.searchForm.FPlanFinishDate,callback:function(t){e.$set(e.searchForm,"FPlanFinishDate",t)},expression:"searchForm.FPlanFinishDate"}})],1)],1)],1)],1)]),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:e.handleSearch}},[e._v("查询")]),e._v(" "),a("el-button",{on:{click:e.resetForm}},[e._v("重置")]),e._v(" "),a("el-button",{attrs:{type:"success"},on:{click:e.handleAdd}},[e._v("新增订单")])],1)],1)],1),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%","margin-top":"20px"},attrs:{data:e.tableData,border:""}},[a("el-table-column",{attrs:{prop:"FBillNo",label:"单据编号",width:"150"}}),e._v(" "),a("el-table-column",{attrs:{prop:"FDocumentStatus",label:"单据状态",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tag",{attrs:{type:e.getStatusType(t.row.FDocumentStatus)}},[e._v("\n                    "+e._s(e.getStatusText(t.row.FDocumentStatus))+"\n                ")])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"FDate",label:"单据日期",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                "+e._s(e.formatDate(t.row.FDate))+"\n            ")]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"FMaterialId",label:"物料编码",width:"120"}}),e._v(" "),a("el-table-column",{attrs:{prop:"FMaterialName",label:"物料名称",width:"150"}}),e._v(" "),a("el-table-column",{attrs:{prop:"FSpecification",label:"规格型号",width:"120"}}),e._v(" "),a("el-table-column",{attrs:{prop:"FProductType",label:"产品类型",width:"120"}}),e._v(" "),a("el-table-column",{attrs:{prop:"FQty",label:"数量",width:"100"}}),e._v(" "),a("el-table-column",{attrs:{prop:"FUnitId",label:"单位",width:"80"}}),e._v(" "),a("el-table-column",{attrs:{prop:"FWorkShopID_FName",label:"生产车间",width:"120"}}),e._v(" "),a("el-table-column",{attrs:{prop:"FPlanStartDate",label:"计划开工时间",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                "+e._s(e.formatDate(t.row.FPlanStartDate))+"\n            ")]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"FPlanFinishDate",label:"计划完工时间",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                "+e._s(e.formatDate(t.row.FPlanFinishDate))+"\n            ")]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"操作",width:"150",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(a){return e.handleEdit(t.row)}}},[e._v("编辑")]),e._v(" "),a("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(a){return e.handleView(t.row)}}},[e._v("查看")]),e._v(" "),"DRAFT"===t.row.FDocumentStatus?a("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(a){return e.handleDelete(t.row)}}},[e._v("删除")]):e._e()]}}])})],1),e._v(" "),a("el-pagination",{staticStyle:{"margin-top":"20px"},attrs:{"current-page":e.page.current,"page-sizes":[10,20,50,100],"page-size":e.page.size,layout:"total, sizes, prev, pager, next, jumper",total:e.page.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)}),[],!1,null,"82b7d234",null);t.default=u.exports},3:function(e,t){},"346f":function(e,t,a){},c08e:function(e){e.exports=[{modelName:"PRD_MO",description:"生产订单",header:[{name:"FID",type:"number",description:"实体主键",required:!1},{name:"FBillNo",type:"string",description:"单据编号",required:!1},{name:"FDocumentStatus",type:"string",description:"单据状态",required:!1},{name:"FApproverId",type:"string",description:"审核人",required:!1},{name:"FApproveDate",type:"date",description:"审核日期",required:!1},{name:"FDate",type:"date",description:"单据日期",required:!0},{name:"FWorkShopID_FName",type:"string",description:"生产车间",required:!1},{name:"FMaterialId",type:"string",description:"物料编码",required:!0},{name:"FMaterialName",type:"string",description:"物料名称",required:!1},{name:"FSpecification",type:"string",description:"规格型号",required:!1},{name:"FProductType",type:"string",description:"产品类型",required:!0},{name:"FUnitId",type:"string",description:"单位",required:!0},{name:"FQty",type:"number",description:"数量",required:!0},{name:"FPlanStartDate",type:"date",description:"计划开工时间",required:!0},{name:"FPlanFinishDate",type:"date",description:"计划完工时间",required:!0}]}]},f8a6:function(e,t,a){"use strict";a("346f")}}]);