(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-d2031888","chunk-2da4d1b6","chunk-4c3a0513","chunk-1dfc4160","chunk-3ae1522c","chunk-1a8c93c0","chunk-2d222794","chunk-2d210bd0"],{"0457":function(t,e,a){},"134f":function(t,e,a){"use strict";a("f07a")},2268:function(t,e,a){"use strict";a("7059")},"29a2":function(t,e,a){},"2b38":function(t,e,a){},"316f":function(t,e,a){"use strict";a("0457")},3620:function(t,e,a){"use strict";a.r(e);var s=(a("7514"),a("c7eb")),r=(a("5df3"),a("f400"),a("ac6a"),a("2909")),i=(a("6762"),a("2fdb"),a("96cf"),a("1da1")),n=a("7e1e"),l={name:"AgentSelect",props:{value:{type:Array,default:function(){return[]}}},data:function(){return{loading:!1,agents:[],selectedAgents:this.value}},watch:{value:{handler:function(t){this.selectedAgents=t,t&&t.length&&!this.agents.length&&this.fetchAgentsByIds(t)},immediate:!0}},methods:{getAgentLabel:function(t){return"".concat(t.nickName).concat(t.company?" - ".concat(t.company):"")},remoteSearch:function(){var t=Object(i.a)(Object(s.a)().mark((function t(e){var a,i,l=this;return Object(s.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(""===e){t.next=15;break}return this.loading=!0,t.prev=2,t.next=5,Object(n.b)("user_login",{query:JSON.stringify({$or:[{nickName:{$regex:e,$options:"i"}},{phone:{$regex:e,$options:"i"}}],roles:{$elemMatch:{label:"Agent"}}}),limit:20});case 5:a=t.sent,i=this.agents.filter((function(t){return l.selectedAgents.includes(t._id)})),this.agents=Object(r.a)(new Map([].concat(Object(r.a)(i),Object(r.a)(a.data)).map((function(t){return[t._id,t]}))).values()),t.next=14;break;case 10:t.prev=10,t.t0=t.catch(2),console.error("æœç´¢ç»çºªäººå¤±è´¥:",t.t0),this.$message.error("æœç´¢ç»çºªäººå¤±è´¥");case 14:this.loading=!1;case 15:case"end":return t.stop()}}),t,this,[[2,10]])})));return function(e){return t.apply(this,arguments)}}(),handleChange:function(t){this.$emit("input",t);var e=this.agents.filter((function(e){return t.includes(e._id)}));this.$emit("select",e)},fetchAgentsByIds:function(){var t=Object(i.a)(Object(s.a)().mark((function t(e){var a,i;return Object(s.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.length){t.next=2;break}return t.abrupt("return");case 2:return t.prev=2,t.next=5,Object(n.b)("user_login",{query:JSON.stringify({_id:{$in:e}})});case 5:(a=t.sent).data&&a.data.length>0&&(i=this.agents.filter((function(t){return!a.data.find((function(e){return e._id===t._id}))})),this.agents=[].concat(Object(r.a)(i),Object(r.a)(a.data))),t.next=12;break;case 9:t.prev=9,t.t0=t.catch(2),console.error("è·å–ç»çºªäººä¿¡æ¯å¤±è´¥:",t.t0);case 12:case"end":return t.stop()}}),t,this,[[2,9]])})));return function(e){return t.apply(this,arguments)}}()}},c=l,o=(a("cd7c"),a("2877")),u=Object(o.a)(c,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-select",{attrs:{multiple:"",filterable:"",remote:"","reserve-keyword":"",placeholder:"è¯·è¾“å…¥ç»çºªäººåç§°æœç´¢","remote-method":t.remoteSearch,loading:t.loading,clearable:"","collapse-tags":""},on:{change:t.handleChange},model:{value:t.selectedAgents,callback:function(e){t.selectedAgents=e},expression:"selectedAgents"}},t._l(t.agents,(function(e){return a("el-option",{key:e._id,attrs:{label:t.getAgentLabel(e),value:e._id}},[a("div",{staticClass:"agent-option"},[a("div",{staticClass:"agent-info"},[a("span",{staticClass:"name"},[t._v(t._s(e.nickName))]),t._v(" "),a("el-tag",{attrs:{size:"mini",type:"info"}},[t._v(t._s(e.phone))])],1),t._v(" "),e.company?a("div",{staticClass:"company-info"},[a("small",[t._v(t._s(e.company))])]):t._e()])])})),1)}),[],!1,null,"5be86ef0",null);e.default=u.exports},"3e48":function(t,e,a){"use strict";a.r(e);var s=a("c466"),r={name:"TaskClaimDetails",props:{visible:{type:Boolean,default:!1},details:{type:Object,default:function(){return{}}}},data:function(){return{isTimelineExpanded:!1}},methods:{handleClose:function(){this.$emit("update:visible",!1)},formatDate:function(t){return Object(s.a)(t,"yyyy-MM-dd HH:mm")},formatNumber:function(t){return Object(s.b)(t)},getClaimStatusType:function(t){return{"å¾…å®¡æ ¸":"warning","å·²é€šè¿‡":"success","å·²æ‹’ç»":"danger"}[t]||"info"},getProgressStatusType:function(t){return{"æœªå¼€å§‹":"info","æ²Ÿé€šä¸­":"warning","åˆä½œæˆåŠŸ":"success","å¯„é€æ ·å“":"primary","æ ·å“è·Ÿè¸ª":"primary","å·²æ”¶è´§":"success","å†…å®¹åˆ¶ä½œä¸­":"primary","ä½œå“å·²å‘å¸ƒ":"success","æ•°æ®ç»Ÿè®¡ä¸­":"warning","å·²å®Œæˆ":"success","å·²å–æ¶ˆ":"danger","åˆä½œå¤±è´¥":"danger"}[t]||"info"},getTimelineItemType:function(t){return{"æœªå¼€å§‹":"info","æ²Ÿé€šä¸­":"warning","æ‰§è¡Œä¸­":"primary","å·²å®Œæˆ":"success","å·²å–æ¶ˆ":"danger"}[t]||"info"}}},i=r,n=(a("2268"),a("2877")),l=Object(n.a)(i,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-dialog",{attrs:{title:"ä»»åŠ¡è¯¦æƒ…",visible:t.visible,width:"70%","close-on-click-modal":!1,"custom-class":"claim-details-dialog","append-to-body":""},on:{"update:visible":function(e){t.visible=e},close:t.handleClose}},[a("div",{staticClass:"claim-details"},[a("div",{staticClass:"detail-section"},[a("div",{staticClass:"section-title"},[t._v("åŸºæœ¬ä¿¡æ¯")]),t._v(" "),a("div",{staticClass:"info-grid"},[a("div",{staticClass:"info-item"},[a("div",{staticClass:"info-label"},[t._v("ç»çºªäºº")]),t._v(" "),a("div",{staticClass:"info-content"},[t._v(t._s(t.details.agentName))])]),t._v(" "),a("div",{staticClass:"info-item"},[a("div",{staticClass:"info-label"},[t._v("å…³è”è¾¾äºº")]),t._v(" "),a("div",{staticClass:"info-content"},[t._v(t._s(t.details.expertName))])]),t._v(" "),a("div",{staticClass:"info-item"},[a("div",{staticClass:"info-label"},[t._v("è®¤é¢†çŠ¶æ€")]),t._v(" "),a("div",{staticClass:"info-content"},[a("el-tag",{attrs:{type:t.getClaimStatusType(t.details.claimStatus)}},[t._v("\n              "+t._s(t.details.claimStatus)+"\n            ")])],1)]),t._v(" "),a("div",{staticClass:"info-item"},[a("div",{staticClass:"info-label"},[t._v("è®¤é¢†æ—¶é—´")]),t._v(" "),a("div",{staticClass:"info-content"},[t._v(t._s(t.formatDate(t.details.claimTime)))])]),t._v(" "),a("div",{staticClass:"info-item full-width"},[a("div",{staticClass:"info-label"},[t._v("è®¤é¢†è¯´æ˜")]),t._v(" "),a("div",{staticClass:"info-content"},[t._v(t._s(t.details.remark||"æ— "))])])])]),t._v(" "),a("div",{staticClass:"detail-section"},[a("div",{staticClass:"section-title",staticStyle:{display:"flex","justify-content":"space-between","align-items":"center"}},[a("span",[t._v("è¿›åº¦è®°å½•")]),t._v(" "),a("el-button",{attrs:{type:"text"},on:{click:function(e){t.isTimelineExpanded=!t.isTimelineExpanded}}},[t._v("\n          "+t._s(t.isTimelineExpanded?"æ”¶èµ·":"å±•å¼€")+"\n          "),a("i",{class:t.isTimelineExpanded?"el-icon-arrow-up":"el-icon-arrow-down"})])],1),t._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:t.isTimelineExpanded,expression:"isTimelineExpanded"}],staticClass:"progress-timeline"},[a("el-timeline",t._l(t.details.progressSteps,(function(e,s){return a("el-timeline-item",{key:s,attrs:{timestamp:t.formatDate(e.updateTime),type:t.getTimelineItemType(e.status)}},[a("div",{staticClass:"progress-item"},[a("div",{staticClass:"progress-header"},[a("el-tag",{attrs:{type:t.getProgressStatusType(e.status),size:"small"}},[t._v("\n                  "+t._s(e.status)+"\n                ")]),t._v(" "),a("span",{staticClass:"progress-step"},[t._v(t._s(e.step))])],1),t._v(" "),e.remark?a("div",{staticClass:"progress-remark"},[t._v("\n                "+t._s(e.remark)+"\n              ")]):t._e()])])})),1)],1)]),t._v(" "),t.details.result&&t.details.result.contentList?a("div",{staticClass:"detail-section"},[a("div",{staticClass:"section-title"},[t._v("æ‰§è¡Œç»“æœ")]),t._v(" "),a("div",{staticClass:"result-section"},[a("div",{staticClass:"sub-title"},[t._v("å†…å®¹åˆ—è¡¨")]),t._v(" "),a("el-table",{staticStyle:{width:"100%","margin-bottom":"20px"},attrs:{data:t.details.result.contentList,border:"",size:"small"}},[a("el-table-column",{attrs:{label:"å¹³å°",prop:"platform",width:"120"}}),t._v(" "),a("el-table-column",{attrs:{label:"ç±»å‹",prop:"type",width:"120"}}),t._v(" "),a("el-table-column",{attrs:{label:"å‘å¸ƒæ—¶é—´",width:"160"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n              "+t._s(t.formatDate(e.row.publishTime))+"\n            ")]}}],null,!1,2436397959)}),t._v(" "),a("el-table-column",{attrs:{label:"é“¾æ¥"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-link",{attrs:{type:"primary",href:e.row.link,target:"_blank"}},[t._v("\n                "+t._s(e.row.link)+"\n              ")])]}}],null,!1,422598859)}),t._v(" "),a("el-table-column",{attrs:{label:"è§†é¢‘ä»£ç ",width:"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.videoCode?a("span",[t._v(t._s(e.row.videoCode))]):a("span",[t._v("-")])]}}],null,!1,2314334044)}),t._v(" "),a("el-table-column",{attrs:{label:"å†…å®¹æ•ˆæœæ•°æ®"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{staticClass:"performance-data"},[a("div",{staticClass:"data-item",staticStyle:{display:"flex","align-items":"center"}},[a("i",{staticClass:"el-icon-video-play"}),t._v(" "),a("div",{staticClass:"data-label"},[t._v("æ’­æ”¾é‡")]),t._v(" "),a("div",{staticClass:"data-value"},[t._v("\n                    "+t._s(t.formatNumber(e.row.performanceData.views))+"\n                  ")])]),t._v(" "),a("div",{staticClass:"data-item",staticStyle:{display:"flex","align-items":"center"}},[a("i",{staticClass:"el-icon-star-on"}),t._v(" "),a("div",{staticClass:"data-label"},[t._v("ç‚¹èµæ•°")]),t._v(" "),a("div",{staticClass:"data-value"},[t._v("\n                    "+t._s(t.formatNumber(e.row.performanceData.likes))+"\n                  ")])]),t._v(" "),a("div",{staticClass:"data-item",staticStyle:{display:"flex","align-items":"center"}},[a("i",{staticClass:"el-icon-chat-dot-round"}),t._v(" "),a("div",{staticClass:"data-label"},[t._v("è¯„è®ºæ•°")]),t._v(" "),a("div",{staticClass:"data-value"},[t._v("\n                    "+t._s(t.formatNumber(e.row.performanceData.comments||0))+"\n                  ")])]),t._v(" "),a("div",{staticClass:"data-item",staticStyle:{display:"flex","align-items":"center"}},[a("i",{staticClass:"el-icon-share"}),t._v(" "),a("div",{staticClass:"data-label"},[t._v("æ€»åˆ†äº«æ•°")]),t._v(" "),a("div",{staticClass:"data-value"},[t._v("\n                    "+t._s(t.formatNumber(e.row.performanceData.shares||0))+"\n                  ")])]),t._v(" "),a("div",{staticClass:"data-item",staticStyle:{display:"flex","align-items":"center"}},[a("i",{staticClass:"el-icon-money"}),t._v(" "),a("div",{staticClass:"data-label"},[t._v("è§†é¢‘GMV")]),t._v(" "),a("div",{staticClass:"data-value"},[t._v("\n                    "+t._s(t.formatNumber(e.row.performanceData.videoGmv||0))+"\n                  ")])]),t._v(" "),a("div",{staticClass:"data-item",staticStyle:{display:"flex","align-items":"center"}},[a("i",{staticClass:"el-icon-money"}),t._v(" "),a("div",{staticClass:"data-label"},[t._v("ç›´æ’­GMV")]),t._v(" "),a("div",{staticClass:"data-value"},[t._v("\n                    "+t._s(t.formatNumber(e.row.performanceData.liveGmv||0))+"\n                  ")])])])]}}],null,!1,3232213187)})],1)],1),t._v(" "),a("div",{staticClass:"result-section"},[a("div",{staticClass:"sub-title"},[t._v("æ•ˆæœæ•°æ®")]),t._v(" "),a("div",{staticClass:"data-grid"},[a("div",{staticClass:"data-item"},[a("i",{staticClass:"el-icon-video-play"}),t._v(" "),a("div",{staticClass:"data-label"},[t._v("æ€»æ’­æ”¾é‡:")]),t._v(" "),a("div",{staticClass:"data-value"},[t._v("\n              "+t._s(t.formatNumber(t.details.result.totalPerformance.totalViews||0))+"\n            ")])]),t._v(" "),a("div",{staticClass:"data-item"},[a("i",{staticClass:"el-icon-star-on"}),t._v(" "),a("div",{staticClass:"data-label"},[t._v("æ€»ç‚¹èµæ•°:")]),t._v(" "),a("div",{staticClass:"data-value"},[t._v("\n              "+t._s(t.formatNumber(t.details.result.totalPerformance.totalLikes||0))+"\n            ")])]),t._v(" "),a("div",{staticClass:"data-item"},[a("i",{staticClass:"el-icon-chat-dot-round"}),t._v(" "),a("div",{staticClass:"data-label"},[t._v("æ€»è¯„è®ºæ•°:")]),t._v(" "),a("div",{staticClass:"data-value"},[t._v("\n              "+t._s(t.formatNumber(t.details.result.totalPerformance.totalComments||0))+"\n            ")])]),t._v(" "),a("div",{staticClass:"data-item"},[a("i",{staticClass:"el-icon-share"}),t._v(" "),a("div",{staticClass:"data-label"},[t._v("æ€»åˆ†äº«æ•°:")]),t._v(" "),a("div",{staticClass:"data-value"},[t._v("\n              "+t._s(t.formatNumber(t.details.result.totalPerformance.totalShares||0))+"\n            ")])]),t._v(" "),a("div",{staticClass:"data-item"},[a("i",{staticClass:"el-icon-money"}),t._v(" "),a("div",{staticClass:"data-label"},[t._v("æ€»è§†é¢‘GMV:")]),t._v(" "),a("div",{staticClass:"data-value"},[t._v("\n              Â¥"+t._s(t.formatNumber(t.details.result.totalPerformance.totalVideoGmv||0))+"\n            ")])]),t._v(" "),a("div",{staticClass:"data-item"},[a("i",{staticClass:"el-icon-money"}),t._v(" "),a("div",{staticClass:"data-label"},[t._v("æ€»ç›´æ’­GMV:")]),t._v(" "),a("div",{staticClass:"data-value"},[t._v("\n              Â¥"+t._s(t.formatNumber(t.details.result.totalPerformance.totalLiveGmv||0))+"\n            ")])])])])]):t._e()])])}),[],!1,null,"662b5f48",null);e.default=l.exports},5260:function(t,e,a){"use strict";a.r(e);var s=(a("7514"),a("c7eb")),r=(a("5df3"),a("f400"),a("ac6a"),a("2909")),i=(a("6762"),a("2fdb"),a("96cf"),a("1da1")),n=a("7e1e"),l={name:"ExpertSelect",props:{value:{type:Array,default:function(){return[]}}},data:function(){return{loading:!1,experts:[],selectedExperts:this.value}},watch:{value:{handler:function(t){this.selectedExperts=t,t&&t.length&&!this.experts.length&&this.fetchExpertsByIds(t)},immediate:!0}},methods:{remoteSearch:function(){var t=Object(i.a)(Object(s.a)().mark((function t(e){var a,i,l=this;return Object(s.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(""===e){t.next=15;break}return this.loading=!0,t.prev=2,t.next=5,Object(n.b)("expert",{query:JSON.stringify({nickname:{$regex:e,$options:"i"}}),limit:20});case 5:a=t.sent,i=this.experts.filter((function(t){return l.selectedExperts.includes(t._id)})),this.experts=Object(r.a)(new Map([].concat(Object(r.a)(i),Object(r.a)(a.data)).map((function(t){return[t._id,t]}))).values()),t.next=14;break;case 10:t.prev=10,t.t0=t.catch(2),console.error("æœç´¢è¾¾äººå¤±è´¥:",t.t0),this.$message.error("æœç´¢è¾¾äººå¤±è´¥");case 14:this.loading=!1;case 15:case"end":return t.stop()}}),t,this,[[2,10]])})));return function(e){return t.apply(this,arguments)}}(),handleChange:function(t){this.$emit("input",t);var e=this.experts.filter((function(e){return t.includes(e._id)}));this.$emit("select",e)},fetchExpertsByIds:function(){var t=Object(i.a)(Object(s.a)().mark((function t(e){var a,i;return Object(s.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.length){t.next=2;break}return t.abrupt("return");case 2:return t.prev=2,t.next=5,Object(n.b)("expert",{query:JSON.stringify({_id:{$in:e}})});case 5:(a=t.sent).data&&a.data.length>0&&(i=this.experts.filter((function(t){return!a.data.find((function(e){return e._id===t._id}))})),this.experts=[].concat(Object(r.a)(i),Object(r.a)(a.data))),t.next=12;break;case 9:t.prev=9,t.t0=t.catch(2),console.error("è·å–è¾¾äººä¿¡æ¯å¤±è´¥:",t.t0);case 12:case"end":return t.stop()}}),t,this,[[2,9]])})));return function(e){return t.apply(this,arguments)}}()}},c=l,o=(a("316f"),a("2877")),u=Object(o.a)(c,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-select",{attrs:{multiple:"",filterable:"",remote:"","reserve-keyword":"",placeholder:"è¯·è¾“å…¥è¾¾äººæ˜µç§°æœç´¢","remote-method":t.remoteSearch,loading:t.loading,clearable:"","collapse-tags":""},on:{change:t.handleChange},model:{value:t.selectedExperts,callback:function(e){t.selectedExperts=e},expression:"selectedExperts"}},t._l(t.experts,(function(e){return a("el-option",{key:e._id,attrs:{label:e.nickname,value:e._id}},[a("div",{staticClass:"expert-option"},[a("span",[t._v(t._s(e.nickname))]),t._v(" "),a("small",{staticClass:"platform-info"},[t._v("\n        "+t._s(e.platform)+" | "+t._s(e.mainCategory)+"\n      ")])])])})),1)}),[],!1,null,"3e1c6cf4",null);e.default=u.exports},"6c29b":function(t,e,a){"use strict";a.r(e);var s=a("c7eb"),r=(a("96cf"),a("1da1")),i=a("5530"),n=a("c466"),l=a("7e1e"),c={dicts:["expert_platform","task_type","content_type"],components:{TagInput:a("b5c9").a},name:"TaskResultDialog",props:{visible:{type:Boolean,default:!1},currentClaim:{type:Object,default:function(){return{}}},taskInfo:{type:Object,default:function(){return{}}}},data:function(){return{resultForm:{contentList:[],totalPerformance:{totalViews:0,totalLikes:0,totalComments:0,totalShares:0,totalGmv:0}},resultRules:{contentList:{type:"array",required:!0,message:"è¯·è‡³å°‘æ·»åŠ ä¸€ä¸ªå†…å®¹",trigger:"change"}},productOptions:[{value:"äº§å“1",label:"äº§å“1"},{value:"äº§å“2",label:"äº§å“2"}]}},computed:{dialogVisible:{get:function(){return this.visible},set:function(t){this.$emit("update:visible",t)}},getTotalViews:function(){return this.resultForm.contentList.reduce((function(t,e){return t+(e.performanceData&&e.performanceData.views||0)}),0)},getTotalLikes:function(){return this.resultForm.contentList.reduce((function(t,e){return t+(e.performanceData&&e.performanceData.likes||0)}),0)},getTotalComments:function(){return this.resultForm.contentList.reduce((function(t,e){return t+(e.performanceData&&e.performanceData.comments||0)}),0)},getTotalShares:function(){return this.resultForm.contentList.reduce((function(t,e){return t+(e.performanceData&&e.performanceData.shares||0)}),0)},getTotalVideoGmv:function(){return this.resultForm.contentList.reduce((function(t,e){return t+(e.performanceData&&e.performanceData.videoGmv||0)}),0)},getTotalLiveGmv:function(){return this.resultForm.contentList.reduce((function(t,e){return t+(e.performanceData&&e.performanceData.liveGmv||0)}),0)}},watch:{visible:function(t){t&&this.initForm()}},methods:{formatNumber:n.b,initForm:function(){this.resultForm={contentList:[],totalPerformance:{totalViews:0,totalLikes:0,totalComments:0,totalShares:0,totalGmv:0}},this.currentClaim.result&&this.currentClaim.result.contentList&&(this.resultForm.contentList=this.currentClaim.result.contentList.map((function(t){return Object(i.a)(Object(i.a)({},t),{},{performanceData:Object(i.a)({views:0,likes:0,comments:0,shares:0,liveGmv:0,videoGmv:0,gmv:0},t.performanceData)})})))},addContent:function(){this.resultForm.contentList.push({platform:"",type:"",link:"",videoCode:"",adCode:"",products:[],publishTime:null,performanceData:{views:0,likes:0,comments:0,shares:0,liveGmv:0,videoGmv:0,gmv:0}})},removeContent:function(t){var e=this;this.$confirm("ç¡®å®šè¦åˆ é™¤è¯¥å†…å®¹å—ï¼Ÿ","æç¤º",{confirmButtonText:"ç¡®å®š",cancelButtonText:"å–æ¶ˆ",type:"warning"}).then((function(){e.resultForm.contentList.splice(t,1)})).catch((function(){}))},handleCancel:function(){this.dialogVisible=!1},handleSubmit:function(){var t=Object(r.a)(Object(s.a)().mark((function t(){var e;return Object(s.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this.$refs.resultForm.validate();case 3:return e={totalViews:this.getTotalViews,totalLikes:this.getTotalLikes,totalComments:this.getTotalComments,totalShares:this.getTotalShares,totalGmv:this.getTotalGmv},t.next=6,Object(l.d)("taskClaim",{query:{_id:this.currentClaim._id},update:{result:{contentList:this.resultForm.contentList,totalPerformance:e},status:"æ•°æ®ç»Ÿè®¡ä¸­"}});case 6:return t.next=8,Object(l.d)("taskClaim",{query:{_id:this.currentClaim._id},update:{$push:{progressSteps:{step:"æäº¤æ‰§è¡Œç»“æœ",status:"æ•°æ®ç»Ÿè®¡ä¸­",updateTime:new Date,updatedBy:this.$store.getters.id,remark:"æäº¤äº†".concat(this.resultForm.contentList.length,"ä¸ªå†…å®¹çš„æ‰§è¡Œç»“æœ")}}}});case 8:return t.next=10,Object(l.a)("messageLog",{title:"ä»»åŠ¡ç»“æœæäº¤é€šçŸ¥",content:"ä»»åŠ¡ã€".concat(this.taskInfo.title,"ã€‘çš„æ‰§è¡Œç»“æœå·²æäº¤ï¼Œè¯·æŸ¥çœ‹"),type:"TASK_RESULT_SUBMITTED",taskId:this.currentClaim.taskId,taskClaimId:this.currentClaim._id,sender:{userId:this.$store.state.user.id,role:"TRACKER"},receivers:[{userId:this.currentClaim.agentId._id,role:"AGENT",isRead:!1},{userId:this.taskInfo.createBy,role:"ADMIN",isRead:!1}],isSystem:!1});case 10:this.$message.success("æ‰§è¡Œç»“æœæäº¤æˆåŠŸ"),this.dialogVisible=!1,this.$emit("submit-success"),t.next=19;break;case 15:t.prev=15,t.t0=t.catch(0),console.error("æäº¤æ‰§è¡Œç»“æœå¤±è´¥:",t.t0),this.$message.error("æäº¤æ‰§è¡Œç»“æœå¤±è´¥");case 19:case"end":return t.stop()}}),t,this,[[0,15]])})));return function(){return t.apply(this,arguments)}}()}},o=c,u=(a("b695"),a("2877")),m=Object(u.a)(o,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-dialog",{attrs:{title:"æäº¤æ‰§è¡Œç»“æœ",visible:t.dialogVisible,width:"70%","custom-class":"result-dialog","append-to-body":""},on:{"update:visible":function(e){t.dialogVisible=e}}},[a("el-form",{ref:"resultForm",attrs:{model:t.resultForm,rules:t.resultRules,"label-width":"100px"}},[a("div",{staticClass:"form-section"},[a("div",{staticClass:"section-title"},[a("i",{staticClass:"el-icon-video-camera"}),t._v("\n                å†…å®¹åˆ—è¡¨\n            ")]),t._v(" "),a("div",{staticClass:"content-list"},[t._l(t.resultForm.contentList,(function(e,s){return a("div",{key:s,staticClass:"content-item"},[a("div",{staticClass:"content-header"},[a("span",{staticClass:"content-index"},[t._v("å†…å®¹ #"+t._s(s+1))]),t._v(" "),a("el-button",{attrs:{type:"danger",icon:"el-icon-delete",circle:"",size:"mini"},on:{click:function(e){return t.removeContent(s)}}})],1),t._v(" "),a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"å¹³å°",prop:"contentList."+s+".platform",rules:{required:!0,message:"è¯·é€‰æ‹©å¹³å°",trigger:"change"}}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"è¯·é€‰æ‹©å¹³å°",clearable:""},model:{value:e.platform,callback:function(a){t.$set(e,"platform",a)},expression:"content.platform"}},t._l(t.dict.type.expert_platform,(function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1)],1),t._v(" "),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"ç±»å‹",prop:"contentList."+s+".type",rules:{required:!0,message:"è¯·é€‰ç±»å‹",trigger:"change"}}},[a("el-select",{attrs:{placeholder:"è¯·é€‰æ‹©å†…å®¹å½¢å¼",clearable:""},model:{value:e.type,callback:function(a){t.$set(e,"type",a)},expression:"content.type"}},t._l(t.dict.type.content_type,(function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1)],1),t._v(" "),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"å‘å¸ƒæ—¶é—´",prop:"contentList."+s+".publishTime",rules:{required:!0,message:"è¯·é€‰æ‹©å‘å¸ƒæ—¶é—´",trigger:"change"}}},[a("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"datetime",placeholder:"é€‰æ‹©å‘å¸ƒæ—¶é—´"},model:{value:e.publishTime,callback:function(a){t.$set(e,"publishTime",a)},expression:"content.publishTime"}})],1)],1)],1),t._v(" "),a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"å†…å®¹é“¾æ¥",prop:"contentList."+s+".link",rules:{required:!0,message:"è¯·è¾“å…¥å†…å®¹é“¾æ¥",trigger:"blur"}}},[a("el-input",{attrs:{placeholder:"è¯·è¾“å…¥å†…å®¹é“¾æ¥"},model:{value:e.link,callback:function(a){t.$set(e,"link",a)},expression:"content.link"}})],1)],1),t._v(" "),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"è§†é¢‘ä»£ç ",prop:"contentList."+s+".videoCode"}},[a("el-input",{attrs:{placeholder:"è¯·è¾“å…¥è§†é¢‘/ç›´æ’­ä»£ç "},model:{value:e.videoCode,callback:function(a){t.$set(e,"videoCode",a)},expression:"content.videoCode"}})],1)],1),t._v(" "),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"å¹¿å‘Šç ",prop:"contentList."+s+".adCode"}},[a("el-input",{attrs:{placeholder:"è¯·è¾“å…¥å¹¿å‘Šç "},model:{value:e.adCode,callback:function(a){t.$set(e,"adCode",a)},expression:"content.adCode"}})],1)],1)],1),t._v(" "),a("el-form-item",{attrs:{label:"å¸¦è´§äº§å“",prop:"contentList."+s+".products"}},[a("TagInput",{model:{value:e.products,callback:function(a){t.$set(e,"products",a)},expression:"content.products"}})],1),t._v(" "),a("div",{staticClass:"performance-data"},[a("div",{staticClass:"sub-title"},[t._v("æ•ˆæœæ•°æ®")]),t._v(" "),a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"æ’­æ”¾é‡",prop:"contentList."+s+".performanceData.views"}},[a("el-input-number",{attrs:{min:0,"controls-position":"right"},model:{value:e.performanceData.views,callback:function(a){t.$set(e.performanceData,"views",a)},expression:"content.performanceData.views"}})],1)],1),t._v(" "),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"ç‚¹èµæ•°",prop:"contentList."+s+".performanceData.likes"}},[a("el-input-number",{attrs:{min:0,"controls-position":"right"},model:{value:e.performanceData.likes,callback:function(a){t.$set(e.performanceData,"likes",a)},expression:"content.performanceData.likes"}})],1)],1),t._v(" "),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"è¯„è®ºæ•°",prop:"contentList."+s+".performanceData.comments"}},[a("el-input-number",{attrs:{min:0,"controls-position":"right"},model:{value:e.performanceData.comments,callback:function(a){t.$set(e.performanceData,"comments",a)},expression:"content.performanceData.comments"}})],1)],1)],1),t._v(" "),a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"ç‚¹èµæ•°",prop:"contentList."+s+".performanceData.likes"}},[a("el-input-number",{attrs:{min:0,"controls-position":"right"},model:{value:e.performanceData.likes,callback:function(a){t.$set(e.performanceData,"likes",a)},expression:"content.performanceData.likes"}})],1)],1),t._v(" "),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"è¯„è®ºæ•°",prop:"contentList."+s+".performanceData.comments"}},[a("el-input-number",{attrs:{min:0,"controls-position":"right"},model:{value:e.performanceData.comments,callback:function(a){t.$set(e.performanceData,"comments",a)},expression:"content.performanceData.comments"}})],1)],1),t._v(" "),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"åˆ†äº«æ•°",prop:"contentList."+s+".performanceData.shares"}},[a("el-input-number",{attrs:{min:0,"controls-position":"right"},model:{value:e.performanceData.shares,callback:function(a){t.$set(e.performanceData,"shares",a)},expression:"content.performanceData.shares"}})],1)],1)],1),t._v(" "),a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"ç›´æ’­GMV",prop:"contentList."+s+".performanceData.liveGmv"}},[a("el-input-number",{attrs:{min:0,precision:2,"controls-position":"right"},model:{value:e.performanceData.liveGmv,callback:function(a){t.$set(e.performanceData,"liveGmv",a)},expression:"content.performanceData.liveGmv"}})],1)],1),t._v(" "),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"è§†é¢‘GMV",prop:"contentList."+s+".performanceData.videoGmv"}},[a("el-input-number",{attrs:{min:0,precision:2,"controls-position":"right"},model:{value:e.performanceData.videoGmv,callback:function(a){t.$set(e.performanceData,"videoGmv",a)},expression:"content.performanceData.videoGmv"}})],1)],1)],1)],1)],1)})),t._v(" "),a("div",{staticClass:"add-content-btn"},[a("el-button",{attrs:{type:"primary",plain:"",icon:"el-icon-plus"},on:{click:t.addContent}},[t._v("\n                        æ·»åŠ å†…å®¹\n                    ")])],1)],2)]),t._v(" "),a("div",{staticClass:"form-section"},[a("div",{staticClass:"section-title"},[a("i",{staticClass:"el-icon-data-analysis"}),t._v("\n                åˆè®¡æ•ˆæœæ•°æ®\n            ")]),t._v(" "),a("div",{staticClass:"total-performance"},[a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:8}},[a("div",{staticClass:"data-card"},[a("div",{staticClass:"data-icon"},[a("i",{staticClass:"el-icon-video-play"})]),t._v(" "),a("div",{staticClass:"data-content"},[a("div",{staticClass:"data-label"},[t._v("æ€»æ’­æ”¾é‡")]),t._v(" "),a("div",{staticClass:"data-value"},[t._v(t._s(t.formatNumber(t.getTotalViews)))])])])]),t._v(" "),a("el-col",{attrs:{span:8}},[a("div",{staticClass:"data-card"},[a("div",{staticClass:"data-icon"},[a("i",{staticClass:"el-icon-star-on"})]),t._v(" "),a("div",{staticClass:"data-content"},[a("div",{staticClass:"data-label"},[t._v("æ€»ç‚¹èµæ•°")]),t._v(" "),a("div",{staticClass:"data-value"},[t._v(t._s(t.formatNumber(t.getTotalLikes)))])])])]),t._v(" "),a("el-col",{attrs:{span:8}},[a("div",{staticClass:"data-card"},[a("div",{staticClass:"data-icon"},[a("i",{staticClass:"el-icon-chat-dot-round"})]),t._v(" "),a("div",{staticClass:"data-content"},[a("div",{staticClass:"data-label"},[t._v("æ€»è¯„è®ºæ•°")]),t._v(" "),a("div",{staticClass:"data-value"},[t._v(t._s(t.formatNumber(t.getTotalComments)))])])])])],1),t._v(" "),a("el-row",{staticStyle:{"margin-top":"20px"},attrs:{gutter:20}},[a("el-col",{attrs:{span:8}},[a("div",{staticClass:"data-card"},[a("div",{staticClass:"data-icon"},[a("i",{staticClass:"el-icon-share"})]),t._v(" "),a("div",{staticClass:"data-content"},[a("div",{staticClass:"data-label"},[t._v("æ€»åˆ†äº«æ•°")]),t._v(" "),a("div",{staticClass:"data-value"},[t._v(t._s(t.formatNumber(t.getTotalShares)))])])])]),t._v(" "),a("el-col",{attrs:{span:8}},[a("div",{staticClass:"data-card"},[a("div",{staticClass:"data-icon"},[a("i",{staticClass:"el-icon-money"})]),t._v(" "),a("div",{staticClass:"data-content"},[a("div",{staticClass:"data-label"},[t._v("è§†é¢‘GMV")]),t._v(" "),a("div",{staticClass:"data-value"},[t._v("Â¥"+t._s(t.formatNumber(t.getTotalVideoGmv)))])])])]),t._v(" "),a("el-col",{attrs:{span:8}},[a("div",{staticClass:"data-card"},[a("div",{staticClass:"data-icon"},[a("i",{staticClass:"el-icon-money"})]),t._v(" "),a("div",{staticClass:"data-content"},[a("div",{staticClass:"data-label"},[t._v("ç›´æ’­GMV")]),t._v(" "),a("div",{staticClass:"data-value"},[t._v("Â¥"+t._s(t.formatNumber(t.getTotalLiveGmv)))])])])])],1)],1)])]),t._v(" "),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:t.handleCancel}},[t._v("å– æ¶ˆ")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:t.handleSubmit}},[t._v("ç¡® å®š")])],1)],1)}),[],!1,null,"7228cc5a",null);e.default=m.exports},7059:function(t,e,a){},"8fe3":function(t,e,a){},b695:function(t,e,a){"use strict";a("8fe3")},b8bf:function(t,e,a){"use strict";a.r(e);var s=a("c7eb"),r=(a("96cf"),a("1da1")),i=a("7e1e"),n={name:"TaskSelect",props:{value:{type:Array,default:function(){return[]}}},data:function(){return{loading:!1,options:[],selectedTasks:[]}},watch:{value:{immediate:!0,handler:function(t){this.selectedTasks=t,t&&t.length>0&&this.fetchSelectedTasks(t)}}},methods:{remoteSearch:function(){var t=Object(r.a)(Object(s.a)().mark((function t(e){var a;return Object(s.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(""===e){t.next=18;break}return this.loading=!0,t.prev=2,t.next=5,Object(i.b)("task",{query:{title:{$regex:e,$options:"i"}},limit:20});case 5:a=t.sent,this.options=a.data,t.next=13;break;case 9:t.prev=9,t.t0=t.catch(2),console.error("æœç´¢ä»»åŠ¡å¤±è´¥:",t.t0),this.$message.error("æœç´¢ä»»åŠ¡å¤±è´¥");case 13:return t.prev=13,this.loading=!1,t.finish(13);case 16:t.next=19;break;case 18:this.options=[];case 19:case"end":return t.stop()}}),t,this,[[2,9,13,16]])})));return function(e){return t.apply(this,arguments)}}(),fetchSelectedTasks:function(){var t=Object(r.a)(Object(s.a)().mark((function t(e){var a;return Object(s.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e&&0!==e.length){t.next=2;break}return t.abrupt("return");case 2:return t.prev=2,t.next=5,Object(i.b)("task",{query:{_id:{$in:e}}});case 5:a=t.sent,this.options=a.data,t.next=12;break;case 9:t.prev=9,t.t0=t.catch(2),console.error("è·å–å·²é€‰ä»»åŠ¡å¤±è´¥:",t.t0);case 12:case"end":return t.stop()}}),t,this,[[2,9]])})));return function(e){return t.apply(this,arguments)}}(),handleChange:function(t){this.$emit("input",t)}}},l=n,c=a("2877"),o=Object(c.a)(l,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-select",{attrs:{multiple:"",filterable:"",remote:"","reserve-keyword":"",placeholder:"è¯·è¾“å…¥ä»»åŠ¡æ ‡é¢˜æœç´¢","remote-method":t.remoteSearch,loading:t.loading},on:{change:t.handleChange},model:{value:t.selectedTasks,callback:function(e){t.selectedTasks=e},expression:"selectedTasks"}},t._l(t.options,(function(e){return a("el-option",{key:e._id,attrs:{label:e.title,value:e._id}},[a("span",{staticStyle:{float:"left"}},[t._v(t._s(e.title))]),t._v(" "),a("span",{staticStyle:{float:"right",color:"#8492a6","font-size":"13px"}},[t._v("\n      "+t._s(e.type)+"\n    ")])])})),1)}),[],!1,null,null,null);e.default=o.exports},c466:function(t,e,a){"use strict";function s(t){return t?(("string"==typeof t||"number"==typeof t)&&(t=new Date(t)),console.log(t),t.getFullYear()+"-"+(t.getMonth()+1)+"-"+(t.getDate()<10?"0"+t.getDate():t.getDate())+" "+(t.getHours()<10?"0"+t.getHours():t.getHours())+":"+(t.getMinutes()<10?"0"+t.getMinutes():t.getMinutes())+":"+(t.getSeconds()<10?"0"+t.getSeconds():t.getSeconds())):""}function r(t){return t||0===t?t.toString().replace(/\B(?=(\d{3})+(?!\d))/g,","):"0"}a.d(e,"a",(function(){return s})),a.d(e,"b",(function(){return r})),a("6b54"),a("a481")},cb28:function(t,e,a){"use strict";a.r(e);var s=(a("6b54"),a("a481"),a("7f7f"),a("5530")),r=a("c7eb"),i=(a("6762"),a("2fdb"),a("96cf"),a("1da1")),n=a("2909"),l=a("7e1e"),c=a("c466"),o=a("cf83"),u=a("6c29b"),m=a("3e48"),d=a("5260"),p=a("3620"),v=a("b8bf"),f=a("f186"),h={dicts:["expert_platform","task_type","content_type","category","task_progress","broker_task_progress","tracker_task_progress"],name:"TrackerTasks",components:{TaskProgressDialog:o.default,TaskResultDialog:u.default,TaskClaimDetails:m.default,ExpertSelect:d.default,AgentSelect:p.default,TaskSelect:v.default,TrackerSelect:f.default},data:function(){return{claimStatusList:["å¾…å®¡æ ¸","å·²é€šè¿‡","å·²æ‹’ç»"],currentUserId:"",isAdmin:!1,isAgent:!1,isTracker:!1,taskInfo:null,searchForm:{taskIds:[],taskType:"",status:"",claimStatus:"",publishTimeRange:[],videoGmvMin:null,videoGmvMax:null,liveGmvMin:null,liveGmvMax:null,expertIds:[],agentIds:[]},taskList:[],page:{current:1,size:10,total:0},statusList:[],showProgressHistory:!1,showResultDialog:!1,progressDialogVisible:!1,resultDialogVisible:!1,detailsDialogVisible:!1,currentClaim:null,currentClaimDetails:null,taskTypeTagMap:{"ç›´æ’­å¸¦è´§":"success","çŸ­è§†é¢‘":"primary","å›¾æ–‡":"warning"},taskStatusTagMap:{"å¾…å¼€å§‹":"info","è¿›è¡Œä¸­":"primary","å·²ç»“æŸ":"success","å·²å–æ¶ˆ":"danger"},progressStatusTagMap:{"æœªå¼€å§‹":"info","æ²Ÿé€šä¸­":"warning","åˆä½œæˆåŠŸ":"success","å¯„é€æ ·å“":"primary","æ ·å“è·Ÿè¸ª":"warning","å·²æ”¶è´§":"success","å†…å®¹åˆ¶ä½œä¸­":"primary","ä½œå“å·²å‘å¸ƒ":"success","æ•°æ®ç»Ÿè®¡ä¸­":"warning","å·²å®Œæˆ":"success","å·²å–æ¶ˆ":"danger"},claimStatusTagMap:{"å¾…å®¡æ ¸":"warning","å·²é€šè¿‡":"success","å·²æ‹’ç»":"danger"},taskConfig:{requireClaimAudit:!1},taskTypeList:["ç›´æ’­å¸¦è´§","çŸ­è§†é¢‘","å›¾æ–‡"]}},created:function(){this.getCurrentUser(),this.fetchData()},methods:{checkAgentPermission:function(t){return console.log("ğŸš€ ~ checkAgentPermission ~ row:",t),!t.progressSteps.some((function(t){return"åˆä½œæˆåŠŸ"===t.status}))},checkTrackerPermission:function(t){return t.progressSteps.some((function(t){return"åˆä½œæˆåŠŸ"===t.status}))},getAvailableStatuses:function(){if(console.log(this.dict.type.broker_task_progress,"this.dict.type.broker_task_progress"),this.isAgent)return this.statusList=[].concat(Object(n.a)(this.dict.type.broker_task_progress),[{label:"åˆä½œæˆåŠŸ",value:"åˆä½œæˆåŠŸ",type:"success"}]);if(this.isTracker){var t=[{label:"åˆä½œæˆåŠŸ",value:"åˆä½œæˆåŠŸ",type:"success"}];return t=[].concat(Object(n.a)(t),Object(n.a)(this.dict.type.tracker_task_progress)),this.statusList=t}return this.statusList},calculateTotalMetric:function(t,e){return t&&Array.isArray(t)?t.reduce((function(t,a){return t+(a.performanceData&&a.performanceData[e]||0)}),0):0},calculateTotalInteractions:function(t){return t&&Array.isArray(t)?t.reduce((function(t,e){var a=e.performanceData||{};return t+(a.likes||0)+(a.comments||0)+(a.shares||0)}),0):0},getContentTimelineType:function(t){return{"çŸ­è§†é¢‘":"primary","ç›´æ’­":"success","å›¾æ–‡":"warning"}[t.contentType]||"info"},getCurrentUser:function(){var t=Object(i.a)(Object(r.a)().mark((function t(){return Object(r.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:try{this.isAdmin=this.$store.getters.roles.label.includes("Admin"),this.isAgent=this.$store.getters.roles.label.includes("Agent")||this.$store.getters.roles.label.includes("Admin"),this.isTracker=this.$store.getters.roles.label.includes("Tracker")||this.$store.getters.roles.label.includes("Admin"),this.currentUserId=this.$store.state.user.id}catch(t){console.error("è·å–ç”¨æˆ·ä¿¡æ¯å¤±è´¥:",t)}case 1:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),fetchData:function(){var t=Object(i.a)(Object(r.a)().mark((function t(){var e,a;return Object(r.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this.buildQuery();case 3:return e=t.sent,t.next=6,Object(l.b)("taskClaim",{query:e,populate:JSON.stringify([{path:"taskId"},{path:"agentId"},{path:"expertId"},{path:"trackerId"}]),sort:{_id:-1},page:this.page.current,limit:this.page.size});case 6:a=t.sent,this.taskList=a.data.map((function(t){return Object(s.a)(Object(s.a)({},t),{},{taskInfo:t.taskId,agentName:t.agentId&&t.agentId.nickName?t.agentId.nickName:"æœªçŸ¥",expertName:t.expertId&&t.expertId.nickname?t.expertId.nickname:"æœªçŸ¥",trackerName:t.trackerId&&t.trackerId.nickName?t.trackerId.nickName:"æœªæŒ‡å®š"})})),this.page.total=a.total,t.next=15;break;case 11:t.prev=11,t.t0=t.catch(0),console.error("è·å–æ•°æ®å¤±è´¥:",t.t0),this.$message.error("è·å–æ•°æ®å¤±è´¥");case 15:case"end":return t.stop()}}),t,this,[[0,11]])})));return function(){return t.apply(this,arguments)}}(),buildQuery:function(){var t=Object(i.a)(Object(r.a)().mark((function t(){var e,a,s;return Object(r.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e={},this.searchForm.taskIds&&this.searchForm.taskIds.length>0&&(e.taskId={$in:this.searchForm.taskIds}),!this.searchForm.taskType){t.next=8;break}return t.next=5,this.getTaskIdsByType(this.searchForm.taskType);case 5:a=t.sent,console.log("ğŸš€ ~ buildQuery ~ taskIds:",a),a.length>0&&(e.taskId={$in:a});case 8:if(!this.searchForm.contentType){t.next=13;break}return t.next=11,this.getTaskIdsByContentType(this.searchForm.contentType);case 11:(s=t.sent).length>0&&(e.taskId={$in:s});case 13:return this.searchForm.status&&(e.status=this.searchForm.status),this.searchForm.claimStatus&&(e.claimStatus=this.searchForm.claimStatus),this.searchForm.publishTimeRange&&2===this.searchForm.publishTimeRange.length&&(e["result.contentList.publishTime"]={$gte:new Date(this.searchForm.publishTimeRange[0]),$lte:new Date(this.searchForm.publishTimeRange[1])}),(this.searchForm.videoGmvMin||this.searchForm.videoGmvMax)&&(e["result.contentList.performanceData.videoGmv"]={},this.searchForm.videoGmvMin&&(e["result.contentList.performanceData.videoGmv"].$gte=this.searchForm.videoGmvMin),this.searchForm.videoGmvMax&&(e["result.contentList.performanceData.videoGmv"].$lte=this.searchForm.videoGmvMax)),(this.searchForm.liveGmvMin||this.searchForm.liveGmvMax)&&(e["result.contentList.performanceData.liveGmv"]={},this.searchForm.liveGmvMin&&(e["result.contentList.performanceData.liveGmv"].$gte=this.searchForm.liveGmvMin),this.searchForm.liveGmvMax&&(e["result.contentList.performanceData.liveGmv"].$lte=this.searchForm.liveGmvMax)),this.searchForm.expertIds&&this.searchForm.expertIds.length>0&&(e.expertId={$in:this.searchForm.expertIds}),this.searchForm.agentIds&&this.searchForm.agentIds.length>0&&(e.agentId={$in:this.searchForm.agentIds}),this.isAdmin||(this.isAgent&&(e.agentId=this.$store.state.user.id),this.isTracker&&(e.trackerId=this.$store.state.user.id)),t.abrupt("return",e);case 22:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),handleAudit:function(){var t=Object(i.a)(Object(r.a)().mark((function t(e,a){return Object(r.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Object(l.d)("taskClaim",{query:{_id:e._id},update:{claimStatus:a,auditTime:new Date,auditRemark:"å·²æ‹’ç»"===a?"ä¸ç¬¦åˆè¦æ±‚":"ç¬¦åˆè¦æ±‚"}});case 3:this.$message.success("å®¡æ ¸å®Œæˆ"),this.fetchData(),t.next=11;break;case 7:t.prev=7,t.t0=t.catch(0),console.error("å®¡æ ¸å¤±è´¥:",t.t0),this.$message.error("å®¡æ ¸å¤±è´¥");case 11:case"end":return t.stop()}}),t,this,[[0,7]])})));return function(e,a){return t.apply(this,arguments)}}(),handleProgressSubmit:function(){var t=Object(i.a)(Object(r.a)().mark((function t(e){var a;return Object(r.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,a={status:e.status,$push:{progressSteps:{step:e.step,status:e.status,updateTime:new Date,updatedBy:this.currentUserId,remark:e.remark,trackingInfo:e.trackingInfo}}},"åˆä½œæˆåŠŸ"!==e.status){t.next=6;break}return a.trackerId=e.trackerId,t.next=6,Object(l.a)("messageLog",{title:"è·Ÿè¸ªå‘˜æŒ‡æ´¾é€šçŸ¥",content:"æ‚¨å·²è¢«æŒ‡æ´¾ä¸ºä»»åŠ¡ã€".concat(this.taskInfo.title,"ã€‘çš„è·Ÿè¸ªå‘˜"),type:"TRACKER_ASSIGNED",taskId:this.taskInfo._id,taskClaimId:this.currentClaim._id,sender:{userId:this.$store.state.user.id,role:"AGENT"},receivers:[{userId:e.trackerId,role:"TRACKER",isRead:!1}],isSystem:!1});case 6:return t.next=8,Object(l.d)("taskClaim",{query:{_id:this.currentClaim._id},update:a});case 8:return this.$message.success("è¿›åº¦æ›´æ–°æˆåŠŸ"),t.next=11,Object(l.a)("messageLog",{title:"ä»»åŠ¡è¿›åº¦æ›´æ–°",content:"ä»»åŠ¡ã€".concat(this.taskInfo.title,"ã€‘çš„è¿›åº¦å·²æ›´æ–°ä¸ºï¼š").concat(e.status),type:"TASK_PROGRESS",taskId:this.taskInfo._id,taskClaimId:this.currentClaim._id,sender:{userId:this.$store.state.user.id,role:this.isTracker?"TRACKER":"AGENT"},receivers:[{userId:this.currentClaim.agentId&&this.currentClaim.agentId._id,role:"AGENT",isRead:!1},{userId:this.currentClaim.trackerId&&this.currentClaim.trackerId._id,role:"TRACKER",isRead:!1}],isSystem:!1});case 11:this.$message.success("è¿›åº¦æ›´æ–°æˆåŠŸ"),this.fetchData(),this.progressDialogVisible=!1,t.next=20;break;case 16:t.prev=16,t.t0=t.catch(0),console.error("è¿›åº¦æ›´æ–°å¤±è´¥:",t.t0),this.$message.error("è¿›åº¦æ›´æ–°å¤±è´¥");case 20:case"end":return t.stop()}}),t,this,[[0,16]])})));return function(e){return t.apply(this,arguments)}}(),getTaskTypeTag:function(t){return this.taskTypeTagMap[t]||"info"},getTaskStatusTag:function(t){return this.taskStatusTagMap[t]||"info"},getProgressStatusType:function(t){return this.progressStatusTagMap[t]||"info"},getClaimStatusType:function(t){return this.claimStatusTagMap[t]||"info"},handleUpdateProgress:function(t){this.taskInfo=t.taskId,this.currentClaim=t,this.progressDialogVisible=!0},handleSubmitResult:function(t){this.taskInfo=t.taskId,this.currentClaim=t,this.resultDialogVisible=!0},handleViewDetails:function(t){t?(this.currentClaimDetails={_id:t._id||"",taskInfo:t.taskInfo||{},agentName:t.agentId&&t.agentId.nickName?t.agentId.nickName:"æœªçŸ¥",expertName:t.expertId&&t.expertId.name?t.expertId.name:"æœªçŸ¥",trackerName:t.trackerId&&t.trackerId.nickName?t.trackerId.nickName:"æœªæŒ‡å®š",claimStatus:t.claimStatus||"æœªçŸ¥",claimTime:t.claimTime||null,status:t.status||"æœªçŸ¥",progressSteps:t.progressSteps||[],result:t.result?Object(s.a)(Object(s.a)({},t.result),{},{performanceData:{views:t.result&&t.result.performanceData&&t.result.performanceData.views||0,likes:t.result&&t.result.performanceData&&t.result.performanceData.likes||0,comments:t.result&&t.result.performanceData&&t.result.performanceData.comments||0,shares:t.result&&t.result.performanceData&&t.result.performanceData.shares||0,gmv:t.result&&t.result.performanceData&&t.result.performanceData.gmv||0,orderCount:t.result&&t.result.performanceData&&t.result.performanceData.orderCount||0}}):null},this.detailsDialogVisible=!0):this.$message.warning("æ•°æ®ä¸å®Œæ•´")},handleSearch:function(){this.page.current=1,this.fetchData()},resetSearch:function(){this.searchForm={taskIds:[],taskType:"",status:"",claimStatus:"",publishTimeRange:[],videoGmvMin:null,videoGmvMax:null,liveGmvMin:null,liveGmvMax:null,expertIds:[],agentIds:[]},this.handleSearch()},handleSizeChange:function(t){this.page.size=t,this.fetchData()},handleCurrentChange:function(t){this.page.current=t,this.fetchData()},formatNumber:function(t){return t?t.toString().replace(/(\d)(?=(?:\d{3})+$)/g,"$1,"):"0"},formatDate:function(t){return Object(c.a)(t)},getTaskIdsByType:function(){var t=Object(i.a)(Object(r.a)().mark((function t(e){var a;return Object(r.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Object(l.b)("task",{query:{type:e},select:"_id"});case 3:return a=t.sent,t.abrupt("return",a.data.map((function(t){return t._id})));case 7:return t.prev=7,t.t0=t.catch(0),console.error("è·å–ä»»åŠ¡IDå¤±è´¥:",t.t0),t.abrupt("return",[]);case 11:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(e){return t.apply(this,arguments)}}(),getTaskIdsByContentType:function(){var t=Object(i.a)(Object(r.a)().mark((function t(e){var a;return Object(r.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Object(l.b)("task",{query:{"cooperationDetails.requirements.contentType":e},select:"_id"});case 3:return a=t.sent,t.abrupt("return",a.data.map((function(t){return t._id})));case 7:return t.prev=7,t.t0=t.catch(0),console.error("è·å–ä»»åŠ¡IDå¤±è´¥:",t.t0),t.abrupt("return",[]);case 11:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(e){return t.apply(this,arguments)}}()},computed:{}},b=h,g=(a("edbc"),a("2877")),_=Object(g.a)(b,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"tracker-tasks"},[a("el-card",{staticClass:"search-card"},[a("el-form",{staticClass:"search-form",attrs:{inline:!0,model:t.searchForm}},[a("el-form-item",{attrs:{label:"ä»»åŠ¡æ ‡é¢˜"}},[a("task-select",{model:{value:t.searchForm.taskIds,callback:function(e){t.$set(t.searchForm,"taskIds",e)},expression:"searchForm.taskIds"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"ä»»åŠ¡ç±»å‹"}},[a("el-select",{attrs:{placeholder:"è¯·é€‰æ‹©ä»»åŠ¡ç±»å‹",clearable:""},model:{value:t.searchForm.taskType,callback:function(e){t.$set(t.searchForm,"taskType",e)},expression:"searchForm.taskType"}},t._l(t.dict.type.task_type,(function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1),t._v(" "),a("el-form-item",{attrs:{label:"å†…å®¹å½¢å¼"}},[a("el-select",{attrs:{placeholder:"è¯·é€‰æ‹©å†…å®¹å½¢å¼",clearable:""},model:{value:t.searchForm.contentType,callback:function(e){t.$set(t.searchForm,"contentType",e)},expression:"searchForm.contentType"}},t._l(t.dict.type.content_type,(function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1),t._v(" "),a("el-form-item",{attrs:{label:"ä»»åŠ¡è¿›åº¦"}},[a("el-select",{attrs:{placeholder:"è¯·é€‰æ‹©è¿›åº¦",clearable:""},model:{value:t.searchForm.status,callback:function(e){t.$set(t.searchForm,"status",e)},expression:"searchForm.status"}},t._l(t.dict.type.task_progress,(function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1),t._v(" "),t.taskConfig.requireClaimAudit?a("el-form-item",{attrs:{label:"å®¡æ ¸çŠ¶æ€"}},[a("el-select",{attrs:{placeholder:"è¯·é€‰æ‹©å®¡æ ¸çŠ¶æ€",clearable:""},model:{value:t.searchForm.claimStatus,callback:function(e){t.$set(t.searchForm,"claimStatus",e)},expression:"searchForm.claimStatus"}},t._l(t.claimStatusList,(function(t){return a("el-option",{key:t,attrs:{label:t,value:t}})})),1)],1):t._e(),t._v(" "),a("el-form-item",{attrs:{label:"å‘å¸ƒæ—¶é—´"}},[a("el-date-picker",{attrs:{type:"daterange","range-separator":"è‡³","start-placeholder":"å¼€å§‹æ—¥æœŸ","end-placeholder":"ç»“æŸæ—¥æœŸ","value-format":"yyyy-MM-dd","default-time":["00:00:00","23:59:59"]},model:{value:t.searchForm.publishTimeRange,callback:function(e){t.$set(t.searchForm,"publishTimeRange",e)},expression:"searchForm.publishTimeRange"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"è¾¾äºº"}},[a("expert-select",{model:{value:t.searchForm.expertIds,callback:function(e){t.$set(t.searchForm,"expertIds",e)},expression:"searchForm.expertIds"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"ç»çºªäºº"}},[a("agent-select",{model:{value:t.searchForm.agentIds,callback:function(e){t.$set(t.searchForm,"agentIds",e)},expression:"searchForm.agentIds"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"è·Ÿè¸ªå‘˜"}},[a("tracker-select",{model:{value:t.searchForm.trackerIds,callback:function(e){t.$set(t.searchForm,"trackerIds",e)},expression:"searchForm.trackerIds"}})],1),t._v(" "),a("el-row",[a("el-form-item",{attrs:{label:"è§†é¢‘GMV"}},[a("el-input-number",{attrs:{placeholder:"æœ€å°å€¼",min:0},model:{value:t.searchForm.videoGmvMin,callback:function(e){t.$set(t.searchForm,"videoGmvMin",e)},expression:"searchForm.videoGmvMin"}}),t._v(" "),a("span",{staticClass:"range-separator"},[t._v("-")]),t._v(" "),a("el-input-number",{attrs:{placeholder:"æœ€å¤§å€¼",min:0},model:{value:t.searchForm.videoGmvMax,callback:function(e){t.$set(t.searchForm,"videoGmvMax",e)},expression:"searchForm.videoGmvMax"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"ç›´æ’­GMV"}},[a("el-input-number",{attrs:{placeholder:"æœ€å°å€¼",min:0},model:{value:t.searchForm.liveGmvMin,callback:function(e){t.$set(t.searchForm,"liveGmvMin",e)},expression:"searchForm.liveGmvMin"}}),t._v(" "),a("span",{staticClass:"range-separator"},[t._v("-")]),t._v(" "),a("el-input-number",{attrs:{placeholder:"æœ€å¤§å€¼",min:0},model:{value:t.searchForm.liveGmvMax,callback:function(e){t.$set(t.searchForm,"liveGmvMax",e)},expression:"searchForm.liveGmvMax"}})],1)],1),t._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:t.handleSearch}},[t._v("æœç´¢")]),t._v(" "),a("el-button",{on:{click:t.resetSearch}},[t._v("é‡ç½®")])],1)],1)],1),t._v(" "),a("el-card",{staticClass:"task-list"},[a("div",{attrs:{slot:"header"},slot:"header"},[a("span",[t._v("ä»»åŠ¡åˆ—è¡¨")]),t._v(" "),a("el-button",{staticStyle:{float:"right","margin-left":"10px"},attrs:{type:"warning",size:"small"},on:{click:function(e){t.showProgressHistory=!t.showProgressHistory}}},[t._v("\n        "+t._s(t.showProgressHistory?"éšè—ä»»åŠ¡è¿›åº¦å†å²":"å±•å¼€ä»»åŠ¡è¿›åº¦å†å²")+"\n      ")]),t._v(" "),a("el-button",{staticStyle:{float:"right","margin-left":"10px"},attrs:{type:"warning",size:"small"},on:{click:function(e){t.showResultDialog=!t.showResultDialog}}},[t._v("\n        "+t._s(t.showResultDialog?"éšè—æ‰§è¡Œç»“æœåˆ—è¡¨":"å±•å¼€æ‰§è¡Œç»“æœåˆ—è¡¨")+"\n      ")])],1),t._v(" "),a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.taskList,border:""}},[a("el-table-column",{attrs:{label:"ä»»åŠ¡ä¿¡æ¯","min-width":"200"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{staticClass:"task-info"},[a("div",{staticClass:"task-title"},[t._v(t._s(e.row.taskInfo.title))]),t._v(" "),a("div",{staticClass:"task-meta"},[a("el-tag",{attrs:{size:"small",type:t.getTaskTypeTag(e.row.taskInfo.type)}},[t._v("\n                "+t._s(e.row.taskInfo.type)+"\n              ")])],1)])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"ä»»åŠ¡æ—¶é—´","min-width":"200"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-tag",{attrs:{size:"mini",type:"success"}},[t._v("å¼€å§‹ï¼š"+t._s(t.formatDate(e.row.taskInfo.startTime))+" ")]),t._v(" "),a("el-tag",{attrs:{size:"mini",type:"warning"}},[t._v("ç»“æŸï¼š"+t._s(t.formatDate(e.row.taskInfo.endTime)))])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"è¾¾äººä¿¡æ¯","min-width":"150"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{staticClass:"expert-info"},[a("div",[t._v(t._s(e.row.expertName))]),t._v(" "),a("small",{staticClass:"agent-name"},[t._v("ç»çºªäººï¼š"+t._s(e.row.agentName))])])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"ä»»åŠ¡ç»çºªäºº","min-width":"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n          "+t._s(e.row.agentName)+"\n        ")]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"å½“å‰ä»»åŠ¡è¿›åº¦","min-width":"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-tag",{attrs:{type:t.getProgressStatusType(e.row.status)}},[t._v(t._s(e.row.status))])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"è·Ÿè¸ªå‘˜","min-width":"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n          "+t._s(e.row.trackerName)+"\n        ")]}}])}),t._v(" "),t.showProgressHistory?a("el-table-column",{attrs:{label:"è¿›åº¦å†å²","min-width":"300"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.progressSteps&&e.row.progressSteps.length?a("el-timeline",t._l(e.row.progressSteps,(function(e,s){return a("el-timeline-item",{key:s,attrs:{type:t.getProgressStatusType(e.status),size:"small",timestamp:t.formatDate(e.updateTime)}},[a("div",{staticClass:"progress-item"},[a("div",{staticClass:"progress-header"},[a("el-tag",{attrs:{size:"mini",type:t.getProgressStatusType(e.status)}},[t._v("\n                    "+t._s(e.status)+"\n                  ")]),t._v(" "),a("span",{staticClass:"progress-step"},[t._v(t._s(e.step))])],1),t._v(" "),e.remark?a("div",{staticClass:"progress-remark"},[t._v("\n                  "+t._s(e.remark)+"\n                ")]):t._e()])])})),1):a("span",[t._v("æš‚æ— è¿›åº¦")])]}}],null,!1,865908661)}):t._e(),t._v(" "),t.isTracker?a("el-table-column",{attrs:{label:"æ‰§è¡Œç»“æœ",width:"600"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.result&&e.row.result.contentList&&e.row.result.contentList.length?[a("div",{staticClass:"result-summary",staticStyle:{width:"150px"}},[a("div",{staticClass:"result-data-item"},[a("span",{staticClass:"label"},[t._v("æ€»æ’­æ”¾é‡ï¼š")]),t._v(" "),a("span",{staticClass:"value"},[t._v(t._s(t.formatNumber(t.calculateTotalMetric(e.row.result.contentList,"views"))))])]),t._v(" "),a("div",{staticClass:"result-data-item"},[a("span",{staticClass:"label"},[t._v("æ€»äº’åŠ¨é‡ï¼š")]),t._v(" "),a("span",{staticClass:"value"},[t._v(t._s(t.formatNumber(t.calculateTotalInteractions(e.row.result.contentList))))])]),t._v(" "),a("div",{staticClass:"result-data-item"},[a("span",{staticClass:"label"},[t._v("æ€»è§†é¢‘é”€å”®é¢ï¼š")]),t._v(" "),a("span",{staticClass:"value highlight"},[t._v("Â¥"+t._s(t.formatNumber(t.calculateTotalMetric(e.row.result.contentList,"videoGmv"))))])]),t._v(" "),a("div",{staticClass:"result-data-item"},[a("span",{staticClass:"label"},[t._v("æ€»ç›´æ’­é”€å”®é¢ï¼š")]),t._v(" "),a("span",{staticClass:"value highlight"},[t._v("Â¥"+t._s(t.formatNumber(t.calculateTotalMetric(e.row.result.contentList,"liveGmv"))))])])]),t._v(" "),t.showResultDialog?a("el-table",{staticClass:"content-table",attrs:{data:e.row.result.contentList,size:"mini",border:""}},[a("el-table-column",{attrs:{label:"å‘å¸ƒå¹³å°",width:"90"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-tag",{attrs:{size:"mini",type:"primary"}},[t._v(t._s(e.row.platform))])]}}],null,!0)}),t._v(" "),a("el-table-column",{attrs:{label:"å†…å®¹ç±»å‹",width:"90"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-tag",{staticStyle:{"margin-top":"4px"},attrs:{size:"mini",type:"success"}},[t._v(t._s(e.row.type))])]}}],null,!0)}),t._v(" "),a("el-table-column",{attrs:{label:"è§†é¢‘é“¾æ¥",width:"90"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-link",{attrs:{type:"primary",href:e.row.link,target:"_blank"}},[t._v(t._s(e.row.link))])]}}],null,!0)}),t._v(" "),a("el-table-column",{attrs:{label:"å¹¿å‘Šç ",width:"90"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n                  "+t._s(e.row.adCode)+"\n                ")]}}],null,!0)}),t._v(" "),a("el-table-column",{attrs:{label:"å‘å¸ƒæ—¶é—´",width:"90"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",{staticClass:"publish-time"},[t._v(t._s(t.formatDate(e.row.publishTime)))])]}}],null,!0)}),t._v(" "),a("el-table-column",{attrs:{label:"æ•°æ®è¡¨ç°"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{staticClass:"metrics-container"},[a("div",{staticClass:"metric-item"},[a("i",{staticClass:"el-icon-video-play"}),t._v(" "),a("span",{staticClass:"metric-value"},[t._v(t._s(t.formatNumber(e.row.performanceData.views)))])]),t._v(" "),a("div",{staticClass:"metric-item"},[a("i",{staticClass:"el-icon-star-on"}),t._v(" "),a("span",{staticClass:"metric-value"},[t._v(t._s(t.formatNumber(e.row.performanceData.likes)))])]),t._v(" "),a("div",{staticClass:"metric-item"},[a("i",{staticClass:"el-icon-chat-dot-round"}),t._v(" "),a("span",{staticClass:"metric-value"},[t._v(t._s(t.formatNumber(e.row.performanceData.comments)))])]),t._v(" "),a("div",{staticClass:"metric-item"},[a("i",{staticClass:"el-icon-share"}),t._v(" "),a("span",{staticClass:"metric-value"},[t._v(t._s(t.formatNumber(e.row.performanceData.shares)))])]),t._v(" "),a("div",{staticClass:"metric-item highlight"},[t._v("\n                      è§†é¢‘GMVï¼šÂ¥"+t._s(t.formatNumber(e.row.performanceData.videoGmv))+"\n                    ")]),t._v(" "),a("div",{staticClass:"metric-item highlight"},[t._v("\n                      ç›´æ’­GMVï¼šÂ¥"+t._s(t.formatNumber(e.row.performanceData.liveGmv))+"\n                    ")])])]}}],null,!0)})],1):t._e()]:a("span",{staticClass:"no-result"},[t._v("æš‚æ— æ‰§è¡Œç»“æœ")])]}}],null,!1,1302769326)}):t._e(),t._v(" "),a("el-table-column",{attrs:{label:"æ“ä½œ",width:t.isAdmin&&t.taskConfig.requireClaimAudit||t.isTracker?300:200,fixed:"right"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{size:"mini",type:"info"},on:{click:function(a){return t.handleViewDetails(e.row)}}},[t._v("\n            æŸ¥çœ‹è¯¦æƒ…\n          ")]),t._v(" "),t.isAdmin&&t.taskConfig.requireClaimAudit?["å¾…å®¡æ ¸"===e.row.claimStatus?a("el-button",{attrs:{size:"mini",type:"success"},on:{click:function(a){return t.handleAudit(e.row,"å·²é€šè¿‡")}}},[t._v("\n              é€šè¿‡\n            ")]):t._e(),t._v(" "),"å¾…å®¡æ ¸"===e.row.claimStatus?a("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(a){return t.handleAudit(e.row,"å·²æ‹’ç»")}}},[t._v("\n              æ‹’ç»\n            ")]):t._e()]:t._e(),t._v(" "),t.isAgent&&e.row.agentId&&e.row.agentId._id===t.currentUserId&&t.checkAgentPermission(e.row)?["å·²é€šè¿‡"===e.row.claimStatus?a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(a){return t.handleUpdateProgress(e.row)}}},[t._v("\n              æ›´æ–°è¿›åº¦\n            ")]):t._e()]:t._e(),t._v(" "),e.row.trackerId&&e.row.trackerId._id===t.currentUserId&&t.checkTrackerPermission(e.row)?["å·²é€šè¿‡"===e.row.claimStatus?a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(a){return t.handleUpdateProgress(e.row)}}},[t._v("\n              æ›´æ–°è¿›åº¦\n            ")]):t._e(),t._v(" "),a("el-button",{attrs:{size:"mini",type:"success"},on:{click:function(a){return t.handleSubmitResult(e.row)}}},[t._v("\n              æäº¤ç»“æœ\n            ")])]:t._e()]}}])})],1),t._v(" "),a("div",{staticClass:"pagination"},[a("el-pagination",{attrs:{"current-page":t.page.current,"page-sizes":[10,20,50,100],"page-size":t.page.size,layout:"total, sizes, prev, pager, next, jumper",total:t.page.total},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1)],1),t._v(" "),a("task-progress-dialog",{attrs:{visible:t.progressDialogVisible,"current-claim":t.currentClaim,"status-list":t.getAvailableStatuses()},on:{"update:visible":function(e){t.progressDialogVisible=e},submit:t.handleProgressSubmit}}),t._v(" "),a("task-result-dialog",{attrs:{visible:t.resultDialogVisible,"current-claim":t.currentClaim},on:{"update:visible":function(e){t.resultDialogVisible=e},"submit-success":t.fetchData}}),t._v(" "),a("task-claim-details",{attrs:{visible:t.detailsDialogVisible,details:t.currentClaimDetails},on:{"update:visible":function(e){t.detailsDialogVisible=e}}})],1)}),[],!1,null,"a1d7d8ac",null);e.default=_.exports},cd7c:function(t,e,a){"use strict";a("2b38")},cf83:function(t,e,a){"use strict";a.r(e);var s=a("c7eb"),r=(a("96cf"),a("1da1")),i=(a("6762"),a("2fdb"),a("ac6a"),a("456d"),a("7e1e")),n={dicts:["tracker_task_progress"],name:"TaskProgressDialog",props:{visible:{type:Boolean,default:!1},currentClaim:{type:Object,default:function(){return{}}},statusList:{type:Array,default:function(){return[]}}},data:function(){return{isAdmin:!1,isAgent:!1,isTracker:!1,currentUserId:"",form:{status:"",trackerId:"",step:"",remark:"",trackingInfo:{buildConnectionSource:"",cooperationDate:null,receiveTime:null,estimatedPublishTime:null}},rules:{status:[{required:!0,message:"è¯·é€‰æ‹©è¿›åº¦çŠ¶æ€",trigger:"change"}],step:[{message:"è¯·è¾“å…¥è¿›åº¦è¯´æ˜",trigger:"blur"}],"trackingInfo.buildConnectionSource":[{required:!0,message:"è¯·è¾“å…¥å»ºè”æ¥æº",trigger:"blur"}],"trackingInfo.cooperationDate":[{required:!0,message:"è¯·é€‰æ‹©ç¡®å®šåˆä½œæ—¥",trigger:"change"}],"trackingInfo.receiveTime":[{required:!0,message:"è¯·é€‰æ‹©æ”¶è´§æ—¶é—´",trigger:"change"}],"trackingInfo.estimatedPublishTime":[{required:!0,message:"è¯·é€‰æ‹©é¢„è®¡å‘å¸ƒæ—¶é—´",trigger:"change"}]},trackerOptions:[]}},watch:{visible:{immediate:!0,handler:function(t){t&&(this.initForm(),this.getCurrentUser(),this.loadTrackerOptions())}},currentClaim:{immediate:!0,handler:function(t){t&&Object.keys(t).length>0&&this.initForm()}}},computed:{dialogVisible:{get:function(){return this.visible},set:function(t){this.$emit("update:visible",t)}},showTrackingInfo:function(){return console.log(this.dict.type),this.dict.type.tracker_task_progress.map((function(t){return t.value})).includes(this.form.status)},availableStatuses:function(){return this.statusList}},methods:{handleClose:function(){this.dialogVisible=!1},getCurrentUser:function(){var t=Object(r.a)(Object(s.a)().mark((function t(){return Object(s.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:try{this.isAdmin=this.$store.getters.roles.label.includes("Admin"),this.isAgent=this.$store.getters.roles.label.includes("Agent")||this.$store.getters.roles.label.includes("Admin"),this.isTracker=this.$store.getters.roles.label.includes("Tracker")||this.$store.getters.roles.label.includes("Admin"),this.currentUserId=this.$store.state.user.id}catch(t){console.error("è·å–ç”¨æˆ·ä¿¡æ¯å¤±è´¥:",t)}case 1:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),initForm:function(){if(this.currentClaim){var t=this.currentClaim.progressSteps||[],e=(t.length>0?t[t.length-1]:{}).trackingInfo||{};this.form={status:this.currentClaim.status||"",trackerId:this.currentClaim.trackerId||"",step:"",remark:"",trackingInfo:{buildConnectionSource:e.buildConnectionSource||"",cooperationDate:e.cooperationDate||null,receiveTime:e.receiveTime||null,estimatedPublishTime:e.estimatedPublishTime||null}}}},loadTrackerOptions:function(){var t=Object(r.a)(Object(s.a)().mark((function t(){var e;return Object(s.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Object(i.b)("user_login",{query:{role:"6734de3a55647e147063f158"}});case 3:(e=t.sent).data&&(this.trackerOptions=e.data.map((function(t){return{value:t._id,label:t.nickName||t.username}}))),t.next=11;break;case 7:t.prev=7,t.t0=t.catch(0),console.error("è·å–ä»»åŠ¡è·Ÿè¸ªå‘˜åˆ—è¡¨å¤±è´¥:",t.t0),this.$message.error("è·å–ä»»åŠ¡è·Ÿè¸ªå‘˜åˆ—è¡¨å¤±è´¥");case 11:case"end":return t.stop()}}),t,this,[[0,7]])})));return function(){return t.apply(this,arguments)}}(),handleSubmit:function(){var t=Object(r.a)(Object(s.a)().mark((function t(){return Object(s.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this.$refs.progressForm.validate();case 3:if("åˆä½œæˆåŠŸ"!==this.form.status){t.next=13;break}if(this.form.trackerId){t.next=7;break}return this.$message.error("è¯·é€‰æ‹©ä»»åŠ¡è·Ÿè¸ªå‘˜"),t.abrupt("return");case 7:if(this.form.trackingInfo.buildConnectionSource){t.next=10;break}return this.$message.error("è¯·è¾“å…¥å»ºè”æ¥æº"),t.abrupt("return");case 10:if(this.form.trackingInfo.cooperationDate){t.next=13;break}return this.$message.error("è¯·é€‰æ‹©ç¡®å®šåˆä½œæ—¥"),t.abrupt("return");case 13:if("å·²ç­¾æ”¶"!==this.form.status||this.form.trackingInfo.receiveTime){t.next=16;break}return this.$message.error("è¯·é€‰æ‹©æ”¶è´§æ—¶é—´"),t.abrupt("return");case 16:if("å†…å®¹åˆ¶ä½œä¸­"!==this.form.status||this.form.trackingInfo.estimatedPublishTime){t.next=19;break}return this.$message.error("è¯·é€‰æ‹©é¢„è®¡å‘å¸ƒæ—¶é—´"),t.abrupt("return");case 19:this.$emit("submit",this.form),this.handleClose(),t.next=26;break;case 23:t.prev=23,t.t0=t.catch(0),console.error("è¡¨å•éªŒè¯å¤±è´¥:",t.t0);case 26:case"end":return t.stop()}}),t,this,[[0,23]])})));return function(){return t.apply(this,arguments)}}()}},l=n,c=a("2877"),o=Object(c.a)(l,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-dialog",{attrs:{title:"æ›´æ–°è¿›åº¦",visible:t.dialogVisible,width:"60%","custom-class":"progress-dialog","append-to-body":""},on:{"update:visible":function(e){t.dialogVisible=e},close:t.handleClose}},[a("el-form",{ref:"progressForm",attrs:{model:t.form,rules:t.rules,"label-width":"120px"}},[a("el-form-item",{attrs:{label:"è¿›åº¦çŠ¶æ€",prop:"status"}},[a("el-select",{staticStyle:{width:"100%"},model:{value:t.form.status,callback:function(e){t.$set(t.form,"status",e)},expression:"form.status"}},t._l(t.availableStatuses,(function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1),t._v(" "),"åˆä½œæˆåŠŸ"===t.form.status?a("el-form-item",{attrs:{label:"ä»»åŠ¡è·Ÿè¸ªå‘˜",prop:"trackerId",rules:{required:!0,message:"è¯·é€‰æ‹©ä»»åŠ¡è·Ÿè¸ªå‘˜",trigger:"change"}}},[a("el-select",{staticStyle:{width:"100%"},attrs:{filterable:"",placeholder:"è¯·é€‰æ‹©ä»»åŠ¡è·Ÿè¸ªå‘˜"},model:{value:t.form.trackerId,callback:function(e){t.$set(t.form,"trackerId",e)},expression:"form.trackerId"}},t._l(t.trackerOptions,(function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1):t._e(),t._v(" "),t.isAgent?[a("div",{staticClass:"tracking-info-section"},[["åˆä½œæˆåŠŸ"].includes(t.form.status)?a("el-form-item",{attrs:{label:"å»ºè”æ¥æº",prop:"trackingInfo.buildConnectionSource"}},[a("el-input",{attrs:{placeholder:"è¯·è¾“å…¥å»ºè”æ¥æº"},model:{value:t.form.trackingInfo.buildConnectionSource,callback:function(e){t.$set(t.form.trackingInfo,"buildConnectionSource",e)},expression:"form.trackingInfo.buildConnectionSource"}})],1):t._e(),t._v(" "),["åˆä½œæˆåŠŸ"].includes(t.form.status)?a("el-form-item",{attrs:{label:"ç¡®å®šåˆä½œæ—¥",prop:"trackingInfo.cooperationDate"}},[a("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"date",placeholder:"é€‰æ‹©ç¡®å®šåˆä½œæ—¥"},model:{value:t.form.trackingInfo.cooperationDate,callback:function(e){t.$set(t.form.trackingInfo,"cooperationDate",e)},expression:"form.trackingInfo.cooperationDate"}})],1):t._e()],1)]:t._e(),t._v(" "),t.isTracker?[a("div",{staticClass:"tracking-info-section"},[["å·²ç­¾æ”¶"].includes(t.form.status)?a("el-form-item",{attrs:{label:"æ”¶è´§æ—¶é—´",prop:"trackingInfo.receiveTime"}},[a("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"datetime",placeholder:"é€‰æ‹©æ”¶è´§æ—¶é—´"},model:{value:t.form.trackingInfo.receiveTime,callback:function(e){t.$set(t.form.trackingInfo,"receiveTime",e)},expression:"form.trackingInfo.receiveTime"}})],1):t._e()],1)]:t._e(),t._v(" "),a("el-form-item",{attrs:{label:"è¿›åº¦å¤‡æ³¨",prop:"step"}},[a("el-input",{attrs:{placeholder:"è¿›åº¦å¤‡æ³¨"},model:{value:t.form.step,callback:function(e){t.$set(t.form,"step",e)},expression:"form.step"}})],1)],2),t._v(" "),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:t.handleClose}},[t._v("å– æ¶ˆ")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:t.handleSubmit}},[t._v("ç¡® å®š")])],1)],1)}),[],!1,null,null,null);e.default=o.exports},edbc:function(t,e,a){"use strict";a("29a2")},f07a:function(t,e,a){},f186:function(t,e,a){"use strict";a.r(e);var s=(a("7514"),a("c7eb")),r=(a("5df3"),a("f400"),a("ac6a"),a("2909")),i=(a("6762"),a("2fdb"),a("96cf"),a("1da1")),n=a("7e1e"),l={name:"AgentSelect",props:{value:{type:Array,default:function(){return[]}}},data:function(){return{loading:!1,agents:[],selectedAgents:this.value}},watch:{value:{handler:function(t){this.selectedAgents=t,t&&t.length&&!this.agents.length&&this.fetchAgentsByIds(t)},immediate:!0}},methods:{getAgentLabel:function(t){return"".concat(t.nickName).concat(t.company?" - ".concat(t.company):"")},remoteSearch:function(){var t=Object(i.a)(Object(s.a)().mark((function t(e){var a,i,l=this;return Object(s.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(""===e){t.next=15;break}return this.loading=!0,t.prev=2,t.next=5,Object(n.b)("user_login",{query:JSON.stringify({$or:[{nickName:{$regex:e,$options:"i"}},{phone:{$regex:e,$options:"i"}}],roles:{$elemMatch:{label:"Tracker"}}}),limit:20});case 5:a=t.sent,i=this.agents.filter((function(t){return l.selectedAgents.includes(t._id)})),this.agents=Object(r.a)(new Map([].concat(Object(r.a)(i),Object(r.a)(a.data)).map((function(t){return[t._id,t]}))).values()),t.next=14;break;case 10:t.prev=10,t.t0=t.catch(2),console.error("æœç´¢ç»çºªäººå¤±è´¥:",t.t0),this.$message.error("æœç´¢ç»çºªäººå¤±è´¥");case 14:this.loading=!1;case 15:case"end":return t.stop()}}),t,this,[[2,10]])})));return function(e){return t.apply(this,arguments)}}(),handleChange:function(t){this.$emit("input",t);var e=this.agents.filter((function(e){return t.includes(e._id)}));this.$emit("select",e)},fetchAgentsByIds:function(){var t=Object(i.a)(Object(s.a)().mark((function t(e){var a,i;return Object(s.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.length){t.next=2;break}return t.abrupt("return");case 2:return t.prev=2,t.next=5,Object(n.b)("user_login",{query:JSON.stringify({_id:{$in:e}})});case 5:(a=t.sent).data&&a.data.length>0&&(i=this.agents.filter((function(t){return!a.data.find((function(e){return e._id===t._id}))})),this.agents=[].concat(Object(r.a)(i),Object(r.a)(a.data))),t.next=12;break;case 9:t.prev=9,t.t0=t.catch(2),console.error("è·å–ç»çºªäººä¿¡æ¯å¤±è´¥:",t.t0);case 12:case"end":return t.stop()}}),t,this,[[2,9]])})));return function(e){return t.apply(this,arguments)}}()}},c=l,o=(a("134f"),a("2877")),u=Object(o.a)(c,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-select",{attrs:{multiple:"",filterable:"",remote:"","reserve-keyword":"",placeholder:"è¯·è¾“å…¥ç»çºªäººåç§°æœç´¢","remote-method":t.remoteSearch,loading:t.loading,clearable:"","collapse-tags":""},on:{change:t.handleChange},model:{value:t.selectedAgents,callback:function(e){t.selectedAgents=e},expression:"selectedAgents"}},t._l(t.agents,(function(e){return a("el-option",{key:e._id,attrs:{label:t.getAgentLabel(e),value:e._id}},[a("div",{staticClass:"agent-option"},[a("div",{staticClass:"agent-info"},[a("span",{staticClass:"name"},[t._v(t._s(e.nickName))]),t._v(" "),a("el-tag",{attrs:{size:"mini",type:"info"}},[t._v(t._s(e.phone))])],1),t._v(" "),e.company?a("div",{staticClass:"company-info"},[a("small",[t._v(t._s(e.company))])]):t._e()])])})),1)}),[],!1,null,"5ad2e46e",null);e.default=u.exports}}]);